import{j as e,c as k,r as m,B as g,aN as C}from"./index-CNh2Ysd7.js";import{C as F}from"./Close-CSWdanUp.js";import{I as n}from"./InputField-Cac7SuVh.js";import{B as f}from"./Button-D2SEshHa.js";import{A as B}from"./Alert-BBsTbpkb.js";import{T as S}from"./Typography-DxP0RQcB.js";import{I as A}from"./AlertTitle-BBXxFqxI.js";const j=({label:l,name:s,value:u,options:a,placeholder:x="Select an option",onChange:i,className:y="",disabled:d=!1})=>{const o=typeof a[0]=="string"?a.map(r=>({value:r,label:r})):a;return e.jsxs("div",{className:"flex flex-col",children:[l&&e.jsx("label",{className:"mb-1 text-sm text-gray-600 dark:text-gray-300",children:l}),e.jsxs("select",{name:s,value:u,disabled:d,onChange:i,className:`h-11 w-full appearance-none rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 pr-11 text-sm shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-none focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 ${u?"text-gray-800 dark:text-white/90":"text-gray-400 dark:text-gray-400"} ${y}`,children:[e.jsx("option",{style:{color:"black"},value:"",disabled:!0,children:x}),o.map(r=>e.jsx("option",{style:{color:"black"},value:r.value,className:"text-gray-700 dark:bg-gray-900 dark:text-gray-300",children:r.label},r.value))]})]})},E={residentName:"",residentType:"",flatType:"",flatSizeSqFt:"",mobile:"",email:"",secondaryResidentName:"",secondaryResidentMobile:"",secondaryResidentEmail:""},U=({onCancel:l,society:s})=>{const u=k(),[a,x]=m.useState(E),[i,y]=m.useState(!1),[d,o]=m.useState(null),[r,p]=m.useState(""),[R,c]=m.useState(!1),t=b=>{const{name:h,value:T}=b.target;x(w=>({...w,[h]:T}))},v=async b=>{if(b.preventDefault(),i||!(s!=null&&s._id)){o("error"),p("Society not selected. Please select a society first."),c(!0);return}y(!0);try{await u(C({societyId:s._id,residentName:a.residentName,residentType:a.residentType,flatType:a.flatType,flatSizeSqFt:Number(a.flatSizeSqFt),mobile:a.mobile,email:a.email,secondaryResidentName:a.secondaryResidentName||void 0,secondaryResidentMobile:a.secondaryResidentMobile||void 0,secondaryResidentEmail:a.secondaryResidentEmail||void 0})).unwrap(),o("success"),p("Resident added successfully"),c(!0),setTimeout(()=>{c(!1),l()},1200)}catch(h){o("error"),p(h||"Failed to add resident"),c(!0)}finally{y(!1)}},N=a.residentName&&a.residentType&&a.flatType&&a.flatSizeSqFt&&a.mobile&&a.email;return e.jsxs(e.Fragment,{children:[R&&d&&e.jsx(B,{type:d,title:d==="success"?"Success!":"Error!",message:r,variant:"filled",showLink:!1,onClose:()=>c(!1)}),e.jsxs(g,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(g,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(S,{variant:"h6",children:"Add Resident User"}),e.jsx(A,{sx:{color:"white"},onClick:l,children:e.jsx(F,{})})]}),e.jsxs(g,{component:"form",onSubmit:v,px:6,py:4,children:[s&&e.jsxs(S,{className:"mb-4 text-sm text-gray-600",children:["Society: ",e.jsx("strong",{children:s.societyName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Resident Name",name:"residentName",value:a.residentName,onChange:t}),e.jsx(j,{label:"Resident Type",name:"residentType",value:a.residentType,onChange:t,options:["Owner","Tenant"]}),e.jsx(j,{label:"Flat Type",name:"flatType",value:a.flatType,onChange:t,options:["1RK","1BHK","2BHK","3BHK","4BHK","5BHK","6BHK"]}),e.jsx(n,{label:"Flat Size (Sq Ft)",name:"flatSizeSqFt",type:"number",value:a.flatSizeSqFt,onChange:t}),e.jsx(n,{label:"Mobile Number",name:"mobile",value:a.mobile,onChange:t}),e.jsx(n,{label:"Email ID",name:"email",value:a.email,onChange:t}),e.jsx(n,{label:"Secondary Resident Name",name:"secondaryResidentName",value:a.secondaryResidentName,onChange:t}),e.jsx(n,{label:"Secondary Resident Mobile",name:"secondaryResidentMobile",value:a.secondaryResidentMobile,onChange:t}),e.jsx(n,{label:"Secondary Resident Email",name:"secondaryResidentEmail",value:a.secondaryResidentEmail,onChange:t})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[e.jsx(f,{type:"submit",disabled:!N||i,children:i?"Saving...":"Add Resident"}),e.jsx(f,{variant:"secondary",onClick:l,children:"Cancel"})]})]})]})]})};export{U as A};
