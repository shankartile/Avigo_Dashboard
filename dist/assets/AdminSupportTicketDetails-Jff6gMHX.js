import{u as W,a as z,r as t,j as e,B as r}from"./index-CNh2Ysd7.js";import{B as v}from"./Button-D2SEshHa.js";import{T as O}from"./TextArea-DupqjNb0.js";import{P as B,S as M,A as L}from"./Send-C0PGIyQU.js";import{C as E}from"./Close-CSWdanUp.js";import{S as b}from"./skeleton-H-TAVWvB.js";import{J as F}from"./jodit-react-CT8-Abq2.js";import{A as _}from"./Alert-BBsTbpkb.js";import{T as i}from"./Typography-DxP0RQcB.js";import{C as q}from"./Chip--RBU-Z22.js";import{A as x}from"./Avatar-CCsDKzZ8.js";import{T as J}from"./Tooltip-B4POfKz-.js";import{I as S}from"./AlertTitle-BBXxFqxI.js";import{D as U,a as $}from"./Dialog-CMeqEyOr.js";import{D as H}from"./DialogTitle-sP3uGIgc.js";import"./createLucideIcon-C4mXBOWm.js";import"./createSvgIcon-BgVIxfXN.js";import"./utils-lR4eRFL7.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";const G={_id:"st-101",userType:"Webuser",subject:"Unable to submit enquiry form",description:"I am trying to submit the enquiry form but it keeps loading.",status:"Open",userId:{name:"Rohit Patil",phone:"9876543210"},attachments:[],replies:[{sender:"Webuser",message:"Please help me with this issue.",createdAt:new Date().toISOString()},{sender:"Admin",message:"<p>We are checking this issue.</p>",createdAt:new Date().toISOString()}],internalNotes:["Checked backend logs","Issue might be API timeout"]},K=()=>{const{search:y}=W();new URLSearchParams(y).get("userType"),z();const w=t.useRef(null),[a,l]=t.useState(null),[A,I]=t.useState(""),[Q,k]=t.useState(null),[h,p]=t.useState(null),[T,f]=t.useState(""),[C,o]=t.useState(!1),[c,j]=t.useState(""),[d,g]=t.useState("status"),[n,V]=t.useState(),[P,N]=t.useState(!1),[X,Y]=t.useState(!1),[D,R]=t.useState(!0);if(t.useEffect(()=>{const s=setTimeout(()=>{l(G),R(!1)},1e3);return()=>clearTimeout(s)},[]),D)return e.jsxs("div",{className:"p-6",children:[e.jsx(b,{height:32,width:300}),e.jsx(b,{count:6,className:"mt-4"})]});if(!a)return e.jsx("div",{className:"p-4",children:"Loading ticket details..."});const m=a.status==="Resolved";return e.jsxs(e.Fragment,{children:[C&&h&&e.jsx("div",{className:"p-4",children:e.jsx(_,{type:h,title:"Info",message:T,variant:"filled",onClose:()=>o(!1)})}),e.jsxs("div",{className:"flex items-center justify-between bg-white px-4 py-3 border-b sticky top-0 z-10 pr-[380px]",children:[e.jsxs(i,{className:"font-outfit mb-0",variant:"h5",children:["Ticket Subject: ",a.subject]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-outfit text-sm text-gray-500",children:"Status:"}),e.jsx(q,{className:"font-outfit ml-2",label:a.status,color:a.status==="Resolved"?"success":a.status==="In Progress"?"warning":"error",size:"medium",variant:"filled"})]})]}),e.jsxs("div",{className:"flex min-h-screen overflow-hidden bg-gray-50",children:[e.jsxs("main",{className:"flex-1 overflow-y-auto h-screen p-6 pr-[380px]",children:[e.jsx(r,{className:"flex gap-2 justify-start",children:e.jsxs(r,{className:"p-3 rounded-2xl max-w-[50%] bg-gray-200 shadow break-words",children:[e.jsx(i,{className:"font-outfit",fontWeight:600,children:"Issue Description"}),e.jsx("p",{children:a.description})]})}),a.replies.map((s,u)=>e.jsxs(r,{className:`flex gap-2 ${s.sender==="Admin"?"justify-end":"justify-start"}`,children:[s.sender!=="Admin"&&e.jsx(x,{children:s.sender[0]}),e.jsxs(r,{className:`p-3 rounded-2xl max-w-[50%] ${s.sender==="Admin"?"bg-blue-100":"bg-gray-200"}`,children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:s.message}}),e.jsx(i,{className:"text-xs text-gray-500 mt-1",children:new Date(s.createdAt).toLocaleString("en-IN")})]}),s.sender==="Admin"&&e.jsx(x,{children:"A"})]},u)),e.jsx("div",{className:"h-44"})]}),e.jsxs("aside",{className:"w-[350px] fixed right-0 top-[64px] h-[calc(100vh-64px)] bg-white border-l p-4 flex flex-col z-30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{sx:{width:60,height:60}}),e.jsxs("div",{children:[e.jsx(i,{className:"font-outfit font-semibold",children:a.userId.name}),e.jsxs(i,{className:"font-outfit text-sm text-gray-500 flex items-center",children:[e.jsx(B,{size:16,className:"mr-1"}),a.userId.phone]})]})]}),!m&&e.jsxs("div",{className:"bg-gray-50 rounded-lg shadow p-3 mt-4",children:[e.jsx(O,{label:"Internal Notes",value:c,onChange:s=>j(s.target.value)}),e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{size:"xs",disabled:!c,onClick:()=>{l(s=>({...s,internalNotes:[...s.internalNotes,c]})),j(""),p("success"),f("Internal note added successfully!"),o(!0)},children:"Save Note"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 overflow-y-auto",children:[e.jsx(i,{className:"font-outfit font-semibold",children:"Internal Notes"}),a.internalNotes.map((s,u)=>e.jsx("div",{className:"bg-gray-100 text-sm p-2 rounded",children:s},u))]}),!m&&e.jsxs("div",{className:"bg-gray-100 rounded-lg shadow p-3 mt-auto",children:[e.jsxs("select",{value:d,onChange:s=>g(s.target.value),className:"w-full border rounded px-3 py-2 mb-2",children:[e.jsx("option",{value:"status",children:"Select Ticket Status"}),e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Resolved",children:"Resolved"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(v,{size:"xs",disabled:d==="status",onClick:()=>{l(s=>({...s,status:d})),g("status"),p("success"),f("Status updated & reply sent!"),o(!0)},children:["Send ",e.jsx(M,{})]})})]})]}),!m&&e.jsx("div",{className:"fixed left-0 right-[40px] bottom-2 z-20 flex justify-center",children:e.jsxs(r,{className:"bg-white border rounded-2xl shadow p-3 w-full max-w-5xl",children:[e.jsx(r,{className:"flex items-center gap-2 mb-2",children:e.jsx(J,{title:"Attach file",children:e.jsxs(S,{component:"label",children:[e.jsx(L,{}),e.jsx("input",{hidden:!0,type:"file",onChange:s=>k(Array.from(s.target.files||[]))})]})})}),e.jsx(F,{ref:w,value:A,config:{height:150,placeholder:"Type your reply..."},onBlur:s=>I(s)})]})}),e.jsxs(U,{open:P,onClose:()=>N(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsxs(H,{children:["Preview",e.jsx(S,{onClick:()=>N(!1),children:e.jsx(E,{})})]}),e.jsx($,{children:n!=null&&n.endsWith(".pdf")?e.jsx("iframe",{src:n,width:"100%",height:"600"}):e.jsx("img",{src:n,className:"w-full"})})]})]})]})},Ne=()=>e.jsx(e.Fragment,{children:e.jsx(K,{})});export{Ne as default};
