import{r,c as ce,d as de,d0 as f,j as e,B as c,d1 as me,d2 as ue,d3 as pe,d4 as he}from"./index-CcNgdVLz.js";import{V as xe}from"./Visibility-Bad1pPYX.js";import{C as F}from"./Close-eApB0hKv.js";import{D as fe,E as ge}from"./DataTable-DIxG5frN.js";import{I as ke}from"./InputField-BQ5ewBIw.js";import{B as P}from"./Button-B4_V5GRV.js";import{T as je}from"./ToggleSwitch-CZt8XOld.js";import{A as W}from"./Alert-U3gIVFWt.js";import{S as L}from"./SweetAlert-BfCzCAJa.js";import{T}from"./Typography-BMOygWke.js";import{D as V,a as _}from"./Dialog-BdfS6Lfy.js";import{D as ye}from"./DialogTitle-BbPUlM9A.js";import{I as k}from"./AlertTitle-C4QpKbd8.js";import{T as z}from"./Tooltip-C-v54PpA.js";import"./createSvgIcon-ClJPFlmG.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./Chip-YFG14ne-.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./Divider-BePmc644.js";import"./Tabs-CWf6flOX.js";import"./skeleton-DjwwWlQi.js";const Ce=()=>{const[x,b]=r.useState({id:"",bikekilometer:"",kilometer:""}),[j,S]=r.useState(null),[y,v]=r.useState(null),[i,o]=r.useState(null),[g,l]=r.useState(""),[M,s]=r.useState(!1),[A,d]=r.useState(!1),[we,Te]=r.useState(!1),[D,B]=r.useState(null),[H,I]=r.useState(!1),[h,R]=r.useState(""),[m,E]=r.useState(0),[u,U]=r.useState(10),[p,C]=r.useState(null),[Y,w]=r.useState(!1),a=ce(),{BikekilometerMaster:$=[],totalItems:q}=de(t=>t.BikekilometerMaster),G=$.map(t=>({...t,id:t._id}));r.useEffect(()=>{const t=setTimeout(()=>{a(f({search:h,page:m,limit:u}))},500);return()=>clearTimeout(t)},[h,m,u]);const J=t=>{const{name:n,value:N}=t.target;b(ne=>({...ne,[n]:N}))},O=x.bikekilometer.trim()!=="",Q=async()=>{try{const t={kilometer:x.bikekilometer},n=await a(he(t)).unwrap();o("success"),l("kilometer Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),a(f({search:h,page:m,limit:u})),d(!1)}catch(t){o("error"),l("Failed to add kilometer: "+t),s(!0),setTimeout(()=>s(!1),3e3)}},X=async(t,n)=>{try{b({id:t._id||"",bikekilometer:t.kilometer||""}),v(n),d(!0)}catch{o("error"),l("Unable to fetch kilometer details for editing."),s(!0)}},Z=async()=>{try{const t={_id:x.id,kilometer:x.bikekilometer},n=await a(pe(t)).unwrap();o("success"),l("kilometer updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),d(!1),v(null),a(f({search:h,page:m,limit:u}))}catch{o("error"),l("Failed to update kilometer: "),s(!0),setTimeout(()=>s(!1),3e3)}},ee=async()=>{if(D){try{await a(ue(D)).unwrap(),o("error"),l("kilometer deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),a(f({search:h,page:m,limit:u}))}catch(t){o("error"),l("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}I(!1),B(null)}},te=()=>{I(!1),B(null)},se=t=>{C(t),w(!0)},re=async()=>{if(p){try{await a(me({_id:p._id,isActive:!p.isActive})).unwrap(),o("success"),l(`Kilometer ${p.isActive?"deactivated":"activated"} successfully.`),s(!0),a(f({search:h,page:m,limit:u}))}catch(t){o("error"),l("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),w(!1),C(null)}},ie=()=>{w(!1),C(null)},oe=t=>{S(t)},K=()=>{S(null),d(!1)},le=t=>{R(t),E(0)},ae=[{accessorKey:"kilometer",header:"Max Kilometer"},{header:"Actions",Cell:({row:t})=>e.jsxs(c,{display:"flex",gap:1,children:[e.jsx(z,{title:"View Details",children:e.jsx(k,{color:"primary",onClick:()=>oe(t.original),children:e.jsx(xe,{})})}),e.jsx(z,{title:"Edit",children:e.jsx(k,{color:"secondary",onClick:()=>X(t.original,t.index),children:e.jsx(ge,{})})}),e.jsx(je,{checked:t.original.isActive,onChange:()=>se(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(L,{show:Y,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${p!=null&&p.isActive?"deactivate":"activate"} this kilometer?`,onConfirm:re,onCancel:ie,confirmText:"Yes",cancelText:"No"}),e.jsx(L,{show:H,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this kilometer?",onConfirm:ee,onCancel:te,confirmText:"Yes",cancelText:"No"}),M&&i&&e.jsx("div",{className:"p-4",children:e.jsx(W,{type:i,title:i==="success"?"Success!":i==="error"&&g.toLowerCase().includes("deleted")?"Deleted!":i==="error"?"Error!":"Warning!",message:g,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),A?e.jsxs(V,{open:A,onClose:(t,n)=>{n!=="backdropClick"&&d(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(c,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(ye,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:y!==null?"Edit Max Kilometer":"Add  Max Kilometer"}),e.jsx(k,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>d(!1),children:e.jsx(F,{})})]}),e.jsxs(_,{children:[M&&i&&e.jsx("div",{className:"mb-4",children:e.jsx(W,{type:i,title:i==="success"?"Success!":i==="error"&&g.toLowerCase().includes("deleted")?"Deleted!":i==="error"?"Error!":"Warning!",message:g,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:e.jsx(ke,{label:"Kilometer",name:"bikekilometer",value:x.bikekilometer,onChange:J})}),e.jsxs(c,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(P,{onClick:y!==null?Z:Q,className:"rounded-[25px]",disabled:!O,children:y!==null?"Update":"Add"}),e.jsx(P,{variant:"secondary",onClick:()=>d(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsx(c,{ml:2,children:e.jsx(T,{variant:"h5",fontWeight:500,className:"font-outfit",children:"Kilometer Management"})})}),e.jsx(fe,{clickHandler:le,data:G,columns:ae,rowCount:q,pageIndex:m,pageSize:u,onPaginationChange:({pageIndex:t,pageSize:n})=>{E(t),U(n)}})]}),e.jsx(V,{open:!!j,onClose:K,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(c,{className:"rounded-xl overflow-hidden",children:[e.jsxs(c,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(T,{className:"font-outfit",variant:"h6",children:"Kilometer Details"}),e.jsx(k,{sx:{color:"white"},onClick:K,children:e.jsx(F,{})})]}),e.jsx(_,{children:j&&e.jsx(c,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(T,{className:"font-outfit",children:[e.jsx("strong",{children:"kilometer:"})," ",j.kilometer]})})})]})})]})},Xe=()=>e.jsx(e.Fragment,{children:e.jsx(Ce,{})});export{Xe as default};
