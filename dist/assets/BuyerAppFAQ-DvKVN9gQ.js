import{r,c as ce,d as de,eE as F,j as t,B as i,eF as ue,eG as pe,eH as me}from"./index-N8t8oMzR.js";import{I as fe}from"./Info-lyeC1xGk.js";import{A as xe}from"./Add-BUtQdix6.js";import{D as he}from"./Delete-07TAjR17.js";import{V as ge}from"./Visibility-CgGAKN6P.js";import{C as L}from"./Close-CwR_quIe.js";import{D as Ae,E as je}from"./DataTable-BqUD-dAi.js";import{B as T}from"./Button-CBNcrDpD.js";import{S as we}from"./SweetAlert-vzLgp13W.js";import{A as V}from"./Alert-CgNUKTJk.js";import{T as H}from"./TextArea-C2DdMoId.js";import{T as x}from"./Typography-CKlLxaDL.js";import{T as M}from"./Tooltip-CwyNn424.js";import{D as Z,a as $}from"./Dialog-BGF2t3L7.js";import{D as ye}from"./DialogTitle-D6DEKDqS.js";import{I as h}from"./AlertTitle-D9ejxV9_.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./Chip-Dnlh_trd.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const Fe=()=>{const[n,C]=r.useState({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),l=ce(),{BuyerFAQManagement:D,totalItems:K}=de(e=>e.BuyerFAQManagement),[g,A]=r.useState(!1),[j,Q]=r.useState(null),[f,I]=r.useState(null),[w,R]=r.useState(""),[d,q]=r.useState(0),[u,U]=r.useState(10),[a,p]=r.useState(null),[y,m]=r.useState(""),[v,o]=r.useState(!1),[N,c]=r.useState(!1),[B,S]=r.useState(null),[G,b]=r.useState(!1),[Ce,Qe]=r.useState([]),[E,O]=r.useState({question:"",answer:""}),Y=Array.isArray(D)?D.map(e=>({...e,id:e._id})):[];r.useEffect(()=>{const e=setTimeout(()=>{l(F({search:w,page:d,limit:u}))},500);return()=>clearTimeout(e)},[w,d,u]);const J=e=>{R(e),q(0)},X=e=>{I(e)},P=()=>{I(null)},ee=(e,s)=>{if(e==="question"||e==="answer"){if(!s.trim())return`${e} is required`;if(!/[a-zA-Z]/.test(s))return`${e} must contain words, not just numbers`;if(s.trim().length<10)return`${e} should be at least 10 characters long`}return""},z=e=>{const{name:s,value:W}=e.target;C(k=>({...k,[s]:W})),O(k=>({...k,[s]:ee(s,W)}))},te=(()=>{const e=/[a-zA-Z]/.test(n.question)&&n.question.trim().length>=10,s=/[a-zA-Z]/.test(n.answer)&&n.answer.trim().length>=10;return e&&s})(),se=async()=>{if(!g){A(!0);try{const e={question:n.question,answer:n.answer},s=await l(me(e)).unwrap();p("success"),m("FAQ Added successfully."),o(!0),setTimeout(()=>o(!1),3e3),l(F({search:w,page:d,limit:u})),c(!1)}catch(e){p("error"),m("Failed to add FAQ: "+e),o(!0),setTimeout(()=>o(!1),3e3)}finally{A(!1)}}},re=(e,s)=>{C({_id:e._id,question:e.question,answer:e.answer,createdAt:e.createdAt,updatedAt:e.updatedAt,isActive:e.isActive}),Q(s),c(!0)},oe=async()=>{if(!g){A(!0);try{const e={_id:n._id,question:n.question,answer:n.answer},s=await l(pe(e)).unwrap();p("success"),m("FAQ updated successfully."),o(!0),setTimeout(()=>o(!1),3e3),c(!1),Q(null),l(F({search:w,page:d,limit:u}))}catch(e){console.error("FAQ update failed:",e),p("error"),m(`Failed to update FAQ: ${(e==null?void 0:e.message)||e}`),o(!0),setTimeout(()=>o(!1),3e3)}finally{A(!1)}}},ne=e=>{S(e),b(!0)},ae=async()=>{if(B){try{await l(ue(B)).unwrap(),p("error"),m("FAQ deleted successfully."),l(F({page:d,limit:u}))}catch(e){p("error"),m("Delete failed: "+e)}o(!0),setTimeout(()=>o(!1),3e3),b(!1),S(null)}},ie=()=>{b(!1),S(null)},_=(e,s=50)=>e?e.length>s?e.slice(0,s)+"...":e:"",le=[{accessorKey:"question",header:"Question",Cell:({row:e})=>_(e.original.question,30)},{accessorKey:"answer",header:"Answer",Cell:({row:e})=>_(e.original.answer,30)},{header:"Actions",Cell:({row:e})=>t.jsxs(i,{display:"flex",gap:1,children:[t.jsx(M,{title:"View FAQ",arrow:!0,children:t.jsx(h,{color:"primary",onClick:()=>X(e.original),children:t.jsx(ge,{})})}),t.jsx(M,{title:"Edit FAQ",arrow:!0,children:t.jsx(h,{color:"secondary",onClick:()=>re(e.original,e.index),children:t.jsx(je,{})})}),t.jsx(h,{color:"error",onClick:()=>ne(e.original._id),children:t.jsx(he,{})})]})}];return t.jsxs(t.Fragment,{children:[t.jsx(we,{show:G,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this FAQ?",onConfirm:ae,onCancel:ie,confirmText:"Yes",cancelText:"No"}),v&&a&&t.jsx("div",{className:"p-4",children:t.jsx(V,{type:a,title:a==="success"?"Success!":a==="error"&&y.toLowerCase().includes("deleted")?"Deleted!":a==="error"?"Error!":"Warning!",message:y,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>o(!1)})}),N?t.jsxs(Z,{open:N,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[t.jsx(ye,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:j!==null?"Edit FAQ":"Add FAQ"}),t.jsx(h,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>c(!1),children:t.jsx(L,{})})]}),t.jsxs($,{children:[v&&a&&t.jsx("div",{className:"mb-4",children:t.jsx(V,{type:a,title:a==="success"?"Success!":a==="error"&&y.toLowerCase().includes("deleted")?"Deleted!":a==="error"?"Error!":"Warning!",message:y,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>o(!1)})}),t.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(H,{label:"Question",name:"question",value:n.question,onChange:z,errorMessage:E.question}),t.jsx(H,{label:"Answer",name:"answer",value:n.answer,onChange:z,errorMessage:E.answer})]}),t.jsxs(i,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[t.jsx(T,{onClick:j!==null?oe:se,className:"rounded-[25px]",disabled:!te||g,children:g?j!==null?"Updating...":"Submitting...":j!==null?"Update":"Submit"}),t.jsx(T,{variant:"secondary",onClick:()=>c(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(i,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsx(i,{ml:2,children:t.jsxs(x,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Buyer App FAQs  ",t.jsx(M,{title:"Manage Buyer App FAQs by adding new questions and updating existing ones.",arrow:!0,slotProps:{popper:{sx:{"& .MuiTooltip-tooltip":{fontSize:"0.9rem",backgroundColor:"#245492",color:"#fff",fontFamily:"Outfit",padding:"8px 12px"},"& .MuiTooltip-arrow":{color:"#245492"}}}},children:t.jsx(fe,{fontSize:"medium",sx:{color:"#245492",cursor:"pointer"},onClick:e=>e.stopPropagation()})})]})}),t.jsxs(T,{onClick:()=>{C({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),Q(null),c(!0)},children:[t.jsx(xe,{}),"Add New FAQ"]})]}),t.jsx(Ae,{clickHandler:J,data:Y,columns:le,rowCount:K,pageIndex:d,pageSize:u,onPaginationChange:({pageIndex:e,pageSize:s})=>{q(e),U(s)}})]}),t.jsx(Z,{open:!!f,onClose:P,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:t.jsxs(i,{className:"rounded-xl overflow-hidden",children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[t.jsx(x,{className:"font-outfit",variant:"h6",children:"FAQ Details"}),t.jsx(h,{sx:{color:"white"},onClick:P,children:t.jsx(L,{})})]}),t.jsx($,{children:f&&t.jsxs(i,{display:"flex",flexDirection:"column",gap:2,children:[t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Question:"})," ",f.question]}),t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Answer:"})," ",f.answer]}),t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Created At:"})," ",new Date(f.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]})})]})})]})},st=()=>t.jsx(t.Fragment,{children:t.jsx(Fe,{})});export{st as default};
