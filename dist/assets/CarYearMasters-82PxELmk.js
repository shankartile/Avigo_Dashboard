import{r as a,c as re,d as le,cw as x,j as e,B as c,cx as oe,cy as ie,cz as ne,cA as ce}from"./index-CNh2Ysd7.js";import{A as de}from"./Add-ONoAddvh.js";import{V as ue}from"./Visibility-CFK2wX7e.js";import{C as W}from"./Close-CSWdanUp.js";import{B as T}from"./Button-D2SEshHa.js";import{D as me}from"./DataTable-CBDiE-I1.js";import{T as pe}from"./ToggleSwitch-CRLgVpk1.js";import{A as B}from"./Alert-BBsTbpkb.js";import{S as L}from"./SweetAlert-DUVT9XWx.js";import{T as b}from"./Typography-DxP0RQcB.js";import{D as _,a as z}from"./Dialog-CMeqEyOr.js";import{D as he}from"./DialogTitle-sP3uGIgc.js";import{I as Y}from"./AlertTitle-BBXxFqxI.js";import{F as fe,ag as xe,S as ge,M as ye}from"./DateTimeField-BSuPXSWe.js";import{T as je}from"./Tooltip-B4POfKz-.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./CircularProgress-B1SplcgD.js";import"./Chip--RBU-Z22.js";import"./Pagination-C_Nq6nsY.js";import"./Divider-1omdH51K.js";import"./dividerClasses-BGxOqTuw.js";import"./useSlotProps-Dx6fg7Ph.js";import"./index-BfVZHwAX.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const Ce=()=>{const[f,v]=a.useState({id:"",year:""}),[y,A]=a.useState(null),[j,k]=a.useState(null),[r,i]=a.useState(null),[g,n]=a.useState(""),[M,s]=a.useState(!1),[D,d]=a.useState(!1),[we,Se]=a.useState(!1),[I,N]=a.useState(null),[V,F]=a.useState(!1),[h,H]=a.useState(""),[u,E]=a.useState(0),[m,R]=a.useState(10),[p,C]=a.useState(null),[U,w]=a.useState(!1),l=re(),{CarYearMaster:$=[],totalItems:K}=le(t=>t.CarYearMaster),q=$.map(t=>({...t,id:t._id}));a.useEffect(()=>{const t=setTimeout(()=>{l(x({search:h,page:u,limit:m}))},500);return()=>clearTimeout(t)},[h,u,m]);const G=async()=>{try{const t={year:f.year},o=await l(ce(t)).unwrap();i("success"),n("Year Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),l(x({search:h,page:u,limit:m})),d(!1)}catch(t){i("error"),n("Failed to add year: "+t),s(!0),setTimeout(()=>s(!1),3e3)}},J=async()=>{try{const t={_id:f.id,year:f.year},o=await l(ne(t)).unwrap();i("success"),n("Year updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),d(!1),k(null),l(x({search:h,page:u,limit:m}))}catch{i("error"),n("Failed to update year: "),s(!0),setTimeout(()=>s(!1),3e3)}},O=async()=>{if(I){try{await l(ie(I)).unwrap(),i("error"),n("Year deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),l(x({search:h,page:u,limit:m}))}catch(t){i("error"),n("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}F(!1),N(null)}},Q=()=>{F(!1),N(null)},X=t=>{C(t),w(!0)},Z=async()=>{if(p){try{await l(oe({_id:p._id,isActive:!p.isActive})).unwrap(),i("success"),n(`Year ${p.isActive?"deactivated":"activated"} successfully.`),s(!0),l(x({search:h,page:u,limit:m}))}catch(t){i("error"),n("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),w(!1),C(null)}},ee=()=>{w(!1),C(null)},te=t=>{A(t)},P=()=>{A(null),d(!1)},se=t=>{H(t),E(0)},ae=[{accessorKey:"year",header:"Year"},{header:"Actions",Cell:({row:t})=>e.jsxs(c,{display:"flex",gap:1,children:[e.jsx(je,{title:"View Details",children:e.jsx(Y,{color:"primary",onClick:()=>te(t.original),children:e.jsx(ue,{})})}),e.jsx(pe,{checked:t.original.isActive,onChange:()=>X(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(L,{show:U,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${p!=null&&p.isActive?"deactivate":"activate"} this year?`,onConfirm:Z,onCancel:ee,confirmText:"Yes",cancelText:"No"}),e.jsx(L,{show:V,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this year?",onConfirm:O,onCancel:Q,confirmText:"Yes",cancelText:"No"}),M&&r&&e.jsx("div",{className:"p-4",children:e.jsx(B,{type:r,title:r==="success"?"Success!":r==="error"&&g.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:g,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),D?e.jsxs(_,{open:D,onClose:(t,o)=>{o!=="backdropClick"&&d(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(c,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(he,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:j!==null?"Edit Year":"Add Year"}),e.jsx(Y,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>d(!1),children:e.jsx(W,{})})]}),e.jsxs(z,{children:[M&&r&&e.jsx("div",{className:"mb-4",children:e.jsx(B,{type:r,title:r==="success"?"Success!":r==="error"&&g.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:g,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:e.jsxs(fe,{fullWidth:!0,children:[e.jsx(xe,{id:"year-select-label",children:"Year"}),e.jsx(ge,{labelId:"year-select-label",id:"year-select",name:"year",value:f.year,label:"Year",onChange:t=>v(o=>({...o,[t.target.name]:t.target.value})),children:Array.from({length:50},(t,o)=>{const S=new Date().getFullYear()-o;return e.jsx(ye,{value:S,children:S},S)})})]})}),e.jsxs(c,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(T,{onClick:j!==null?J:G,className:"rounded-[25px]",disabled:!f.year,children:j!==null?"Update year":"Add year"}),e.jsx(T,{variant:"secondary",onClick:()=>d(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(c,{ml:2,children:e.jsx(b,{variant:"h5",fontWeight:500,className:"font-outfit",children:"Year Management"})}),e.jsxs(T,{onClick:()=>{v({id:"",year:""}),k(null),d(!0)},children:[e.jsx(de,{}),"Add New Year"]})]}),e.jsx(me,{clickHandler:se,data:q,columns:ae,rowCount:K,pageIndex:u,pageSize:m,onPaginationChange:({pageIndex:t,pageSize:o})=>{E(t),R(o)}})]}),e.jsx(_,{open:!!y,onClose:P,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(c,{className:"rounded-xl overflow-hidden",children:[e.jsxs(c,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(b,{className:"font-outfit",variant:"h6",children:"Year Details"}),e.jsx(Y,{sx:{color:"white"},onClick:P,children:e.jsx(W,{})})]}),e.jsx(z,{children:y&&e.jsx(c,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(b,{className:"font-outfit",children:[e.jsx("strong",{children:"Year:"})," ",y.year]})})})]})})]})},Qe=()=>e.jsx(e.Fragment,{children:e.jsx(Ce,{})});export{Qe as default};
