import{j as e,r as s,c as me,d as L,a2 as x,a3 as ue,B as g,a4 as ge,a5 as he,a6 as xe,a7 as ye}from"./index-CcNgdVLz.js";import{I as Ce}from"./Info-BLwzYq-V.js";import{c as fe}from"./createSvgIcon-ClJPFlmG.js";import{D as je}from"./Delete-BWjouR_h.js";import{V as Te}from"./Visibility-Bad1pPYX.js";import{C as V}from"./Close-eApB0hKv.js";import{D as we,E as Se}from"./DataTable-DIxG5frN.js";import{I as ve}from"./InputField-BQ5ewBIw.js";import{B as D}from"./Button-B4_V5GRV.js";import{T as be}from"./ToggleSwitch-CZt8XOld.js";import{A as R}from"./Alert-U3gIVFWt.js";import{S as H}from"./SweetAlert-BfCzCAJa.js";import{T as I}from"./Typography-BMOygWke.js";import{T as M}from"./Tooltip-C-v54PpA.js";import{D as U,a as K}from"./Dialog-BdfS6Lfy.js";import{D as _e}from"./DialogTitle-BbPUlM9A.js";import{I as y}from"./AlertTitle-C4QpKbd8.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./Chip-YFG14ne-.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./Divider-BePmc644.js";import"./Tabs-CWf6flOX.js";import"./skeleton-DjwwWlQi.js";const ke=fe(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),De=()=>{const[p,f]=s.useState({id:"",category:"",complaint_type_id:""}),[j,A]=s.useState(null),[T,w]=s.useState(null),[o,l]=s.useState(null),[C,i]=s.useState(""),[N,a]=s.useState(!1),[E,m]=s.useState(!1),[Ie,Me]=s.useState(!1),[P,S]=s.useState(null),[O,v]=s.useState(!1),[u,Y]=s.useState(""),[n,F]=s.useState(0),[c,$]=s.useState(10),[h,b]=s.useState(null),[q,_]=s.useState(!1),r=me(),{ComplaintCategoryMaster:G=[],totalItems:J}=L(t=>t.ComplaintCategoryMasters),{ComplaintTypeMaster:k}=L(t=>t.ComplaintTypeMaster),Q=G.map(t=>({...t,id:t._id}));s.useEffect(()=>{const t=setTimeout(()=>{r(x({search:u,page:n,limit:c}))},500);return()=>clearTimeout(t)},[u,n,c]),s.useEffect(()=>{const t=setTimeout(()=>{r(ue({search:u,page:n,limit:c}))},500);return()=>clearTimeout(t)},[u,n,c]);const B=t=>{const{name:d,value:z}=t.target;f(pe=>({...pe,[d]:z}))},X=p.category.trim()!=="",Z=async()=>{try{const t={category:p.category,complaint_type_id:p.complaint_type_id||""},d=await r(ye(t)).unwrap();l("success"),i("Complaint Category Added successfully."),a(!0),setTimeout(()=>a(!1),3e3),r(x({search:u,page:n,limit:c})),m(!1)}catch(t){l("error"),i("Failed to add Complaint Category : "+t),a(!0),setTimeout(()=>a(!1),3e3)}},ee=async(t,d)=>{try{f({id:t._id||"",category:t.category||"",complaint_type_id:t.complaint_type_id||""}),w(d),m(!0)}catch{l("error"),i("Unable to fetch Complaint Category details for editing."),a(!0)}},te=async()=>{try{const t={_id:p.id,category:p.category,complaint_type_id:p.complaint_type_id||""},d=await r(xe(t)).unwrap();l("success"),i("Complaint Category  updated successfully."),a(!0),setTimeout(()=>a(!1),3e3),m(!1),w(null),r(x({search:u,page:n,limit:c}))}catch{l("error"),i("Failed to update Complaint Category : "),a(!0),setTimeout(()=>a(!1),3e3)}},ae=t=>{S(t),v(!0)},se=async()=>{if(P){try{await r(he(P)).unwrap(),l("error"),i("Complaint Category deleted successfully."),a(!0),setTimeout(()=>a(!1),3e3),r(x({search:u,page:n,limit:c}))}catch(t){l("error"),i("Delete failed: "+t),a(!0),setTimeout(()=>a(!1),3e3)}v(!1),S(null)}},oe=()=>{v(!1),S(null)},re=t=>{b(t),_(!0)},le=async()=>{if(h){try{await r(ge({_id:h._id,isActive:!h.isActive})).unwrap(),l("success"),i(`Complaint Category ${h.isActive?"deactivated":"activated"} successfully.`),a(!0),r(x({search:u,page:n,limit:c}))}catch(t){l("error"),i("Status toggle failed: "+t),a(!0)}setTimeout(()=>a(!1),3e3),_(!1),b(null)}},ie=()=>{_(!1),b(null)},ne=t=>{A(t)},W=()=>{A(null),m(!1)},ce=t=>{Y(t),F(0)},de=[{accessorKey:"category",header:"Complaint category"},{accessorKey:"complaint_type_name",header:"Complaint Type"},{header:"Actions",Cell:({row:t})=>e.jsxs(g,{display:"flex",gap:1,children:[e.jsx(M,{title:"View Details",children:e.jsx(y,{color:"primary",onClick:()=>ne(t.original),children:e.jsx(Te,{})})}),!t.original.isOthers&&e.jsx(M,{title:"Edit",children:e.jsx("span",{children:e.jsx(y,{color:"secondary",onClick:()=>ee(t.original,t.index),children:e.jsx(Se,{})})})}),!t.original.isOthers&&e.jsx(y,{color:"error",onClick:()=>ae(t.original._id),children:e.jsx(je,{})}),e.jsx(be,{checked:t.original.isActive,onChange:()=>re(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(H,{show:q,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${h!=null&&h.isActive?"deactivate":"activate"} this Complaint Category?`,onConfirm:le,onCancel:ie,confirmText:"Yes",cancelText:"No"}),e.jsx(H,{show:O,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Complaint Category ?",onConfirm:se,onCancel:oe,confirmText:"Yes",cancelText:"No"}),N&&o&&e.jsx("div",{className:"p-4",children:e.jsx(R,{type:o,title:o==="success"?"Success!":o==="error"&&C.toLowerCase().includes("deleted")?"Deleted!":o==="error"?"Error!":"Warning!",message:C,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),E?e.jsxs(U,{open:E,onClose:(t,d)=>{d!=="backdropClick"&&m(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(g,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(_e,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:T!==null?"Edit Complaint Category":"Add Complaint Category"}),e.jsx(y,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>m(!1),children:e.jsx(V,{})})]}),e.jsxs(K,{children:[N&&o&&e.jsx("div",{className:"mb-4",children:e.jsx(R,{type:o,title:o==="success"?"Success!":o==="error"&&C.toLowerCase().includes("deleted")?"Deleted!":o==="error"?"Error!":"Warning!",message:C,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-1 block",children:["Complaint Type ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"complaint_type_id",value:p.complaint_type_id,onChange:B,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Complaint Type"}),k==null?void 0:k.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t._id,children:t.complaint_type},t._id))]})]}),e.jsx(ve,{label:"Complaint Category ",name:"category",value:p.category,onChange:B})]}),e.jsxs(g,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(D,{onClick:T!==null?te:Z,className:"rounded-[25px]",disabled:!X,children:T!==null?"Update Complaint Category ":"Add Complaint Category "}),e.jsx(D,{variant:"secondary",onClick:()=>m(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(g,{ml:2,children:e.jsxs(I,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Complaint Category Master",e.jsx(M,{title:"Manage categories like Plumbing, Electrical, Maintenance, etc.",arrow:!0,children:e.jsx(Ce,{sx:{color:"#245492",ml:1}})})]})}),e.jsxs(D,{onClick:()=>{f({id:"",category:"",complaint_type_id:""}),w(null),m(!0)},children:[e.jsx(ke,{}),"Add New Complaint Category "]})]}),e.jsx(we,{clickHandler:ce,data:Q,columns:de,rowCount:J,pageIndex:n,pageSize:c,onPaginationChange:({pageIndex:t,pageSize:d})=>{F(t),$(d)}})]}),e.jsx(U,{open:!!j,onClose:W,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(g,{className:"rounded-xl overflow-hidden",children:[e.jsxs(g,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(I,{className:"font-outfit",variant:"h6",children:"Complaint Category Details"}),e.jsx(y,{sx:{color:"white"},onClick:W,children:e.jsx(V,{})})]}),e.jsx(K,{children:j&&e.jsx(g,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(I,{className:"font-outfit",children:[e.jsx("strong",{children:"Complaint Category :"})," ",j.category]})})})]})})]})},it=()=>e.jsx(e.Fragment,{children:e.jsx(De,{})});export{it as default};
