import{r,c as ce,d as de,eA as y,j as t,B as i,eB as ue,eC as pe,eD as me}from"./index-N8t8oMzR.js";import{I as xe}from"./Info-lyeC1xGk.js";import{A as fe}from"./Add-BUtQdix6.js";import{D as he}from"./Delete-07TAjR17.js";import{V as ge}from"./Visibility-CgGAKN6P.js";import{C as L}from"./Close-CwR_quIe.js";import{D as Ae,E as je}from"./DataTable-BqUD-dAi.js";import{B as T}from"./Button-CBNcrDpD.js";import{S as we}from"./SweetAlert-vzLgp13W.js";import{A as V}from"./Alert-CgNUKTJk.js";import{T as Z}from"./TextArea-C2DdMoId.js";import{T as f}from"./Typography-CKlLxaDL.js";import{T as M}from"./Tooltip-CwyNn424.js";import{D as H,a as K}from"./Dialog-BGF2t3L7.js";import{D as Fe}from"./DialogTitle-D6DEKDqS.js";import{I as h}from"./AlertTitle-D9ejxV9_.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./Chip-Dnlh_trd.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const ye=()=>{const[o,C]=r.useState({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),l=ce(),{DealerFAQManagement:I,totalItems:R}=de(e=>e.DealerFAQManagement),[g,A]=r.useState(!1),[j,D]=r.useState(null),[x,v]=r.useState(null),[w,U]=r.useState(""),[d,q]=r.useState(0),[u,$]=r.useState(10),[n,p]=r.useState(null),[F,m]=r.useState(""),[N,a]=r.useState(!1),[E,c]=r.useState(!1),[P,S]=r.useState(null),[O,Q]=r.useState(!1),[Ce,De]=r.useState([]),[z,Y]=r.useState({question:"",answer:""}),G=Array.isArray(I)?I.map(e=>({...e,id:e._id})):[];r.useEffect(()=>{const e=setTimeout(()=>{l(y({search:w,page:d,limit:u}))},500);return()=>clearTimeout(e)},[w,d,u]);const B=(e,s=50)=>e?e.length>s?e.slice(0,s)+"...":e:"",J=e=>{U(e),q(0)},X=e=>{v(e)},_=()=>{v(null)},ee=e=>{S(e),Q(!0)},te=(e,s)=>{if(e==="question"||e==="answer"){if(!s.trim())return`${e} is required`;if(!/[a-zA-Z]/.test(s))return`${e} must contain words, not just numbers`;if(s.trim().length<10)return`${e} should be at least 10 characters long`}return""},W=e=>{const{name:s,value:b}=e.target;console.log("vudhdidsuds",s,b),C(k=>({...k,[s]:b})),Y(k=>({...k,[s]:te(s,b)}))},se=(()=>{const e=/[a-zA-Z]/.test(o.question)&&o.question.trim().length>=10,s=/[a-zA-Z]/.test(o.answer)&&o.answer.trim().length>=10;return e&&s})(),re=async()=>{if(!g){A(!0);try{const e={question:o.question,answer:o.answer},s=await l(me(e)).unwrap();p("success"),m("FAQ Added successfully."),a(!0),setTimeout(()=>a(!1),3e3),l(y({search:w,page:d,limit:u})),c(!1)}catch(e){p("error"),m("Failed to add FAQ: "+e),a(!0),setTimeout(()=>a(!1),3e3)}finally{A(!1)}}},ae=(e,s)=>{C({_id:e._id,question:e.question,answer:e.answer,createdAt:e.createdAt,updatedAt:e.updatedAt,isActive:e.isActive}),D(s),c(!0)},oe=async()=>{if(!g){A(!0);try{const e={_id:o._id,question:o.question,answer:o.answer},s=await l(pe(e)).unwrap();p("success"),m("FAQ updated successfully."),a(!0),setTimeout(()=>a(!1),3e3),c(!1),D(null),l(y({search:w,page:d,limit:u}))}catch{p("error"),m("Failed to update FAQ: "),a(!0),setTimeout(()=>a(!1),3e3)}finally{A(!1)}}},ne=async()=>{if(P){try{await l(ue(P)).unwrap(),p("error"),m("FAQ deleted successfully."),l(y({page:d,limit:u}))}catch(e){p("error"),m("Delete failed: "+e)}a(!0),setTimeout(()=>a(!1),3e3),Q(!1),S(null)}},ie=()=>{Q(!1),S(null)},le=[{accessorKey:"question",header:"Question",Cell:({row:e})=>B(e.original.question,30)},{accessorKey:"answer",header:"Answer",Cell:({row:e})=>B(e.original.answer,30)},{header:"Actions",Cell:({row:e})=>t.jsxs(i,{display:"flex",gap:1,children:[t.jsx(M,{title:"View FAQ",arrow:!0,children:t.jsx(h,{color:"primary",onClick:()=>X(e.original),children:t.jsx(ge,{})})}),t.jsx(M,{title:"Edit FAQ",arrow:!0,children:t.jsx(h,{color:"secondary",onClick:()=>ae(e.original,e.index),children:t.jsx(je,{})})}),t.jsx(h,{color:"error",onClick:()=>ee(e.original._id),children:t.jsx(he,{})})]})}];return t.jsxs(t.Fragment,{children:[t.jsx(we,{show:O,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this FAQ?",onConfirm:ne,onCancel:ie,confirmText:"Yes",cancelText:"No"}),N&&n&&t.jsx("div",{className:"p-4",children:t.jsx(V,{type:n,title:n==="success"?"Success!":n==="error"&&F.toLowerCase().includes("deleted")?"Deleted!":n==="error"?"Error!":"Warning!",message:F,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),E?t.jsxs(H,{open:E,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[t.jsx(Fe,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:j!==null?"Edit FAQ":"Add FAQ"}),t.jsx(h,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>c(!1),children:t.jsx(L,{})})]}),t.jsxs(K,{children:[N&&n&&t.jsx("div",{className:"mb-4",children:t.jsx(V,{type:n,title:n==="success"?"Success!":n==="error"&&F.toLowerCase().includes("deleted")?"Deleted!":n==="error"?"Error!":"Warning!",message:F,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),t.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(Z,{label:"Question",name:"question",value:o.question,onChange:W,errorMessage:z.question}),t.jsx(Z,{label:"Answer",name:"answer",value:o.answer,onChange:W,errorMessage:z.answer})]}),t.jsxs(i,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[t.jsx(T,{onClick:j!==null?oe:re,className:"rounded-[25px]",disabled:!se||g,children:g?j!==null?"Updating...":"Submitting...":j!==null?"Update":"Submit"}),t.jsx(T,{variant:"secondary",onClick:()=>c(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(i,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsx(i,{ml:2,children:t.jsxs(f,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Dealer App FAQs  ",t.jsx(M,{title:"Manage Dealer App FAQs by adding new questions and updating existing ones.",arrow:!0,slotProps:{popper:{sx:{"& .MuiTooltip-tooltip":{fontSize:"0.9rem",backgroundColor:"#245492",color:"#fff",fontFamily:"Outfit",padding:"8px 12px"},"& .MuiTooltip-arrow":{color:"#245492"}}}},children:t.jsx(xe,{fontSize:"medium",sx:{color:"#245492",cursor:"pointer"},onClick:e=>e.stopPropagation()})})]})}),t.jsxs(T,{onClick:()=>{C({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),D(null),c(!0)},children:[t.jsx(fe,{}),"Add New FAQ"]})]}),t.jsx(Ae,{clickHandler:J,data:G,columns:le,rowCount:R,pageIndex:d,pageSize:u,onPaginationChange:({pageIndex:e,pageSize:s})=>{q(e),$(s)}})]}),t.jsx(H,{open:!!x,onClose:_,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:t.jsxs(i,{className:"rounded-xl overflow-hidden",children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[t.jsx(f,{className:"font-outfit",variant:"h6",children:"Dealer App FAQ Details"}),t.jsx(h,{sx:{color:"white"},onClick:_,children:t.jsx(L,{})})]}),t.jsx(K,{children:x&&t.jsxs(i,{display:"flex",flexDirection:"column",gap:2,children:[t.jsxs(f,{className:"font-outfit",children:[t.jsx("strong",{children:"Question:"})," ",x.question]}),t.jsxs(f,{className:"font-outfit",children:[t.jsx("strong",{children:"Answer:"})," ",x.answer]}),t.jsxs(f,{className:"font-outfit",children:[t.jsx("strong",{children:"Created At:"})," ",new Date(x.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]})})]})})]})},st=()=>t.jsx(t.Fragment,{children:t.jsx(ye,{})});export{st as default};
