import{r as s,c as Pe,d as Ee,el as C,j as e,B as m,em as Re,en as Ue,eo as We,ep as Le}from"./index-CNh2Ysd7.js";import{P as X}from"./Preview-Bk0MjplR.js";import{I as ze}from"./Info-BLOe8JuO.js";import{A as Be}from"./Add-ONoAddvh.js";import{D as Ve}from"./Delete-BKL8mfiA.js";import{V as Oe}from"./Visibility-CFK2wX7e.js";import{C as P}from"./Close-CSWdanUp.js";import{D as $e,E as He}from"./DataTable-CBDiE-I1.js";import{I as ee}from"./InputField-Cac7SuVh.js";import{B as E}from"./Button-D2SEshHa.js";import{T as qe}from"./ToggleSwitch-CRLgVpk1.js";import{A as te}from"./Alert-BBsTbpkb.js";import{S as le}from"./SweetAlert-DUVT9XWx.js";import{F as ie}from"./FileInput-Dq-H8wev.js";import{R as se}from"./Radio-CzH1ihw6.js";import{T as Ke}from"./TextArea-DupqjNb0.js";import{v as Ye}from"./imageValidator-hDY72bsR.js";import{D as R,a as U}from"./Dialog-CMeqEyOr.js";import{D as ae}from"./DialogTitle-sP3uGIgc.js";import{I as h}from"./AlertTitle-BBXxFqxI.js";import{T}from"./Typography-DxP0RQcB.js";import{T as W}from"./Tooltip-B4POfKz-.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./Chip--RBU-Z22.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./Divider-1omdH51K.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";import"./AddPhotoAlternate-DoEGX89n.js";const Ze=()=>{var Q,G;const[l,f]=s.useState({id:"",isFullImage:!1,thumbnail_image:null,title:"",sub_title:"",full_image:null,description:""}),[r,L]=s.useState(null),[I,w]=s.useState(null),[F,v]=s.useState(!1),[y,A]=s.useState(null),[n,o]=s.useState(null),[S,c]=s.useState(""),[z,a]=s.useState(!1),[B,d]=s.useState(!1),[V,N]=s.useState(null),[re,M]=s.useState(!1),[_,ne]=s.useState(""),[x,O]=s.useState(0),[j,oe]=s.useState(10),[$,H]=s.useState(null),[ce,D]=s.useState(!1),[b,q]=s.useState(null),[ue,k]=s.useState(!1),[me,de]=s.useState({description:""}),u=Pe(),{DealerTutorialManagement:ge=[],totalItems:pe}=Ee(t=>t.Dealertutorialmanagement),he=ge.map(t=>({...t,id:t._id}));s.useEffect(()=>{const t=setTimeout(()=>{u(C({search:_,page:x,limit:j}))},500);return()=>clearTimeout(t)},[_,x,j]);const K=t=>{const{name:i,value:g}=t.target;f(p=>({...p,[i]:g}))},fe=(t,i)=>{if(t==="description"){if(!i.trim())return`${t} is required`;if(!/[a-zA-Z]/.test(i))return`${t} must contain words, not just numbers`;if(i.trim().length<10)return`${t} should be at least 10 characters long`}return""},xe=()=>/[a-zA-Z]/.test(l.description)&&l.description.trim().length>=10,je=t=>{const{name:i,value:g}=t.target;f(p=>({...p,[i]:g})),de(p=>({...p,[i]:fe(i,g)}))},be=l.isFullImage?l.full_image!==null:l.title.trim()!==""&&xe()&&l.sub_title.trim()!==""&&l.description.trim()!==""&&l.thumbnail_image!==null,Te=async()=>{if(!F){v(!0);try{const t={isFullImage:l.isFullImage,full_image:l.full_image,thumbnail_image:l.thumbnail_image,title:l.title,sub_title:l.sub_title,description:l.description},i=await u(Le(t)).unwrap();o("success"),c("Tutorial Added successfully."),a(!0),setTimeout(()=>a(!1),3e3),u(C({search:_,page:x,limit:j})),d(!1)}catch(t){o("error"),c("Failed to add Tutorial : "+t),a(!0),setTimeout(()=>a(!1),3e3)}finally{v(!1)}}},ye=async(t,i)=>{try{f({id:t._id||"",isFullImage:t.isFullImage??!1,thumbnail_image:t.thumbnail_image??null,title:t.title??"",sub_title:t.sub_title??"",full_image:t.full_image??null,description:t.description??""}),A(i),d(!0)}catch{o("error"),c("Unable to fetch Tutorial details for editing."),a(!0)}},_e=async()=>{if(!F){v(!0);try{const t={_id:l.id,isFullImage:l.isFullImage,full_image:l.full_image,thumbnail_image:l.thumbnail_image,title:l.title,sub_title:l.sub_title,description:l.description};typeof t.thumbnail_image=="object"&&t.thumbnail_image instanceof File||t.thumbnail_image;const i=await u(We(t)).unwrap();o("success"),c("Tutorial updated successfully."),a(!0),setTimeout(()=>a(!1),3e3),d(!1),A(null),u(C({search:_,page:x,limit:j}))}catch{o("error"),c("Failed to update Tutorial : "),a(!0),setTimeout(()=>a(!1),3e3)}finally{v(!1)}}},Ce=t=>{N(t),M(!0)},Ie=async()=>{if(V){try{await u(Ue(V)).unwrap(),o("error"),c("Tutorial deleted successfully."),a(!0),setTimeout(()=>a(!1),3e3),u(C({search:_,page:x,limit:j}))}catch(t){o("error"),c("Delete failed: "+t),a(!0),setTimeout(()=>a(!1),3e3)}M(!1),N(null)}},we=()=>{M(!1),N(null)},Fe=t=>{L(t)},Y=()=>{L(null),d(!1)},Z=async t=>{var J;const i=(J=t.target.files)==null?void 0:J[0],g=t.target.name;if(!i)return;const p=await Ye(i,"dealerTutorial",g);if(p){w(p);return}f(Me=>({...Me,[g]:i})),w(null)},ve=t=>{ne(t),O(0)},Se=t=>{q(t),k(!0)},De=async()=>{if(b)try{await u(Re({_id:b._id,isActive:!b.isActive})).unwrap(),o("success"),c(`Tutorial ${b.isActive?"deactivated":"activated"} successfully.`),a(!0),setTimeout(()=>a(!1),3e3),u(C({search:_,page:x,limit:j})),k(!1)}catch(t){const i=t;o("error"),c(i.message),a(!0),k(!1),setTimeout(()=>a(!1),6e3)}},ke=()=>{k(!1),q(null)},Ae=(t,i=50)=>t.length>i?t.slice(0,i)+"...":t,Ne=[{accessorFn:t=>t.title||"N/A",id:"title",header:"Title"},{accessorFn:t=>t.sub_title||"N/A",id:"sub_title",header:"Sub Title"},{accessorKey:"description",header:"Description",Cell:({row:t})=>Ae(t.original.description||"N/A",30)},{accessorKey:"isFullImage",header:"Type",Cell:({cell:t})=>t.getValue()?"Full Image":"Image with Details"},{header:"Actions",Cell:({row:t})=>(t.original,e.jsxs(m,{display:"flex",gap:1,children:[e.jsx(W,{title:"View Tutorial",arrow:!0,children:e.jsx(h,{color:"primary",onClick:()=>Fe(t.original),children:e.jsx(Oe,{})})}),e.jsx(W,{title:"Edit Tutorial",arrow:!0,children:e.jsx(h,{color:"secondary",onClick:()=>ye(t.original,t.index),children:e.jsx(He,{})})}),e.jsx(h,{color:"error",onClick:()=>Ce(t.original._id),children:e.jsx(Ve,{})}),e.jsx(qe,{checked:t.original.isActive,onChange:()=>Se(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]}))}];return e.jsxs(e.Fragment,{children:[e.jsx(le,{show:ue,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${b!=null&&b.isActive?"deactivate":"activate"} this tutorial?`,onConfirm:De,onCancel:ke,confirmText:"Yes",cancelText:"No"}),e.jsx(le,{show:re,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Tutorial ?",onConfirm:Ie,onCancel:we,confirmText:"Yes",cancelText:"No"}),z&&n&&e.jsx("div",{className:"p-4",children:e.jsx(te,{type:n,title:n==="success"?"Success!":n==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":n==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),e.jsxs(R,{open:ce,onClose:()=>D(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ae,{className:"font-outfit",children:"Image Preview"}),e.jsxs(U,{children:[$&&e.jsx("img",{src:$,alt:"Preview",style:{width:"100%",maxHeight:"500px",objectFit:"contain",borderRadius:12}}),e.jsx(h,{sx:{position:"absolute",top:12,right:12},onClick:()=>D(!1),children:e.jsx(P,{})})]})]}),B?e.jsxs(R,{open:B,onClose:(t,i)=>{i!=="backdropClick"&&d(!1)},maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(m,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(ae,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:y!==null?"Edit Tutorial":"Add Tutorial"}),e.jsx(h,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>{d(!1),w(null)},children:e.jsx(P,{})})]}),e.jsxs(U,{children:[z&&n&&e.jsx("div",{className:"mb-4",children:e.jsx(te,{type:n,title:n==="success"?"Success!":n==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":n==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(se,{id:"fullImage",name:"imageType",checked:l.isFullImage===!0,label:"Full Image",value:"true",onChange:t=>f(i=>({...i,isFullImage:t==="true"}))}),e.jsx(se,{id:"imageWithDetails",name:"imageType",checked:l.isFullImage===!1,label:"Image with details",value:"false",onChange:t=>f(i=>({...i,isFullImage:t==="true"}))})]}),l.isFullImage?e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-sm text-gray-600 mb-4",children:["Add Full Image",e.jsx("span",{className:"text-error-500",children:" * (Image resolution should be 1440×3040px) "})]}),e.jsx(ie,{id:"full_image",name:"full_image",onChange:Z}),y!==null&&l.full_image&&e.jsx("span",{className:"text-xs text-gray-500 mb-1 ms-2",children:typeof l.full_image=="string"?l.full_image.split("/").pop():(Q=l.full_image)==null?void 0:Q.name}),I&&e.jsx("span",{className:"text-xs text-error-500",children:I})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{name:"title",value:l.title,label:"Title",onChange:K}),e.jsx(ee,{name:"sub_title",value:l.sub_title,label:"Sub-Title",onChange:K}),e.jsx(Ke,{label:"Description",name:"description",value:l.description,onChange:je,errorMessage:me.description}),e.jsxs("label",{className:"text-sm text-gray-600 mb-4",children:["Add Thumbnail Image",e.jsx("span",{className:"text-error-500",children:" * (Image resolution should be 1080×1200px) "})]}),e.jsx(ie,{id:"thumbnail_image",name:"thumbnail_image",onChange:Z}),y!==null&&l.thumbnail_image&&e.jsx("span",{className:"text-xs text-gray-500 mb-1 ms-2",children:typeof l.thumbnail_image=="string"?l.thumbnail_image.split("/").pop():(G=l.thumbnail_image)==null?void 0:G.name}),I&&e.jsx("span",{className:"text-xs text-error-500",children:I})]})]}),e.jsxs(m,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(E,{onClick:y!==null?_e:Te,className:"rounded-[25px]",disabled:!be||F,children:F?y!==null?"Updating...":"Submitting...":y!==null?"Update":"Submit"}),e.jsx(E,{variant:"secondary",onClick:()=>{d(!1),w(null)},className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(m,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(m,{ml:2,children:e.jsxs(T,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Dealer Tutorial Management  ",e.jsx(W,{title:"Manage dealer app tutorial screens by adding new tutorials, deactivating old ones, and configuring up to five active images in full-image or image-with-details format.",arrow:!0,slotProps:{popper:{sx:{"& .MuiTooltip-tooltip":{fontSize:"0.9rem",backgroundColor:"#245492",color:"#fff",fontFamily:"Outfit",padding:"8px 12px"},"& .MuiTooltip-arrow":{color:"#245492"}}}},children:e.jsx(ze,{fontSize:"medium",sx:{color:"#245492",cursor:"pointer"},onClick:t=>t.stopPropagation()})})]})}),e.jsxs(E,{onClick:()=>{f({id:"",isFullImage:!1,thumbnail_image:null,title:"",sub_title:"",full_image:null,description:""}),A(null),d(!0)},children:[e.jsx(Be,{}),"Add New Tutorial "]})]}),e.jsx($e,{clickHandler:ve,data:he,columns:Ne,rowCount:pe,pageIndex:x,pageSize:j,onPaginationChange:({pageIndex:t,pageSize:i})=>{O(t),oe(i)}})]}),e.jsx(R,{open:!!r,onClose:Y,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(m,{className:"rounded-xl overflow-hidden",children:[e.jsxs(m,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(T,{className:"font-outfit",variant:"h6",children:"Tutorial Details"}),e.jsx(h,{sx:{color:"white"},onClick:Y,children:e.jsx(P,{})})]}),e.jsx(U,{children:r&&e.jsx(m,{display:"flex",flexDirection:"column",gap:2,children:r.isFullImage?e.jsx(e.Fragment,{children:e.jsxs(T,{className:"font-outfit",display:"flex",alignItems:"center",gap:1,children:[e.jsx("strong",{children:"Full Image:"}),r.full_image&&e.jsx(h,{onClick:()=>{const t=typeof r.full_image=="string"?r.full_image:r.full_image?URL.createObjectURL(r.full_image):"";H(t),D(!0)},children:e.jsx(X,{color:"primary"})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(T,{className:"font-outfit",children:[e.jsx("strong",{children:"Title:"})," ",r.title]}),e.jsxs(T,{className:"font-outfit",children:[e.jsx("strong",{children:"Sub Title:"})," ",r.sub_title]}),e.jsxs(T,{className:"font-outfit",children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),e.jsxs(m,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(T,{className:"font-outfit",children:e.jsx("strong",{children:"Thumbnail Image:"})}),r.thumbnail_image&&e.jsx(h,{onClick:()=>{const t=typeof r.thumbnail_image=="string"?r.thumbnail_image:r.thumbnail_image?URL.createObjectURL(r.thumbnail_image):"";H(t),D(!0)},children:e.jsx(X,{color:"primary"})})]})]})})})]})})]})},Mt=()=>e.jsx(e.Fragment,{children:e.jsx(Ze,{})});export{Mt as default};
