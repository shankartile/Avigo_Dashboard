import{j as e,r as a,c as xe,d as B,S as h,T as ue,B as g,U as ge,V as me,W as he,X as ye}from"./index-CcNgdVLz.js";import{c as fe}from"./createSvgIcon-ClJPFlmG.js";import{I as Ce}from"./Info-BLwzYq-V.js";import{D as je}from"./Delete-BWjouR_h.js";import{V as Ee}from"./Visibility-Bad1pPYX.js";import{C as z}from"./Close-eApB0hKv.js";import{D as Te,E as ve}from"./DataTable-DIxG5frN.js";import{I as Se}from"./InputField-BQ5ewBIw.js";import{B as b}from"./Button-B4_V5GRV.js";import{T as we}from"./ToggleSwitch-CZt8XOld.js";import{A as L}from"./Alert-U3gIVFWt.js";import{S as R}from"./SweetAlert-BfCzCAJa.js";import{T as A}from"./Typography-BMOygWke.js";import{T as D}from"./Tooltip-C-v54PpA.js";import{D as U,a as K}from"./Dialog-BdfS6Lfy.js";import{D as ke}from"./DialogTitle-BbPUlM9A.js";import{I as y}from"./AlertTitle-C4QpKbd8.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./Chip-YFG14ne-.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./Divider-BePmc644.js";import"./Tabs-CWf6flOX.js";import"./skeleton-DjwwWlQi.js";const _e=fe(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m-8 6H8v1h3c.55 0 1 .45 1 1v3c0 .55-.45 1-1 1h-1v1H8v-1H6v-2h4v-1H7c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h1V7h2v1h2zm4 6.25-2-2h4zM14 10l2-2 2 2z"})),be=()=>{const[p,C]=a.useState({id:"",category:"",expense_type_id:""}),[j,I]=a.useState(null),[E,T]=a.useState(null),[r,n]=a.useState(null),[f,i]=a.useState(""),[M,s]=a.useState(!1),[N,x]=a.useState(!1),[Ae,De]=a.useState(!1),[F,v]=a.useState(null),[O,S]=a.useState(!1),[u,Y]=a.useState(""),[l,P]=a.useState(0),[c,$]=a.useState(10),[m,w]=a.useState(null),[q,k]=a.useState(!1),o=xe(),{ExpenseCategoryMaster:X=[],totalItems:G}=B(t=>t.ExpenseCategoryMasters),{ExpenseTypeMaster:_}=B(t=>t.ExpenseTypeMaster),J=X.map(t=>({...t,id:t._id}));a.useEffect(()=>{const t=setTimeout(()=>{o(h({search:u,page:l,limit:c}))},500);return()=>clearTimeout(t)},[u,l,c]),a.useEffect(()=>{const t=setTimeout(()=>{o(ue({search:u,page:l,limit:c}))},500);return()=>clearTimeout(t)},[u,l,c]);const H=t=>{const{name:d,value:W}=t.target;C(pe=>({...pe,[d]:W}))},Q=p.category.trim()!=="",Z=async()=>{try{const t={category:p.category,expense_type_id:p.expense_type_id||""},d=await o(ye(t)).unwrap();n("success"),i("Expense Category Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(h({search:u,page:l,limit:c})),x(!1)}catch(t){n("error"),i("Failed to add Expense Category : "+t),s(!0),setTimeout(()=>s(!1),3e3)}},ee=async(t,d)=>{try{C({id:t._id||"",category:t.category||"",expense_type_id:t.expense_type_id||""}),T(d),x(!0)}catch{n("error"),i("Unable to fetch Expense Category details for editing."),s(!0)}},te=async()=>{try{const t={_id:p.id,category:p.category,expense_type_id:p.expense_type_id||""},d=await o(he(t)).unwrap();n("success"),i("Expense Category  updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),x(!1),T(null),o(h({search:u,page:l,limit:c}))}catch{n("error"),i("Failed to update Expense Category : "),s(!0),setTimeout(()=>s(!1),3e3)}},se=t=>{v(t),S(!0)},ae=async()=>{if(F){try{await o(me(F)).unwrap(),n("error"),i("Expense Category deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(h({search:u,page:l,limit:c}))}catch(t){n("error"),i("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}S(!1),v(null)}},re=()=>{S(!1),v(null)},oe=t=>{w(t),k(!0)},ne=async()=>{if(m){try{await o(ge({_id:m._id,isActive:!m.isActive})).unwrap(),n("success"),i(`Expense Category ${m.isActive?"deactivated":"activated"} successfully.`),s(!0),o(h({search:u,page:l,limit:c}))}catch(t){n("error"),i("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),k(!1),w(null)}},ie=()=>{k(!1),w(null)},le=t=>{I(t)},V=()=>{I(null),x(!1)},ce=t=>{Y(t),P(0)},de=[{accessorKey:"category",header:"Expense category"},{accessorKey:"expense_type_name",header:"Expense Type"},{header:"Actions",Cell:({row:t})=>e.jsxs(g,{display:"flex",gap:1,children:[e.jsx(D,{title:"View Details",children:e.jsx(y,{color:"primary",onClick:()=>le(t.original),children:e.jsx(Ee,{})})}),!t.original.isOthers&&e.jsx(D,{title:"Edit",children:e.jsx("span",{children:e.jsx(y,{color:"secondary",onClick:()=>ee(t.original,t.index),children:e.jsx(ve,{})})})}),!t.original.isOthers&&e.jsx(y,{color:"error",onClick:()=>se(t.original._id),children:e.jsx(je,{})}),e.jsx(we,{checked:t.original.isActive,onChange:()=>oe(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(R,{show:q,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${m!=null&&m.isActive?"deactivate":"activate"} this Expense Category?`,onConfirm:ne,onCancel:ie,confirmText:"Yes",cancelText:"No"}),e.jsx(R,{show:O,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Expense Category ?",onConfirm:ae,onCancel:re,confirmText:"Yes",cancelText:"No"}),M&&r&&e.jsx("div",{className:"p-4",children:e.jsx(L,{type:r,title:r==="success"?"Success!":r==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),N?e.jsxs(U,{open:N,onClose:(t,d)=>{d!=="backdropClick"&&x(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(g,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(ke,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:E!==null?"Edit Expense Category":"Add Expense Category"}),e.jsx(y,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>x(!1),children:e.jsx(z,{})})]}),e.jsxs(K,{children:[M&&r&&e.jsx("div",{className:"mb-4",children:e.jsx(L,{type:r,title:r==="success"?"Success!":r==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-1 block",children:["Expense Type ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"expense_type_id",value:p.expense_type_id,onChange:H,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Expense Type"}),_==null?void 0:_.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t._id,children:t.expense_type},t._id))]})]}),e.jsx(Se,{label:"Expense Category ",name:"category",value:p.category,onChange:H})]}),e.jsxs(g,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(b,{onClick:E!==null?te:Z,className:"rounded-[25px]",disabled:!Q,children:E!==null?"Update Expense Category ":"Add Expense Category "}),e.jsx(b,{variant:"secondary",onClick:()=>x(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(g,{ml:2,children:e.jsxs(A,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Expense Category Master",e.jsx(D,{title:"Add/edit categories like Repairs, Electricity, Housekeeping, Security, etc.",arrow:!0,children:e.jsx(Ce,{sx:{color:"#245492",ml:1}})})]})}),e.jsxs(b,{onClick:()=>{C({id:"",category:"",expense_type_id:""}),T(null),x(!0)},children:[e.jsx(_e,{}),"Add New Expense Category "]})]}),e.jsx(Te,{clickHandler:ce,data:J,columns:de,rowCount:G,pageIndex:l,pageSize:c,onPaginationChange:({pageIndex:t,pageSize:d})=>{P(t),$(d)}})]}),e.jsx(U,{open:!!j,onClose:V,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(g,{className:"rounded-xl overflow-hidden",children:[e.jsxs(g,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(A,{className:"font-outfit",variant:"h6",children:"Expense Category Details"}),e.jsx(y,{sx:{color:"white"},onClick:V,children:e.jsx(z,{})})]}),e.jsx(K,{children:j&&e.jsx(g,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(A,{className:"font-outfit",children:[e.jsx("strong",{children:"Expense Category :"})," ",j.category]})})})]})})]})},it=()=>e.jsx(e.Fragment,{children:e.jsx(be,{})});export{it as default};
