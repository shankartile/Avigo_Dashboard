import{r,c as ce,d as de,eO as y,j as t,B as i,eP as ue,eQ as pe,eR as me}from"./index-CNh2Ysd7.js";import{I as fe}from"./Info-BLOe8JuO.js";import{A as xe}from"./Add-ONoAddvh.js";import{D as he}from"./Delete-BKL8mfiA.js";import{V as ge}from"./Visibility-CFK2wX7e.js";import{C as L}from"./Close-CSWdanUp.js";import{D as Ae,E as je}from"./DataTable-CBDiE-I1.js";import{B as M}from"./Button-D2SEshHa.js";import{S as we}from"./SweetAlert-DUVT9XWx.js";import{A as V}from"./Alert-BBsTbpkb.js";import{T as R}from"./TextArea-DupqjNb0.js";import{T as x}from"./Typography-DxP0RQcB.js";import{T}from"./Tooltip-B4POfKz-.js";import{D as Z,a as $}from"./Dialog-CMeqEyOr.js";import{D as Fe}from"./DialogTitle-sP3uGIgc.js";import{I as h}from"./AlertTitle-BBXxFqxI.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./Chip--RBU-Z22.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./Divider-1omdH51K.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const ye=()=>{const[n,C]=r.useState({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),l=ce(),{FAQManagement:D,totalItems:H}=de(e=>e.FAQManagement),[g,A]=r.useState(!1),[j,Q]=r.useState(null),[f,I]=r.useState(null),[w,K]=r.useState(""),[d,q]=r.useState(0),[u,U]=r.useState(10),[o,p]=r.useState(null),[F,m]=r.useState(""),[v,a]=r.useState(!1),[N,c]=r.useState(!1),[E,S]=r.useState(null),[O,b]=r.useState(!1),[Ce,Qe]=r.useState([]),[P,Y]=r.useState({question:"",answer:""}),G=Array.isArray(D)?D.map(e=>({...e,id:e._id})):[];r.useEffect(()=>{const e=setTimeout(()=>{l(y({search:w,page:d,limit:u}))},500);return()=>clearTimeout(e)},[w,d,u]);const J=(e,s)=>{if(e==="question"||e==="answer"){if(!s.trim())return`${e} is required`;if(!/[a-zA-Z]/.test(s))return`${e} must contain words, not just numbers`;if(s.trim().length<10)return`${e} should be at least 10 characters long`}return""},z=(e,s=50)=>e?e.length>s?e.slice(0,s)+"...":e:"",X=e=>{K(e),q(0)},ee=e=>{I(e)},_=()=>{I(null)},te=e=>{S(e),b(!0)},B=e=>{const{name:s,value:W}=e.target;C(k=>({...k,[s]:W})),Y(k=>({...k,[s]:J(s,W)}))},se=(()=>{const e=/[a-zA-Z]/.test(n.question)&&n.question.trim().length>=5,s=/[a-zA-Z]/.test(n.answer)&&n.answer.trim().length>=5;return e&&s})(),re=async()=>{if(!g){A(!0);try{const e={question:n.question,answer:n.answer},s=await l(me(e)).unwrap();p("success"),m("FAQ Added successfully."),a(!0),l(y({search:w,page:d,limit:u})),c(!1)}catch(e){p("error"),m("Failed to add FAQ: "+e),a(!0)}finally{A(!1)}}},ne=(e,s)=>{C({_id:e._id,question:e.question,answer:e.answer,createdAt:e.createdAt,updatedAt:e.updatedAt,isActive:e.isActive}),Q(s),c(!0)},oe=async()=>{if(!g){A(!0);try{const e={_id:n._id,question:n.question,answer:n.answer},s=await l(pe(e)).unwrap();p("success"),m("FAQ updated successfully."),a(!0),setTimeout(()=>a(!1),3e3),c(!1),Q(null),l(y({search:w,page:d,limit:u}))}catch(e){console.error("FAQ update failed:",e),p("error"),m(`Failed to update FAQ: ${(e==null?void 0:e.message)||e}`),a(!0),setTimeout(()=>a(!1),3e3)}finally{A(!1)}}},ae=async()=>{if(E){try{await l(ue(E)).unwrap(),p("error"),m("FAQ deleted successfully."),l(y({page:d,limit:u}))}catch(e){p("error"),m("Delete failed: "+e)}a(!0),setTimeout(()=>a(!1),3e3),b(!1),S(null)}},ie=()=>{b(!1),S(null)},le=[{accessorKey:"question",header:"Question",Cell:({row:e})=>z(e.original.question,30)},{accessorKey:"answer",header:"Answer",Cell:({row:e})=>z(e.original.answer,30)},{header:"Actions",Cell:({row:e})=>t.jsxs(i,{display:"flex",gap:1,children:[t.jsx(T,{title:"View FAQ",arrow:!0,children:t.jsx(h,{color:"primary",onClick:()=>ee(e.original),children:t.jsx(ge,{})})}),t.jsx(T,{title:"Edit FAQ",arrow:!0,children:t.jsx(h,{color:"secondary",onClick:()=>ne(e.original,e.index),children:t.jsx(je,{})})}),t.jsx(h,{color:"error",onClick:()=>te(e.original._id),children:t.jsx(he,{})})]})}];return t.jsxs(t.Fragment,{children:[t.jsx(we,{show:O,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this FAQ?",onConfirm:ae,onCancel:ie,confirmText:"Yes",cancelText:"No"}),v&&o&&t.jsx("div",{className:"p-4",children:t.jsx(V,{type:o,title:o==="success"?"Success!":o==="error"&&F.toLowerCase().includes("deleted")?"Deleted!":o==="error"?"Error!":"Warning!",message:F,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),N?t.jsxs(Z,{open:N,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[t.jsx(Fe,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:j!==null?"Edit FAQ":"Add FAQ"}),t.jsx(h,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>c(!1),children:t.jsx(L,{})})]}),t.jsxs($,{children:[v&&o&&t.jsx("div",{className:"mb-4",children:t.jsx(V,{type:o,title:o==="success"?"Success!":o==="error"&&F.toLowerCase().includes("deleted")?"Deleted!":o==="error"?"Error!":"Warning!",message:F,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>a(!1)})}),t.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(R,{label:"Question",name:"question",value:n.question,onChange:B,errorMessage:P.question}),t.jsx(R,{label:"Answer",name:"answer",value:n.answer,onChange:B,errorMessage:P.answer})]}),t.jsxs(i,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[t.jsx(M,{onClick:j!==null?oe:re,className:"rounded-[25px]",disabled:!se||g,children:g?j!==null?"Updating...":"Submitting...":j!==null?"Update":"Submit"}),t.jsx(M,{variant:"secondary",onClick:()=>c(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(i,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsx(i,{ml:2,children:t.jsxs(x,{variant:"h5",fontWeight:500,className:"font-outfit",children:["FAQs  ",t.jsx(T,{title:"Manage the website FAQ section by adding, updating frequently asked questions.",arrow:!0,slotProps:{popper:{sx:{"& .MuiTooltip-tooltip":{fontSize:"0.9rem",backgroundColor:"#245492",color:"#fff",fontFamily:"Outfit",padding:"8px 12px"},"& .MuiTooltip-arrow":{color:"#245492"}}}},children:t.jsx(fe,{fontSize:"medium",sx:{color:"#245492",cursor:"pointer"},onClick:e=>e.stopPropagation()})})]})}),t.jsxs(M,{onClick:()=>{C({_id:"",question:"",answer:"",createdAt:"",updatedAt:"",isActive:!1}),Q(null),c(!0)},children:[t.jsx(xe,{}),"Add New FAQ"]})]}),t.jsx(Ae,{clickHandler:X,data:G,columns:le,rowCount:H,pageIndex:d,pageSize:u,onPaginationChange:({pageIndex:e,pageSize:s})=>{q(e),U(s)}})]}),t.jsx(Z,{open:!!f,onClose:_,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:t.jsxs(i,{className:"rounded-xl overflow-hidden",children:[t.jsxs(i,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[t.jsx(x,{className:"font-outfit",variant:"h6",children:"FAQ Details"}),t.jsx(h,{sx:{color:"white"},onClick:_,children:t.jsx(L,{})})]}),t.jsx($,{children:f&&t.jsxs(i,{display:"flex",flexDirection:"column",gap:2,children:[t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Question:"})," ",f.question]}),t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Answer:"})," ",f.answer]}),t.jsxs(x,{className:"font-outfit",children:[t.jsx("strong",{children:"Created At:"})," ",new Date(f.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]})]})})]})})]})},st=()=>t.jsx(t.Fragment,{children:t.jsx(ye,{})});export{st as default};
