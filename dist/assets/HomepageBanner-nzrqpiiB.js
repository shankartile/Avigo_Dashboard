import{r,c as ke,d as Y,eI as v,j as e,B as p,eJ as Ae,eK as Ce,eL as De}from"./index-CNh2Ysd7.js";import{A as Se}from"./Add-ONoAddvh.js";import{I as Le}from"./Info-BLOe8JuO.js";import{P as Te}from"./Preview-Bk0MjplR.js";import{D as ve}from"./Delete-BKL8mfiA.js";import{V as Be}from"./Visibility-CFK2wX7e.js";import{C as M}from"./Close-CSWdanUp.js";import{D as Ie,E as Ne}from"./DataTable-CBDiE-I1.js";import{B as H}from"./Button-D2SEshHa.js";import{S as Ve}from"./SweetAlert-DUVT9XWx.js";import{A as G}from"./Alert-BBsTbpkb.js";import{I as E}from"./InputField-Cac7SuVh.js";import{F as Fe}from"./FileInput-Dq-H8wev.js";import{v as Pe}from"./imageValidator-hDY72bsR.js";import{T as Me}from"./TextArea-DupqjNb0.js";import{D as K,a as W}from"./Dialog-CMeqEyOr.js";import{D as Q}from"./DialogTitle-sP3uGIgc.js";import{I as g}from"./AlertTitle-BBXxFqxI.js";import{T as m}from"./Typography-DxP0RQcB.js";import{T as U}from"./Tooltip-B4POfKz-.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./Chip--RBU-Z22.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./Divider-1omdH51K.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";import"./AddPhotoAlternate-DoEGX89n.js";const He=()=>{const[s,k]=r.useState({_id:"",title:"",images:[],ctaLabel:"",shortDescription:"",ctaLink:"",type:"",createdAt:"",updatedAt:"",isActive:!1}),u=ke(),{HomepageBanner:Ee}=Y(t=>t.homepagebanner),[A,C]=r.useState(!1),[b,B]=r.useState(null),[n,_]=r.useState(null),[D,X]=r.useState(""),[x,$]=r.useState(0),[f,ee]=r.useState(10),[l,y]=r.useState(null),[S,j]=r.useState(""),[z,i]=r.useState(!1),[q,h]=r.useState(!1),[R,I]=r.useState(null),[te,N]=r.useState(!1),[Ke,We]=r.useState([]),[O,se]=r.useState(null),[ae,V]=r.useState(!1),[Z,L]=r.useState(null),[Ue,F]=r.useState(null),[re,ie]=r.useState({shortDescription:""}),{HomepageBanner:oe=[],totalItems:ne}=Y(t=>t.homepagebanner),le=oe.map(t=>({...t,id:t._id}));r.useEffect(()=>{const t=setTimeout(()=>{u(v({search:D,page:x,limit:f}))},500);return()=>clearTimeout(t)},[D,x,f]);const ce=async t=>{var T;const a=(T=t.target.files)==null?void 0:T[0],o=t.target.name;if(!a)return;let c="homepagebannerdesktop";s.type==="mobile"&&(c="homepagebannermobile");const d=await Pe(a,c,o);if(d){L(d);return}k(P=>({...P,images:[a]})),L(null)},de=t=>{X(t),$(0)},pe=t=>{_(t)},J=()=>{_(null)},me=t=>{I(t),N(!0)},w=t=>{const{name:a,value:o}=t.target;let c=o;a==="type"&&(c=o==="Desktop View"?"desktop":o==="Mobile View"?"mobile":""),k(d=>({...d,[a]:c})),ie(d=>({...d,[a]:je(a,o)}))},ue=!!s.images,he=async()=>{if(!A){C(!0);try{const t={type:s.type==="desktop"?"Desktop View":"Mobile View",title:s.title,images:Array.isArray(s.images)?s.images.filter(o=>o instanceof File):[],ctaLabel:s.ctaLabel,ctaLink:s.ctaLink,shortDescription:s.shortDescription},a=await u(De(t)).unwrap();y("success"),j("Banner Added successfully."),i(!0),setTimeout(()=>i(!1),3e3),u(v({search:D,page:x,limit:f})),h(!1)}catch(t){y("error"),j("Failed to add banner: "+t),i(!0),setTimeout(()=>i(!1),3e3)}finally{C(!1)}}},ge=(t,a)=>{k({_id:t._id,type:t.type,title:t.title,images:t.images,ctaLabel:t.ctaLabel,shortDescription:t.shortDescription,ctaLink:t.ctaLink??"",createdAt:t.createdAt,updatedAt:t.updatedAt,isActive:t.isActive}),F(a===0?"desktop":a===1?"mobile":null),B(a),h(!0)},xe=async()=>{if(!A){C(!0);try{const t={_id:s._id,type:s.type==="desktop"?"Desktop View":"Mobile View",title:s.title,images:Array.isArray(s.images)?s.images.filter(o=>o instanceof File):[],ctaLabel:s.ctaLabel,ctaLink:s.ctaLink,shortDescription:s.shortDescription},a=await u(Ce(t)).unwrap();y("success"),j("Banner updated successfully."),i(!0),setTimeout(()=>i(!1),3e3),h(!1),B(null),u(v({search:D,page:x,limit:f}))}catch(t){y("error"),j("Failed to update Banner: "+t),i(!0),setTimeout(()=>i(!1),3e3)}finally{C(!1)}}},fe=async()=>{if(R){try{await u(Ae(R)).unwrap(),y("error"),j("Banner deleted successfully."),u(v({page:x,limit:f}))}catch(t){y("error"),j("Delete failed: "+t)}i(!0),setTimeout(()=>i(!1),3e3),N(!1),I(null)}},ye=()=>{N(!1),I(null)},je=(t,a)=>{if(t==="shortDescription"){if(!a.trim())return`${t} is required`;if(!/[a-zA-Z]/.test(a))return`${t} must contain words, not just numbers`;if(a.trim().length<10)return`${t} should be at least 10 characters long`}return""},be=(t,a=50)=>t.length>a?t.slice(0,a)+"...":t,we=[{accessorKey:"type",header:"View Type",Cell:({row:t})=>t.original.type||"N/A"},{accessorKey:"title",header:"Title",Cell:({row:t})=>t.original.title||"N/A"},{accessorKey:"images",header:"Image",Cell:({row:t})=>e.jsx("img",{src:t.original.images[0],alt:"Banner",style:{width:100,height:60,objectFit:"cover",borderRadius:8}})},{accessorKey:"ctaLabel",header:"CTA Label",Cell:({row:t})=>t.original.ctaLabel||"N/A"},{accessorKey:"ctaLink",header:"CTA Link",Cell:({row:t})=>be(t.original.ctaLink||"N/A",30)},{accessorKey:"createdAt",header:"Created At",Cell:({cell:t})=>{const a=t.getValue();return new Date(a).toLocaleDateString("en-IN",{year:"numeric",month:"numeric",day:"numeric"})}},{accessorKey:"updatedAt",header:"Updated At",Cell:({row:t})=>{const a=new Date(t.original.updatedAt),o=a.toLocaleDateString("en-IN",{year:"numeric",month:"numeric",day:"numeric"});let c=a.getHours();const d=a.getMinutes(),T=c>=12?"PM":"AM";c=c%12||12;const P=`${c}:${d.toString().padStart(2,"0")} ${T}`;return`${o} ${P}`}},{header:"Actions",Cell:({row:t})=>e.jsxs(p,{display:"flex",gap:1,children:[e.jsx(U,{title:"View Details",arrow:!0,children:e.jsx(g,{color:"primary",onClick:()=>pe(t.original),children:e.jsx(Be,{})})}),e.jsx(U,{title:"Edit Banner",arrow:!0,children:e.jsx(g,{color:"secondary",onClick:()=>ge(t.original,t.index),children:e.jsx(Ne,{})})}),e.jsx(g,{color:"error",onClick:()=>me(t.original._id),children:e.jsx(ve,{})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{show:te,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this banner?",onConfirm:fe,onCancel:ye,confirmText:"Yes",cancelText:"No"}),z&&l&&e.jsx("div",{className:"p-4",children:e.jsx(G,{type:l,title:l==="success"?"Success!":l==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":l==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>i(!1)})}),e.jsxs(K,{open:ae,onClose:()=>V(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Q,{className:"font-outfit",children:"Image Preview"}),e.jsxs(W,{children:[O&&e.jsx("img",{src:O,alt:"Preview",style:{width:"100%",maxHeight:"500px",objectFit:"contain",borderRadius:12}}),e.jsx(g,{sx:{position:"absolute",top:12,right:12},onClick:()=>V(!1),children:e.jsx(M,{})})]})]}),q?e.jsxs(K,{open:q,onClose:()=>h(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(Q,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:b!==null?"Edit Banner":"Add Bannner"}),e.jsx(g,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>{h(!1),L(null)},children:e.jsx(M,{})})]}),e.jsxs(W,{children:[z&&l&&e.jsx("div",{className:"mb-4",children:e.jsx(G,{type:l,title:l==="success"?"Success!":l==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":l==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>i(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-2 block",children:["View Type ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"type",value:s.type==="desktop"?"Desktop View":s.type==="mobile"?"Mobile View":"",onChange:w,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select View Type"}),e.jsx("option",{value:"Desktop View",children:"Desktop View"}),e.jsx("option",{value:"Mobile View",children:"Mobile View"})]})]}),e.jsx(E,{label:"Banner Title",name:"title",value:s.title,onChange:w,required:!1}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 mb-4",children:["Banner Image",e.jsxs("span",{className:"text-error-500",children:["* (",s.type==="mobile"?"Image resolution should be 1320×1055px":s.type==="desktop"?"Image resolution should be 1920×736px":"Please select view type",")"]})]}),e.jsx(Fe,{accept:"image/*",id:"image",name:"image",onChange:ce}),b!==null&&s.images&&e.jsx("span",{className:"text-xs text-gray-500 mb-1 ms-2",children:Array.isArray(s.images)?typeof s.images[0]=="string"?s.images[0].split("/").pop():s.images[0].name:typeof s.images=="string"?s.images.split("/").pop():s.images.name}),Z&&e.jsx("span",{className:"text-xs text-error-500",children:Z})]}),e.jsx(E,{label:"Banner ctaLabel",name:"ctaLabel",value:s.ctaLabel,onChange:w,required:!1}),e.jsx(E,{label:"Banner ctaLink",name:"ctaLink",value:s.ctaLink,onChange:w,required:!1}),e.jsx(Me,{label:"Short Description",name:"shortDescription",value:s.shortDescription,onChange:w,maxLength:95,errorMessage:re.shortDescription})]}),e.jsxs(p,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(H,{onClick:b!==null?xe:he,className:"rounded-[25px]",disabled:!ue||A,children:A?b!==null?"Updating...":"Submitting...":b!==null?"Update":"Submit"}),e.jsx(H,{variant:"secondary",onClick:()=>{h(!1),L(null)},className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(p,{ml:2,children:e.jsxs(m,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Homepage Banners  ",e.jsx(U,{title:"Add, update, and view hero banners displayed on the website’s home page.",arrow:!0,slotProps:{popper:{sx:{"& .MuiTooltip-tooltip":{fontSize:"0.9rem",backgroundColor:"#245492",color:"#fff",fontFamily:"Outfit",padding:"8px 12px"},"& .MuiTooltip-arrow":{color:"#245492"}}}},children:e.jsx(Le,{fontSize:"medium",sx:{color:"#245492",cursor:"pointer"},onClick:t=>t.stopPropagation()})})]})}),e.jsxs(H,{onClick:()=>{k({_id:"",type:"",title:"",images:[],ctaLabel:"",shortDescription:"",ctaLink:"",createdAt:"",updatedAt:"",isActive:!1}),B(null),h(!0)},children:[e.jsx(Se,{}),"Add New Banner"]})]}),e.jsx(Ie,{clickHandler:de,data:le,columns:we,rowCount:ne,pageIndex:x,pageSize:f,onPaginationChange:({pageIndex:t,pageSize:a})=>{$(t),ee(a)}})]}),e.jsx(K,{open:!!n,onClose:J,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(p,{className:"rounded-xl overflow-hidden",children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(m,{className:"font-outfit",variant:"h6",children:"Banner Details"}),e.jsx(g,{sx:{color:"white"},onClick:J,children:e.jsx(M,{})})]}),e.jsx(W,{children:n&&e.jsxs(p,{display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(m,{className:"font-outfit",children:[e.jsx("strong",{children:"Title:"})," ",n.title]}),e.jsxs(m,{className:"font-outfit",children:[e.jsx("strong",{children:"CTA Label:"})," ",n.ctaLabel]}),e.jsxs(m,{className:"font-outfit",children:[e.jsx("strong",{children:"CTA Link:"})," ",n.ctaLink]}),e.jsxs(m,{className:"font-outfit",children:[e.jsx("strong",{children:"Created At:"})," ",new Date(n.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]}),e.jsxs(m,{className:"font-outfit",children:[e.jsx("strong",{children:"Updated At:"})," ",new Date(n.updatedAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]}),e.jsxs(m,{className:"font-outfit",display:"flex",alignItems:"center",gap:1,children:[e.jsx("strong",{children:"Full Image:"}),Array.isArray(n.images)&&n.images.length>0&&typeof n.images[0]=="string"&&e.jsx(g,{onClick:()=>{var a;const t=(a=n.images)==null?void 0:a[0];se(t),V(!0)},children:e.jsx(Te,{color:"primary"})})]})]})})]})})]})},At=()=>e.jsx(e.Fragment,{children:e.jsx(He,{})});export{At as default};
