import{j as e,r as o,c as ue,d as L,Y as x,Z as ge,B as p,_ as pe,$ as he,a0 as xe,a1 as ye}from"./index-N8t8oMzR.js";import{I as fe}from"./Info-lyeC1xGk.js";import{c as Ce}from"./createSvgIcon-DUEWsKfg.js";import{D as je}from"./Delete-07TAjR17.js";import{V as Ie}from"./Visibility-CgGAKN6P.js";import{C as V}from"./Close-CwR_quIe.js";import{D as Te,E as ve}from"./DataTable-BqUD-dAi.js";import{I as we}from"./InputField-riaj6edy.js";import{B as k}from"./Button-CBNcrDpD.js";import{T as Se}from"./ToggleSwitch-DR4b514_.js";import{A as H}from"./Alert-CgNUKTJk.js";import{S as R}from"./SweetAlert-vzLgp13W.js";import{T as A}from"./Typography-CKlLxaDL.js";import{T as D}from"./Tooltip-CwyNn424.js";import{D as U,a as Y}from"./Dialog-BGF2t3L7.js";import{D as _e}from"./DialogTitle-D6DEKDqS.js";import{I as y}from"./AlertTitle-D9ejxV9_.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./Chip-Dnlh_trd.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const be=Ce(e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})),ke=()=>{const[m,C]=o.useState({id:"",category:"",income_type_id:""}),[j,M]=o.useState(null),[I,T]=o.useState(null),[a,n]=o.useState(null),[f,i]=o.useState(""),[N,s]=o.useState(!1),[E,u]=o.useState(!1),[Ae,De]=o.useState(!1),[F,v]=o.useState(null),[$,w]=o.useState(!1),[g,K]=o.useState(""),[c,P]=o.useState(0),[l,O]=o.useState(10),[h,S]=o.useState(null),[q,_]=o.useState(!1),r=ue(),{IncomeCategoryMaster:Z=[],totalItems:G}=L(t=>t.IncomeCategoryMasters),{IncomeTypeMaster:b}=L(t=>t.IncomeTypeMaster),J=Z.map(t=>({...t,id:t._id}));o.useEffect(()=>{const t=setTimeout(()=>{r(x({search:g,page:c,limit:l}))},500);return()=>clearTimeout(t)},[g,c,l]),o.useEffect(()=>{const t=setTimeout(()=>{r(ge({search:g,page:c,limit:l}))},500);return()=>clearTimeout(t)},[g,c,l]);const z=t=>{const{name:d,value:W}=t.target;C(me=>({...me,[d]:W}))},Q=m.category.trim()!=="",X=async()=>{try{const t={category:m.category,income_type_id:m.income_type_id||""},d=await r(ye(t)).unwrap();n("success"),i("Income Category Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),r(x({search:g,page:c,limit:l})),u(!1)}catch(t){n("error"),i("Failed to add Income Category : "+t),s(!0),setTimeout(()=>s(!1),3e3)}},ee=async(t,d)=>{try{C({id:t._id||"",category:t.category||"",income_type_id:t.income_type_id||""}),T(d),u(!0)}catch{n("error"),i("Unable to fetch Income Category details for editing."),s(!0)}},te=async()=>{try{const t={_id:m.id,category:m.category,income_type_id:m.income_type_id||""},d=await r(xe(t)).unwrap();n("success"),i("Income Category  updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),u(!1),T(null),r(x({search:g,page:c,limit:l}))}catch{n("error"),i("Failed to update Income Category : "),s(!0),setTimeout(()=>s(!1),3e3)}},se=t=>{v(t),w(!0)},oe=async()=>{if(F){try{await r(he(F)).unwrap(),n("error"),i("Income Category deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),r(x({search:g,page:c,limit:l}))}catch(t){n("error"),i("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}w(!1),v(null)}},ae=()=>{w(!1),v(null)},re=t=>{S(t),_(!0)},ne=async()=>{if(h){try{await r(pe({_id:h._id,isActive:!h.isActive})).unwrap(),n("success"),i(`Income Category ${h.isActive?"deactivated":"activated"} successfully.`),s(!0),r(x({search:g,page:c,limit:l}))}catch(t){n("error"),i("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),_(!1),S(null)}},ie=()=>{_(!1),S(null)},ce=t=>{M(t)},B=()=>{M(null),u(!1)},le=t=>{K(t),P(0)},de=[{accessorKey:"category",header:"Income category"},{accessorKey:"income_type_name",header:"Income Type"},{header:"Actions",Cell:({row:t})=>e.jsxs(p,{display:"flex",gap:1,children:[e.jsx(D,{title:"View Details",children:e.jsx(y,{color:"primary",onClick:()=>ce(t.original),children:e.jsx(Ie,{})})}),!t.original.isOthers&&e.jsx(D,{title:"Edit",children:e.jsx("span",{children:e.jsx(y,{color:"secondary",onClick:()=>ee(t.original,t.index),children:e.jsx(ve,{})})})}),!t.original.isOthers&&e.jsx(y,{color:"error",onClick:()=>se(t.original._id),children:e.jsx(je,{})}),e.jsx(Se,{checked:t.original.isActive,onChange:()=>re(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(R,{show:q,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${h!=null&&h.isActive?"deactivate":"activate"} this Income Category?`,onConfirm:ne,onCancel:ie,confirmText:"Yes",cancelText:"No"}),e.jsx(R,{show:$,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Income Category ?",onConfirm:oe,onCancel:ae,confirmText:"Yes",cancelText:"No"}),N&&a&&e.jsx("div",{className:"p-4",children:e.jsx(H,{type:a,title:a==="success"?"Success!":a==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":a==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),E?e.jsxs(U,{open:E,onClose:(t,d)=>{d!=="backdropClick"&&u(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(_e,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:I!==null?"Edit Income Category":"Add Income Category"}),e.jsx(y,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>u(!1),children:e.jsx(V,{})})]}),e.jsxs(Y,{children:[N&&a&&e.jsx("div",{className:"mb-4",children:e.jsx(H,{type:a,title:a==="success"?"Success!":a==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":a==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-1 block",children:["Income Type ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"income_type_id",value:m.income_type_id,onChange:z,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Income Type"}),b==null?void 0:b.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t._id,children:t.income_type},t._id))]})]}),e.jsx(we,{label:"Income Category ",name:"category",value:m.category,onChange:z})]}),e.jsxs(p,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(k,{onClick:I!==null?te:X,className:"rounded-[25px]",disabled:!Q,children:I!==null?"Update Income Category ":"Add Income Category "}),e.jsx(k,{variant:"secondary",onClick:()=>u(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(p,{ml:2,children:e.jsxs(A,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Income Category Master",e.jsx(D,{title:"Add/edit items like Maintenance, Penalty, Interest, Event Income.",arrow:!0,children:e.jsx(fe,{sx:{color:"#245492",ml:1}})})]})}),e.jsxs(k,{onClick:()=>{C({id:"",category:"",income_type_id:""}),T(null),u(!0)},children:[e.jsx(be,{}),"Add New Income Category "]})]}),e.jsx(Te,{clickHandler:le,data:J,columns:de,rowCount:G,pageIndex:c,pageSize:l,onPaginationChange:({pageIndex:t,pageSize:d})=>{P(t),O(d)}})]}),e.jsx(U,{open:!!j,onClose:B,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(p,{className:"rounded-xl overflow-hidden",children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(A,{className:"font-outfit",variant:"h6",children:"Income Category Details"}),e.jsx(y,{sx:{color:"white"},onClick:B,children:e.jsx(V,{})})]}),e.jsx(Y,{children:j&&e.jsx(p,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(A,{className:"font-outfit",children:[e.jsx("strong",{children:"Income Category :"})," ",j.category]})})})]})})]})},it=()=>e.jsx(e.Fragment,{children:e.jsx(ke,{})});export{it as default};
