import{j as e,B as l,c as Y,d as Z,r as n,k as p,t as ee,l as te}from"./index-CNh2Ysd7.js";import{A as se}from"./Add-ONoAddvh.js";import{D as ie,E as ne}from"./DataTable-CBDiE-I1.js";import{D as re}from"./Delete-BKL8mfiA.js";import{V as ae}from"./Visibility-CFK2wX7e.js";import{I as le}from"./Info-BLOe8JuO.js";import{B as oe}from"./Button-D2SEshHa.js";import{S as z}from"./SweetAlert-DUVT9XWx.js";import{T as de}from"./ToggleSwitch-CRLgVpk1.js";import{A as ce}from"./AddResident-DKKIcfwr.js";import{C as me}from"./Close-CSWdanUp.js";import{D as he,a as xe}from"./Dialog-CMeqEyOr.js";import{T as a}from"./Typography-DxP0RQcB.js";import{I as y}from"./AlertTitle-BBXxFqxI.js";import{A as fe}from"./Avatar-CCsDKzZ8.js";import{D as v}from"./Divider-1omdH51K.js";import{T as j}from"./Tooltip-B4POfKz-.js";import{C as k}from"./Chip--RBU-Z22.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./DialogTitle-sP3uGIgc.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";import"./InputField-Cac7SuVh.js";import"./Alert-BBsTbpkb.js";const ue=({open:o,data:i,onClose:f})=>{var u;return i?e.jsx(he,{open:o,onClose:f,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(xe,{sx:{p:0},children:e.jsxs(l,{className:"bg-white rounded-xl",children:[e.jsxs(l,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(a,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Resident Details"}),e.jsx(y,{sx:{color:"white"},onClick:f,children:e.jsx(me,{})})]}),e.jsxs(l,{px:6,py:4,children:[e.jsxs(l,{display:"flex",gap:3,mb:3,alignItems:"center",children:[e.jsx(fe,{sx:{width:90,height:90,bgcolor:"#245492",fontSize:32,fontWeight:600},children:(u=i.residentName)==null?void 0:u.charAt(0)}),e.jsxs(l,{children:[e.jsx(a,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"20px",fontWeight:600},children:i.residentName}),e.jsx(a,{sx:{fontFamily:"Outfit, sans-serif"},children:i.email}),e.jsx(a,{sx:{fontFamily:"Outfit, sans-serif"},children:i.mobile})]})]}),e.jsx(v,{sx:{my:3}}),e.jsxs(l,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,children:[e.jsxs(a,{children:[e.jsx("strong",{children:"Resident Type:"})," ",i.residentType]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Flat Area:"})," ",i.residentFlatarea]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Flat Size:"})," ",i.residentFlatsize]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Parking:"})," ",i.residentParkingname]})]}),(i.secondresidentName||i.secondresidentEmail||i.secondresidentMobile)&&e.jsxs(e.Fragment,{children:[e.jsx(v,{sx:{my:3}}),e.jsx(a,{sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,mb:1},children:"Second Resident Details"}),e.jsxs(l,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,children:[i.secondresidentName&&e.jsxs(a,{children:[e.jsx("strong",{children:"Name:"})," ",i.secondresidentName]}),i.secondresidentEmail&&e.jsxs(a,{children:[e.jsx("strong",{children:"Email:"})," ",i.secondresidentEmail]}),i.secondresidentMobile&&e.jsxs(a,{children:[e.jsx("strong",{children:"Mobile:"})," ",i.secondresidentMobile]})]})]}),e.jsx(v,{sx:{my:3}}),e.jsxs(l,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,children:[e.jsxs(a,{children:[e.jsx("strong",{children:"Status:"})," ",i.isActive?"Active":"Inactive"]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Created On:"})," ",new Date(i.createdAt).toLocaleDateString()]})]})]})]})})}):null},ge=()=>{const o=Y(),{residents:i,totalItems:f}=Z(s=>s.adminresident),[u,S]=n.useState(0),[g,P]=n.useState(10),[K,b]=n.useState(!1),[C,m]=n.useState(null),[O,I]=n.useState(!1),[B,pe]=n.useState(null),[F,D]=n.useState(null),[T,A]=n.useState(null),[N,W]=n.useState(!1),[E,V]=n.useState(!1),[M,w]=n.useState(""),[U,$]=n.useState([]),[d,q]=n.useState(""),[c,_]=n.useState(""),R=n.useRef(null),H=s=>{$(s),S(0);const r={};s.forEach(({id:h,value:t})=>{t&&(r[h]=h==="isActive"?t==="Active":t)}),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{o(p({search:M,filters:r,fromDate:d||void 0,toDate:c||void 0,page:0,limit:g}))},500)};n.useEffect(()=>{d&&!c||!d&&c||o(p({fromDate:d||void 0,toDate:c||void 0,page:0,limit:g}))},[d,c]);const L=async(s,r)=>{w(s),S(0),await o(p({search:s,fromDate:d,toDate:c,exportType:r,page:0,limit:g}))},G=s=>{if(!s||!s.length){console.error("Excel file is empty");return}const r=[],h=[];if(s.forEach((t,X)=>{const x=X+2;if(!t.residentName){r.push({row:x,message:"Resident Name is required"});return}if(!t.residentType){r.push({row:x,message:"Resident Type is required"});return}if(!t.mobile||!/^[6-9]\d{9}$/.test(String(t.mobile))){r.push({row:x,message:"Invalid mobile number"});return}if(t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t.email))){r.push({row:x,message:"Invalid email format"});return}if(t.residentFlatsize&&(isNaN(t.residentFlatsize)||Number(t.residentFlatsize)<=0)){r.push({row:x,message:"Invalid flat size"});return}h.push({residentName:String(t.residentName).trim(),residentType:String(t.residentType).trim(),email:t.email?String(t.email).trim():"",mobile:String(t.mobile).trim(),residentFlatsize:t.residentFlatsize?Number(t.residentFlatsize):null,residentFlatarea:t.residentFlatarea?String(t.residentFlatarea).trim():"",residentParkingname:t.residentParkingname?String(t.residentParkingname).trim():"",secondresidentName:t.secondresidentName?String(t.secondresidentName).trim():"",secondresidentEmail:t.secondresidentEmail?String(t.secondresidentEmail).trim():"",secondresidentMobile:t.secondresidentMobile?String(t.secondresidentMobile).trim():""})}),r.length){console.error("Excel Validation Errors:",r);return}console.log("Validated Excel Data:",h)},J=[{accessorKey:"residentName",header:"Resident Name",filterVariant:"text"},{accessorKey:"residentType",header:"Resident Type",filterVariant:"text"},{accessorKey:"email",header:"Email",filterVariant:"text"},{accessorKey:"mobile",header:"Mobile",filterVariant:"text"},{accessorKey:"societyName",header:"Society",filterVariant:"text"},{accessorKey:"residentFlatsize",header:"Resident Flat Size",filterVariant:"text"},{accessorKey:"residentFlatarea",header:"Resident Flat Area",filterVariant:"text"},{accessorKey:"residentParkingname",header:"Parking Name",filterVariant:"text"},{accessorKey:"secondresidentName",header:"Secondary Resident Name",filterVariant:"text"},{accessorKey:"secondresidentEmail",header:"Secondary Resident Email",filterVariant:"text"},{accessorKey:"secondresidentMobile",header:"Secondary Resident Mobile",filterVariant:"text"},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:s})=>s.getValue()?e.jsx(k,{label:"Active",color:"success",size:"small"}):e.jsx(k,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:s})=>e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(j,{title:"View",children:e.jsx(y,{onClick:()=>{m(s.original),I(!0)},children:e.jsx(ae,{})})}),e.jsx(j,{title:"Edit",children:e.jsx(y,{onClick:()=>{m(s.original),V(!1),b(!0)},children:e.jsx(ne,{})})}),e.jsx(j,{title:"Delete",children:e.jsx(y,{color:"error",onClick:()=>D(s.original._id),children:e.jsx(re,{})})}),e.jsx(de,{checked:s.original.isActive,onChange:()=>{A(s.original._id),W(!s.original.isActive)}})]})}],Q=async()=>{F&&(await o(te(F)),D(null))};return e.jsxs(e.Fragment,{children:[e.jsx(z,{show:!!F,type:"error",title:"Delete Resident",message:"Are you sure you want to delete this resident?",onConfirm:Q,onCancel:()=>D(null)}),e.jsx(z,{show:!!T,type:"warning",title:"Change Resident Status",message:`Are you sure you want to ${N?"activate":"deactivate"} this resident?`,confirmText:N?"Activate":"Deactivate",cancelText:"Cancel",onConfirm:()=>{T&&o(ee(T)),A(null)},onCancel:()=>A(null)}),e.jsx(ue,{open:O,data:C,onClose:()=>{I(!1),m(null)}}),K?e.jsx(ce,{society:B,editData:C,isEditMode:!E&&!!C,viewOnly:E,onCancel:()=>{b(!1),m(null),V(!1)}}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(a,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Member And Unit Management Module",e.jsx(j,{title:"This module allows the Society Admin to manage all flats/units and residents.",arrow:!0,children:e.jsx(le,{sx:{color:"#245492",ml:1}})})]}),e.jsxs(oe,{onClick:()=>{m(null),b(!0)},children:[e.jsx(se,{})," Add Resident"]})]}),e.jsx(ie,{data:i,columns:J,rowCount:f,pageIndex:u,pageSize:g,enableColumnFilters:!0,columnFilters:U,onColumnFiltersChange:H,exportType:!0,clickHandler:L,fromDate:d,toDate:c,onFromDateChange:q,onToDateChange:_,onPaginationChange:({pageIndex:s,pageSize:r})=>{S(s),P(r),o(p({search:M,page:s,limit:r}))},onFileUpload:G})]})]})},Xe=()=>e.jsx(e.Fragment,{children:e.jsx(ge,{})});export{Xe as default};
