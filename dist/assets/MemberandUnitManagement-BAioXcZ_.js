import{j as e,c as Z,d as ee,r as n,k as x,t as te,B as k,l as se}from"./index-CcNgdVLz.js";import{D as ie,E as ne}from"./DataTable-DIxG5frN.js";import{D as re}from"./Delete-BWjouR_h.js";import{V as ae}from"./Visibility-Bad1pPYX.js";import{I as le}from"./Info-BLwzYq-V.js";import{c as oe}from"./createSvgIcon-ClJPFlmG.js";import{B as ce}from"./Button-B4_V5GRV.js";import{S as K}from"./SweetAlert-BfCzCAJa.js";import{T as de}from"./ToggleSwitch-CZt8XOld.js";import{A as me}from"./AddResident-Dr6gTMFh.js";import{A as he}from"./ArrowBack-Dpb-03kv.js";import{A as P}from"./Avatar-D05Y1472.js";import{T}from"./Typography-BMOygWke.js";import{C as I}from"./Chip-YFG14ne-.js";import{D as B}from"./Divider-BePmc644.js";import{T as u}from"./Tooltip-C-v54PpA.js";import{I as D}from"./AlertTitle-C4QpKbd8.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./Close-eApB0hKv.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./Dialog-BdfS6Lfy.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./DialogTitle-BbPUlM9A.js";import"./Tabs-CWf6flOX.js";import"./skeleton-DjwwWlQi.js";import"./InputField-BQ5ewBIw.js";import"./Alert-U3gIVFWt.js";const ge=oe(e.jsx("path",{d:"M13 8c0-2.21-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4 4-1.79 4-4m2 2v2h3v3h2v-3h3v-2h-3V7h-2v3zM1 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4"})),xe=({data:s,onClose:p})=>{var g,o;if(!s)return null;const f=[["Resident Type",s.residentType],["Flat Area",s.residentFlatarea],["Flat Size",s.residentFlatsize],["Parking",s.residentParkingname],["Email",s.email],["Mobile",s.mobile],["Created On",new Date(s.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})]];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-6 pt-6 bg-white flex items-center gap-2",children:e.jsxs("button",{onClick:p,className:"flex items-center text-[#255593] hover:underline",children:[e.jsx(he,{fontSize:"small"}),e.jsx("span",{className:"ml-1 font-medium",children:"Back"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 px-6 py-10 bg-white",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-full h-[380px] rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(P,{sx:{width:140,height:140,bgcolor:"#245492",fontSize:48,fontWeight:600},children:(g=s.residentName)==null?void 0:g.charAt(0)})})}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{sx:{width:56,height:56,bgcolor:"#245492"},children:(o=s.residentName)==null?void 0:o.charAt(0)}),e.jsxs("div",{children:[e.jsx(T,{variant:"h6",fontWeight:600,children:s.residentName}),e.jsx(I,{size:"small",label:s.isActive?"Active":"Inactive",color:s.isActive?"success":"default"})]})]}),e.jsx(B,{sx:{borderColor:"#255593",borderBottomWidth:"2px",mb:3}}),e.jsx("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6",children:f.map(([c,j],y)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:c}),e.jsx("p",{className:"text-gray-800 font-medium",children:j||"-"})]},y))}),(s.secondresidentName||s.secondresidentEmail||s.secondresidentMobile)&&e.jsxs(e.Fragment,{children:[e.jsx(B,{sx:{my:4}}),e.jsx(T,{fontWeight:600,mb:2,children:"Second Resident Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6",children:[s.secondresidentName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Name"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.secondresidentName})]}),s.secondresidentEmail&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Email"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.secondresidentEmail})]}),s.secondresidentMobile&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Mobile"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.secondresidentMobile})]})]})]})]})]})]})},ue=()=>{const s=Z(),{residents:p,totalItems:f}=ee(i=>i.adminresident),[g,o]=n.useState(0),[c,j]=n.useState(10),[y,S]=n.useState(!1),[v,d]=n.useState(null),[w,R]=n.useState(!1),[W,pe]=n.useState(null),[b,N]=n.useState(null),[F,A]=n.useState(null),[E,O]=n.useState(!1),[V,M]=n.useState(!1),[z,U]=n.useState(""),[$,q]=n.useState([]),[a,_]=n.useState(""),[l,H]=n.useState(""),C=n.useRef(null),L=i=>{q(i),o(0);const r={};i.forEach(({id:m,value:t})=>{t&&(r[m]=m==="isActive"?t==="Active":t)}),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{s(x({search:z,filters:r,fromDate:a||void 0,toDate:l||void 0,page:0,limit:c}))},500)};n.useEffect(()=>{a&&!l||!a&&l||s(x({fromDate:a||void 0,toDate:l||void 0,page:0,limit:c}))},[a,l]);const G=async(i,r)=>{U(i),o(0),await s(x({search:i,fromDate:a,toDate:l,exportType:r,page:0,limit:c}))},J=i=>{if(!i||!i.length){console.error("Excel file is empty");return}const r=[],m=[];if(i.forEach((t,Y)=>{const h=Y+2;if(!t.residentName){r.push({row:h,message:"Resident Name is required"});return}if(!t.residentType){r.push({row:h,message:"Resident Type is required"});return}if(!t.mobile||!/^[6-9]\d{9}$/.test(String(t.mobile))){r.push({row:h,message:"Invalid mobile number"});return}if(t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t.email))){r.push({row:h,message:"Invalid email format"});return}if(t.residentFlatsize&&(isNaN(t.residentFlatsize)||Number(t.residentFlatsize)<=0)){r.push({row:h,message:"Invalid flat size"});return}m.push({residentName:String(t.residentName).trim(),residentType:String(t.residentType).trim(),email:t.email?String(t.email).trim():"",mobile:String(t.mobile).trim(),residentFlatsize:t.residentFlatsize?Number(t.residentFlatsize):null,residentFlatarea:t.residentFlatarea?String(t.residentFlatarea).trim():"",residentParkingname:t.residentParkingname?String(t.residentParkingname).trim():"",secondresidentName:t.secondresidentName?String(t.secondresidentName).trim():"",secondresidentEmail:t.secondresidentEmail?String(t.secondresidentEmail).trim():"",secondresidentMobile:t.secondresidentMobile?String(t.secondresidentMobile).trim():""})}),r.length){console.error("Excel Validation Errors:",r);return}console.log("Validated Excel Data:",m)},Q=[{accessorKey:"residentName",header:"Resident Name",filterVariant:"text"},{accessorKey:"residentType",header:"Resident Type",filterVariant:"text"},{accessorKey:"email",header:"Email",filterVariant:"text"},{accessorKey:"mobile",header:"Mobile",filterVariant:"text"},{accessorKey:"societyName",header:"Society",filterVariant:"text"},{accessorKey:"residentFlatsize",header:"Resident Flat Size",filterVariant:"text"},{accessorKey:"residentFlatarea",header:"Resident Flat Area",filterVariant:"text"},{accessorKey:"residentParkingname",header:"Parking Name",filterVariant:"text"},{accessorKey:"secondresidentName",header:"Secondary Resident Name",filterVariant:"text"},{accessorKey:"secondresidentEmail",header:"Secondary Resident Email",filterVariant:"text"},{accessorKey:"secondresidentMobile",header:"Secondary Resident Mobile",filterVariant:"text"},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:i})=>i.getValue()?e.jsx(I,{label:"Active",color:"success",size:"small"}):e.jsx(I,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:i})=>e.jsxs(k,{display:"flex",gap:1,children:[e.jsx(u,{title:"View",children:e.jsx(D,{onClick:()=>{d(i.original),R(!0)},children:e.jsx(ae,{})})}),e.jsx(u,{title:"Edit",children:e.jsx(D,{onClick:()=>{d(i.original),M(!1),S(!0)},children:e.jsx(ne,{})})}),e.jsx(u,{title:"Delete",children:e.jsx(D,{color:"error",onClick:()=>N(i.original._id),children:e.jsx(re,{})})}),e.jsx(de,{checked:i.original.isActive,onChange:()=>{A(i.original._id),O(!i.original.isActive)}})]})}],X=async()=>{b&&(await s(se(b)),N(null))};return e.jsxs(e.Fragment,{children:[e.jsx(K,{show:!!b,type:"error",title:"Delete Resident",message:"Are you sure you want to delete this resident?",onConfirm:X,onCancel:()=>N(null)}),e.jsx(K,{show:!!F,type:"warning",title:"Change Resident Status",message:`Are you sure you want to ${E?"activate":"deactivate"} this resident?`,confirmText:E?"Activate":"Deactivate",cancelText:"Cancel",onConfirm:()=>{F&&s(te(F)),A(null)},onCancel:()=>A(null)}),w?e.jsx(xe,{data:v,onClose:()=>{R(!1),d(null)}}):y?e.jsx(me,{society:W,editData:v,isEditMode:!V&&!!v,viewOnly:V,onCancel:()=>{S(!1),d(null),M(!1)}}):e.jsxs(e.Fragment,{children:[e.jsxs(k,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(T,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Member And Unit Management Module",e.jsx(u,{title:"This module allows the Society Admin to manage all flats/units and residents.",arrow:!0,children:e.jsx(le,{sx:{color:"#245492",ml:1}})})]}),e.jsxs(ce,{onClick:()=>{d(null),S(!0)},children:[e.jsx(ge,{})," Add Resident"]})]}),e.jsx(ie,{data:p,columns:Q,rowCount:f,pageIndex:g,pageSize:c,enableColumnFilters:!0,columnFilters:$,onColumnFiltersChange:L,exportType:!0,clickHandler:G,fromDate:a,toDate:l,onFromDateChange:_,onToDateChange:H,onPaginationChange:({pageIndex:i,pageSize:r})=>{o(i),j(r),s(x({search:z,page:i,limit:r}))},onFileUpload:J})]})]})},Qe=()=>e.jsx(e.Fragment,{children:e.jsx(ue,{})});export{Qe as default};
