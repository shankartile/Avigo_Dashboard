import{j as e,B as l,c as K,r as i,o as X,p as Z,d as ee,q as k,v as te,w as se}from"./index-CNh2Ysd7.js";import{A as ne}from"./Add-ONoAddvh.js";import{C as ie,D as oe,E as ae}from"./DataTable-CBDiE-I1.js";import{D as re}from"./Delete-BKL8mfiA.js";import{V as le}from"./Visibility-CFK2wX7e.js";import{I as ce}from"./Info-BLOe8JuO.js";import{B as O}from"./Button-D2SEshHa.js";import{S as z}from"./SweetAlert-DUVT9XWx.js";import{T as de}from"./ToggleSwitch-CRLgVpk1.js";import{C as L}from"./Close-CSWdanUp.js";import{D as me,a as ue}from"./Dialog-CMeqEyOr.js";import{T as m}from"./Typography-DxP0RQcB.js";import{I as T}from"./AlertTitle-BBXxFqxI.js";import{C as D}from"./Chip--RBU-Z22.js";import{D as W}from"./Divider-1omdH51K.js";import{J as he}from"./jodit-react-CT8-Abq2.js";import{I as fe}from"./InputField-Cac7SuVh.js";import{A as pe}from"./Alert-BBsTbpkb.js";import{T as I}from"./Tooltip-B4POfKz-.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./DialogTitle-sP3uGIgc.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const xe=({open:r,data:t,onClose:d})=>t?e.jsx(me,{open:r,onClose:d,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(ue,{sx:{p:0},children:e.jsxs(l,{className:"bg-white rounded-xl",children:[e.jsxs(l,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"},children:[e.jsx(m,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Notice Details"}),e.jsx(T,{sx:{color:"white"},onClick:d,children:e.jsx(L,{})})]}),e.jsxs(l,{px:6,py:4,children:[e.jsx(m,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"22px",fontWeight:600,color:"#1f2937",mb:1},children:t.title}),e.jsxs(l,{display:"flex",gap:2,mb:2,children:[e.jsx(D,{label:t.category,color:"primary"}),e.jsx(D,{label:t.isActive?"Active":"Inactive",color:t.isActive?"success":"error"})]}),e.jsx(W,{sx:{my:2}}),e.jsx(m,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"15px",fontWeight:600,mb:1},children:"Description"}),e.jsx(l,{sx:{border:"1px solid #e5e7eb",borderRadius:1,p:2,backgroundColor:"#fafafa",fontFamily:"Outfit, sans-serif",fontSize:"14px",lineHeight:"22px"},dangerouslySetInnerHTML:{__html:t.description}}),e.jsx(W,{sx:{my:3}}),e.jsxs(l,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,children:[e.jsxs(m,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Acknowledge Required:"})," ",t.acknowledgeRequired?"Yes":"No"]}),e.jsxs(m,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Read Count:"})," ",t.readCount]}),e.jsxs(m,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Created On:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]})]})})}):null,_={title:"",category:"",description:"",acknowledgeRequired:!1,attachments:[]},ge=["General","Emergency","Finance","Event"],je=({onCancel:r,editData:t,isEditMode:d,isViewMode:c=!1})=>{const b=K(),[o,u]=i.useState(_),[w,S]=i.useState(!1),[x,h]=i.useState(null),[v,g]=i.useState(""),[N,f]=i.useState(!1);i.useEffect(()=>{u(t?{title:t.title||"",category:t.category||"",description:t.description||"",acknowledgeRequired:t.acknowledgeRequired||!1,attachments:[]}:_)},[t]);const A=a=>{const{name:s,value:p}=a.target;u(E=>({...E,[s]:p}))},F=a=>{const s=a.target.files;s&&u(p=>({...p,attachments:Array.from(s)}))},P=async a=>{if(a.preventDefault(),!w){S(!0);try{const s=new FormData;s.append("title",o.title),s.append("category",o.category),s.append("description",o.description),s.append("acknowledgeRequired",String(o.acknowledgeRequired)),o.attachments.forEach(p=>{s.append("attachments",p)}),d&&(t!=null&&t._id)?(await b(X({_id:t._id,data:s})).unwrap(),g("Notice updated successfully")):(await b(Z(s)).unwrap(),g("Notice published successfully")),h("success"),f(!0),setTimeout(()=>{f(!1),r()},1500)}catch(s){h("error"),g(s||"Something went wrong"),f(!0)}finally{S(!1)}}},R=o.title&&o.category&&o.description;return e.jsxs(e.Fragment,{children:[N&&x&&e.jsx(pe,{type:x,title:x==="success"?"Success!":"Error!",message:v,variant:"filled",showLink:!1,onClose:()=>f(!1)}),e.jsxs(l,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(l,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(m,{variant:"h6",children:c?"Notice Details":d?"Update Notice":"Create Notice"}),e.jsx(T,{sx:{color:"white"},onClick:r,children:e.jsx(L,{})})]}),e.jsxs(l,{component:"form",onSubmit:P,px:6,py:4,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(fe,{label:"Notice Title",name:"title",value:o.title,onChange:A,disabled:c}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"Category"}),e.jsxs("select",{name:"category",value:o.category,onChange:A,disabled:c,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Category"}),ge.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"Description"}),e.jsx(he,{value:o.description,config:{readonly:c,height:300},onBlur:a=>u(s=>({...s,description:a}))})]}),!c&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"Attachments (PDF / Image / Docs)"}),e.jsx("input",{type:"file",multiple:!0,onChange:F,className:"w-full border p-2 rounded"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(ie,{checked:o.acknowledgeRequired,onChange:a=>u(s=>({...s,acknowledgeRequired:a.target.checked})),disabled:c}),e.jsx(m,{children:"Acknowledge Required"})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[!c&&e.jsx(O,{disabled:!R||w,children:w?d?"Updating...":"Publishing...":d?"Update Notice":"Publish Notice"}),e.jsx(O,{variant:"secondary",onClick:r,children:c?"Back":"Cancel"})]})]})]})]})},ye=()=>{const r=K(),{notices:t,totalItems:d}=ee(n=>n.noticesandannouncement),[c,b]=i.useState(0),[o,u]=i.useState(10),[w,S]=i.useState(!1),[x,h]=i.useState(null),[v,g]=i.useState(null),[N,f]=i.useState(null),[A,F]=i.useState(!1),[P,R]=i.useState(!1),[a,s]=i.useState(!1),[p,E]=i.useState(""),[H,G]=i.useState([]),[j,U]=i.useState(""),[y,J]=i.useState(""),q=i.useRef(null),M=n=>{G(n),b(0);const C={};n.forEach(({id:V,value:B})=>{B&&(C[V]=V==="isActive"?B==="Active":B)}),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{r(k({search:p,filters:C,fromDate:j||void 0,toDate:y||void 0,page:0,limit:o}))},500)};i.useEffect(()=>{j&&!y||!j&&y||r(k({fromDate:j||void 0,toDate:y||void 0,page:0,limit:o}))},[j,y]);const Y=async(n,C)=>{E(n),b(0),await r(k({search:n,fromDate:j,toDate:y,exportType:C,page:0,limit:o}))},$=[{accessorKey:"title",header:"Title",filterVariant:"text"},{accessorKey:"category",header:"Category",filterVariant:"select",filterSelectOptions:["General","Emergency","Finance","Event"]},{accessorKey:"createdAt",header:"Created Date",filterVariant:"text"},{accessorKey:"readCount",header:"Read Count",filterVariant:"text",muiTableBodyCellProps:{align:"center"},muiTableHeadCellProps:{align:"center"},Cell:({cell:n})=>e.jsx(l,{sx:{width:32,height:32,borderRadius:"50%",backgroundColor:"#ff9800",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:600,mx:"auto"},children:n.getValue()})},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:n})=>n.getValue()?e.jsx(D,{label:"Active",color:"success",size:"small"}):e.jsx(D,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:n})=>e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(I,{title:"View",children:e.jsx(T,{onClick:()=>{h(n.original),s(!0)},children:e.jsx(le,{})})}),e.jsx(I,{title:"Edit",children:e.jsx(T,{onClick:()=>{h(n.original),R(!1),S(!0)},children:e.jsx(ae,{})})}),e.jsx(I,{title:"Delete",children:e.jsx(T,{color:"error",onClick:()=>g(n.original._id),children:e.jsx(re,{})})}),e.jsx(de,{checked:n.original.isActive,onChange:()=>{f(n.original._id),F(!n.original.isActive)}})]})}],Q=async()=>{v&&(await r(se(v)),g(null))};return e.jsxs(e.Fragment,{children:[e.jsx(z,{show:!!v,type:"error",title:"Delete Notice",message:"Are you sure you want to delete this notice?",onConfirm:Q,onCancel:()=>g(null)}),e.jsx(z,{show:!!N,type:"warning",title:"Change Notice Status",message:`Are you sure you want to ${A?"activate":"deactivate"} this notice?`,confirmText:A?"Activate":"Deactivate",cancelText:"Cancel",onConfirm:()=>{N&&r(te(N)),f(null)},onCancel:()=>f(null)}),e.jsx(xe,{open:a,data:x,onClose:()=>{s(!1),h(null)}}),w?e.jsx(je,{editData:x,isEditMode:!!x,onCancel:()=>{S(!1),h(null)}}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(m,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Notices & Announcements Management Module",e.jsx(I,{title:"Create, publish and manage society notices and announcements.",arrow:!0,children:e.jsx(ce,{sx:{color:"#245492",ml:1}})})]}),e.jsxs(O,{onClick:()=>{h(null),S(!0)},children:[e.jsx(ne,{})," Create Notice"]})]}),e.jsx(oe,{data:t,columns:$,rowCount:d,pageIndex:c,pageSize:o,enableColumnFilters:!0,columnFilters:H,onColumnFiltersChange:M,exportType:!0,clickHandler:Y,fromDate:j,toDate:y,onFromDateChange:U,onToDateChange:J,onPaginationChange:({pageIndex:n,pageSize:C})=>{b(n),u(C),r(k({search:p,page:n,limit:C}))}})]})]})},Xe=()=>e.jsx(e.Fragment,{children:e.jsx(ye,{})});export{Xe as default};
