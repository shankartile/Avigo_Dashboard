import{c as $,a as K,d as A,r as a,bH as y,j as t,B as F,bI as w}from"./index-CcNgdVLz.js";import{S as l}from"./skeleton-DjwwWlQi.js";import{C as I,a as T,b as D}from"./Check-BoXD29II.js";import{C as E}from"./Chip-YFG14ne-.js";import{C as H}from"./CircularProgress-CVM8C023.js";import{T as q}from"./Tooltip-C-v54PpA.js";import{c as u}from"./createLucideIcon-XjDe6m21.js";import"./createSvgIcon-ClJPFlmG.js";import"./utils-BtYGnpaM.js";import"./useSlotProps-z1QAC-gu.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],U=u("car",O);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Z=u("credit-card",W);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],J=u("user-check",G);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],V=u("user-plus",Q),X={subscription:"/superadmin/subscriptionmanagement",productlistings:"/superadmin/productlistings",supportticket:"/superadmin/supportticketmanagement",usermanagement:"/superadmin/usermanagement"},Y=[{key:"all",label:"All"},{key:"Dealer Management",label:"Dealer Registered"},{key:"Buyer Management",label:"Buyer Registered"},{key:"Subscription Management",label:"Subscription Purchased"},{key:"CarListingManagement",label:"Car Listings"},{key:"BikeListingManagement",label:"Bike Listings"},{key:"SpareListingManagement",label:"Spare Part Listings"},{key:"DealerSupportModule",label:"Dealer Support Tickets"},{key:"BuyerSupportModule",label:"Buyer Support Tickets"}],ee={subscription:"bg-purple-50",productlistings:"bg-yellow-50",usermanagement:"bg-green-50",supportticket:"bg-red-50",dealermanagement:"bg-blue-50"},te={subscription:t.jsx(Z,{size:18,className:"mr-2 text-purple-600"}),productlistings:t.jsx(U,{size:18,className:"mr-2 text-yellow-600"}),usermanagement:t.jsx(J,{size:18,className:"mr-2 text-green-600"}),supportticket:t.jsx(D,{size:18,className:"mr-2 text-red-600"}),dealermanagement:t.jsx(V,{size:18,className:"mr-2 text-blue-600"})},se=()=>t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsx("h2",{className:"font-outfit text-2xl font-bold text-gray-800 mb-4",children:t.jsx(l,{width:200,height:28})}),t.jsx("div",{className:"bg-white rounded-xl p-4 flex flex-wrap gap-4 mb-6 border border-gray-200",children:Array.from({length:6}).map((n,o)=>t.jsx(l,{height:32,width:140,style:{borderRadius:16}},o))}),t.jsx("div",{className:"max-w-[900px] mx-auto",children:Array.from({length:6}).map((n,o)=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-3 flex flex-col border border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col flex-1",children:[t.jsx(l,{height:20,width:"60%",className:"mb-1"}),t.jsx(l,{height:16,width:"80%"})]}),t.jsx(l,{circle:!0,height:28,width:28})]}),t.jsx(l,{height:14,width:"30%",className:"mt-1"})]},o))})]}),re=()=>{const n=$(),o=K(),{Notifications:m,loading:C,pagination:{totalPages:M},loadedPages:ae=[]}=A(e=>e.superAdminDashboard),[s,S]=a.useState("all"),[f,R]=a.useState(!0),[p,h]=a.useState(!1),[b,k]=a.useState({all:1}),j=a.useRef(null);a.useRef(1);const B=a.useRef(M),g=a.useRef(!1),d=a.useRef([]);a.useEffect(()=>{k(e=>({...e,[s]:1})),d.current=d.current.filter(e=>!e.startsWith(s)),n(y({page:1,type:s}))},[s,n]),a.useEffect(()=>{const e=setTimeout(()=>R(!1),600);return()=>clearTimeout(e)},[]),a.useEffect(()=>{n(y({page:1,type:s}))},[s]);const N=a.useCallback(()=>{if(g.current||p)return;const r=(b[s]||1)+1,i=B.current??0;!i||r>i||d.current.includes(`${s}-${r}`)||(g.current=!0,h(!0),n(y({page:r,type:s})).then(()=>{k(c=>({...c,[s]:r})),d.current.push(`${s}-${r}`)}).catch(c=>console.warn("[notifications] fetch error",c)).finally(()=>{g.current=!1,h(!1)}))},[n,p,s,b]);a.useEffect(()=>{const e=j.current;if(!e)return;const r=new IntersectionObserver(i=>{i[0].isIntersecting&&setTimeout(()=>{N()},1e3)},{root:null,rootMargin:"300px",threshold:.1});return r.observe(e),()=>r.disconnect()},[N,m.length,f]);const P=e=>{let r="";e.moduleKey==="supportticket"?r=e.type==="BuyerSupportModule"?"/superadmin/supportticketmanagement?type=buyer":"/superadmin/supportticketmanagement?type=dealer":e.moduleKey==="productlistings"?r=e.type==="CarListingManagement"?"/superadmin/productlistings?type=car":e.type==="BikeListingManagement"?"/superadmin/productlistings?type=bike":"/superadmin/productlistings?type=sparepart":e.moduleKey==="usermanagement"?r=e.type==="Buyer Management"?"/superadmin/buyermanagment":"/superadmin/dealermanagment":r=X[e.moduleKey],r&&n(w(e._id)).then(()=>{o(r)})},_=(e,r)=>{e.stopPropagation(),n(w(r))},x=s==="all"?m:m.filter(e=>e.type===s||e.moduleKey===s);return f?t.jsx(se,{}):t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsx("h2",{className:"font-outfit text-2xl font-bold text-gray-800 mb-4",children:"Notifications"}),t.jsx(F,{className:"bg-white rounded-xl p-4 flex flex-wrap gap-4 mb-6 border border-gray-200 sticky top-0 z-10",children:Y.map(e=>t.jsx(E,{label:e.label,clickable:!0,onClick:()=>S(e.key),variant:s===e.key?"filled":"outlined",sx:{fontFamily:"Outfit, sans-serif",fontSize:"0.95rem",backgroundColor:s===e.key?"#255593":"transparent",color:s===e.key?"#fff":"#255593",borderColor:"#255593","&:hover":{backgroundColor:s===e.key?"#1e467c":"rgba(37, 85, 147, 0.08)"},"&.Mui-disabled":{backgroundColor:"#8ca5c2",color:"#fff"}}},e.key))}),t.jsx("div",{className:"max-w-[900px] mx-auto",children:x.length===0&&!C?t.jsx("div",{className:"text-center text-gray-400 mt-10",children:"No notifications"}):x.map((e,r)=>{const i=te[e.moduleKey]||t.jsx(I,{size:18}),c=ee[e.moduleKey]||"",L=e.isRead?"text-gray-500 opacity-70":"bg-blue-100 font-semibold",v=r===x.length-1;return t.jsx("div",{ref:v?j:null,onClick:()=>P(e),className:`rounded-lg shadow-sm p-4 mb-3 flex flex-col hover:shadow-md transition cursor-pointer border border-gray-200 ${c} ${L}`,children:v&&p?t.jsx("div",{className:"flex justify-center py-4",children:t.jsx(H,{size:36})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col text-md text-gray-800",children:[t.jsxs("div",{className:`flex items-center text-md ${e.isRead?"text-gray-500":"font-semibold"}`,children:[i,e.title]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:e.message})]}),!e.isRead&&t.jsx(q,{title:"Mark as read",children:t.jsx("button",{onClick:z=>_(z,e._id),className:"text-xs ml-2 text-blue-500 hover:underline",children:t.jsx(T,{})})})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]})},e._id)})})]})},xe=()=>t.jsx(t.Fragment,{children:t.jsx(re,{})});export{xe as default};
