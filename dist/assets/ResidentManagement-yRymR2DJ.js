import{j as e,c as F,r as n,B as j,aK as A,d as E,aL as K,aM as z,aN as D}from"./index-CcNgdVLz.js";import{A as M}from"./Add-CQx2oSmS.js";import{D as B,E as q}from"./DataTable-DIxG5frN.js";import{D as H}from"./Delete-BWjouR_h.js";import{V as U}from"./Visibility-Bad1pPYX.js";import{I as _}from"./Info-BLwzYq-V.js";import{B as v}from"./Button-B4_V5GRV.js";import{S as V}from"./SweetAlert-BfCzCAJa.js";import{T as P}from"./ToggleSwitch-CZt8XOld.js";import{C as L}from"./Close-eApB0hKv.js";import{I as x}from"./InputField-BQ5ewBIw.js";import{A as O}from"./Alert-U3gIVFWt.js";import{T as N}from"./Typography-BMOygWke.js";import{I as R}from"./AlertTitle-C4QpKbd8.js";import{T as S}from"./Tooltip-C-v54PpA.js";import{C as I}from"./Chip-YFG14ne-.js";const w=({label:r,name:i,value:p,options:t,placeholder:g="Select an option",onChange:o,className:y="",disabled:u=!1})=>{const l=typeof t[0]=="string"?t.map(d=>({value:d,label:d})):t;return e.jsxs("div",{className:"flex flex-col",children:[r&&e.jsx("label",{className:"mb-1 text-sm text-gray-600 dark:text-gray-300",children:r}),e.jsxs("select",{name:i,value:p,disabled:u,onChange:o,className:`h-11 w-full appearance-none rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 pr-11 text-sm shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-none focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 ${p?"text-gray-800 dark:text-white/90":"text-gray-400 dark:text-gray-400"} ${y}`,children:[e.jsx("option",{style:{color:"black"},value:"",disabled:!0,children:g}),l.map(d=>e.jsx("option",{style:{color:"black"},value:d.value,className:"text-gray-700 dark:bg-gray-900 dark:text-gray-300",children:d.label},d.value))]})]})},$={residentName:"",residentType:"",flatType:"",flatSizeSqFt:"",mobile:"",email:"",secondaryResidentName:"",secondaryResidentMobile:"",secondaryResidentEmail:""},W=({onCancel:r,society:i})=>{const p=F(),[t,g]=n.useState($),[o,y]=n.useState(!1),[u,l]=n.useState(null),[d,c]=n.useState(""),[m,h]=n.useState(!1),a=b=>{const{name:s,value:T}=b.target;g(k=>({...k,[s]:T}))},f=async b=>{if(b.preventDefault(),o||!(i!=null&&i._id)){l("error"),c("Society not selected. Please select a society first."),h(!0);return}y(!0);try{await p(A({societyId:i._id,residentName:t.residentName,residentType:t.residentType,flatType:t.flatType,flatSizeSqFt:Number(t.flatSizeSqFt),mobile:t.mobile,email:t.email,secondaryResidentName:t.secondaryResidentName||void 0,secondaryResidentMobile:t.secondaryResidentMobile||void 0,secondaryResidentEmail:t.secondaryResidentEmail||void 0})).unwrap(),l("success"),c("Resident added successfully"),h(!0),setTimeout(()=>{h(!1),r()},1200)}catch(s){l("error"),c(s||"Failed to add resident"),h(!0)}finally{y(!1)}},C=t.residentName&&t.residentType&&t.flatType&&t.flatSizeSqFt&&t.mobile&&t.email;return e.jsxs(e.Fragment,{children:[m&&u&&e.jsx(O,{type:u,title:u==="success"?"Success!":"Error!",message:d,variant:"filled",showLink:!1,onClose:()=>h(!1)}),e.jsxs(j,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(j,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(N,{variant:"h6",children:"Add Resident User"}),e.jsx(R,{sx:{color:"white"},onClick:r,children:e.jsx(L,{})})]}),e.jsxs(j,{component:"form",onSubmit:f,px:6,py:4,children:[i&&e.jsxs(N,{className:"mb-4 text-sm text-gray-600",children:["Society: ",e.jsx("strong",{children:i.societyName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{label:"Resident Name",name:"residentName",value:t.residentName,onChange:a}),e.jsx(w,{label:"Resident Type",name:"residentType",value:t.residentType,onChange:a,options:["Owner","Tenant"]}),e.jsx(w,{label:"Flat Type",name:"flatType",value:t.flatType,onChange:a,options:["1RK","1BHK","2BHK","3BHK","4BHK","5BHK","6BHK"]}),e.jsx(x,{label:"Flat Size (Sq Ft)",name:"flatSizeSqFt",type:"number",value:t.flatSizeSqFt,onChange:a}),e.jsx(x,{label:"Mobile Number",name:"mobile",value:t.mobile,onChange:a}),e.jsx(x,{label:"Email ID",name:"email",value:t.email,onChange:a}),e.jsx(x,{label:"Secondary Resident Name",name:"secondaryResidentName",value:t.secondaryResidentName,onChange:a}),e.jsx(x,{label:"Secondary Resident Mobile",name:"secondaryResidentMobile",value:t.secondaryResidentMobile,onChange:a}),e.jsx(x,{label:"Secondary Resident Email",name:"secondaryResidentEmail",value:t.secondaryResidentEmail,onChange:a})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[e.jsx(v,{type:"submit",disabled:!C||o,children:o?"Saving...":"Add Resident"}),e.jsx(v,{variant:"secondary",onClick:r,children:"Cancel"})]})]})]})]})},ce=()=>{const r=F(),{residents:i,totalItems:p}=E(s=>s.resident),[t,g]=n.useState(0),[o,y]=n.useState(10),[u,l]=n.useState(!1),[d,c]=n.useState(null),[m,h]=n.useState(null),[a,f]=n.useState(null);n.useEffect(()=>{m!=null&&m._id&&r(K({societyId:m._id,page:t,limit:o}))},[r,t,o,m]);const C=[{accessorKey:"residentName",header:"Resident Name"},{accessorKey:"residentType",header:"Type"},{accessorKey:"flatType",header:"Flat Type"},{accessorKey:"flatSizeSqFt",header:"Sq Ft"},{accessorKey:"mobile",header:"Mobile"},{accessorKey:"email",header:"Email"},{accessorKey:"isActive",header:"Status",Cell:({cell:s})=>s.getValue()?e.jsx(I,{label:"Active",color:"success",size:"small"}):e.jsx(I,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:s})=>e.jsxs(j,{display:"flex",gap:1,children:[e.jsx(S,{title:"View",children:e.jsx(R,{onClick:()=>{c(s.original),l(!0)},children:e.jsx(U,{})})}),e.jsx(S,{title:"Edit",children:e.jsx(R,{onClick:()=>{c(s.original),l(!0)},children:e.jsx(q,{})})}),e.jsx(S,{title:"Delete",children:e.jsx(R,{color:"error",onClick:()=>f(s.original._id),children:e.jsx(H,{})})}),e.jsx(P,{checked:s.original.isActive,onChange:()=>r(D(s.original._id))})]})}],b=async()=>{a&&(await r(z(a)),f(null))};return e.jsxs(e.Fragment,{children:[e.jsx(V,{show:!!a,type:"error",title:"Delete Resident",message:"Are you sure you want to delete this resident?",onConfirm:b,onCancel:()=>f(null)}),u?e.jsx(W,{society:m,onCancel:()=>{l(!1),c(null)}}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(N,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Resident Management"," ",e.jsx(S,{title:"Create society resident, edit and manage society resident.",arrow:!0,children:e.jsx(_,{sx:{color:"#245492",cursor:"pointer",ml:1}})})]}),e.jsxs(v,{onClick:()=>{c(null),l(!0)},children:[e.jsx(M,{})," Add Resident"]})]}),e.jsx(B,{data:i,columns:C,rowCount:p,pageIndex:t,pageSize:o,onPaginationChange:({pageIndex:s,pageSize:T})=>{g(s),y(T)}})]})]})};export{W as A,ce as R};
