import{r as t,j as e,B as f,c as re,aD as le,aE as ne,aF as ce}from"./index-CcNgdVLz.js";import{D as de,E as me}from"./DataTable-DIxG5frN.js";import{D as ue}from"./Delete-BWjouR_h.js";import{G as H}from"./Group-yFIc-5y_.js";import{I as ge}from"./Info-BLwzYq-V.js";import{A as he}from"./Add-CQx2oSmS.js";import{V as fe}from"./Visibility-Bad1pPYX.js";import{S as U}from"./SweetAlert-BfCzCAJa.js";import{B as _}from"./Button-B4_V5GRV.js";import{T as xe}from"./ToggleSwitch-CZt8XOld.js";import{C as pe}from"./Close-eApB0hKv.js";import{I as T}from"./InputField-BQ5ewBIw.js";import{A as ye}from"./Alert-U3gIVFWt.js";import{A as Se}from"./ArrowBack-Dpb-03kv.js";import{L as je,F as be,T as Ae,Z as Ce,D as ve}from"./thumbnails-qXa_Wtv4.js";import{R as we,A as Ne}from"./ResidentManagement-yRymR2DJ.js";import{S as Fe,A as Te}from"./SocietyAdminManagement-B93f7DR6.js";import{T as K}from"./Typography-BMOygWke.js";import{D as De}from"./Divider-BePmc644.js";import{T as Ie,a as Y}from"./Tabs-CWf6flOX.js";import{I as v}from"./AlertTitle-C4QpKbd8.js";import{T as C}from"./Tooltip-C-v54PpA.js";import{C as Z}from"./Chip-YFG14ne-.js";import"./createSvgIcon-ClJPFlmG.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./Dialog-BdfS6Lfy.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./DialogTitle-BbPUlM9A.js";import"./skeleton-DjwwWlQi.js";const We=({data:i,onClose:n})=>{var j;const[m,w]=t.useState(0),[y,s]=t.useState(!1),[c,x]=t.useState(0);if(!i)return null;const u=((j=i.images)==null?void 0:j.length)>0?i.images:[{url:"/images/societyimage/building.jpg"}],S=[["Society Name",i.societyName],["State",i.state],["City",i.city],["Address",i.address||i.detailAddress],["Total Wings",i.totalWings],["Floors per Wing",i.floorsPerWing],["Flats per Floor",i.flatsPerFloor],["Created On",new Date(i.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})],["Active",i.isActive?"Yes":"No"]];return e.jsxs(f,{className:"bg-gray-100 min-h-screen",children:[e.jsxs("button",{onClick:n,className:"flex items-center text-[#255593] hover:underline",children:[e.jsx(Se,{fontSize:"small"}),e.jsx("span",{className:"ml-1 font-medium",children:"Back"})]}),e.jsxs(f,{className:"px-6 py-6 bg-white mt-4 rounded-xl shadow grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-full h-[400px] rounded-lg overflow-hidden mb-4",children:e.jsx("img",{src:u[0].url,alt:"Society",className:"w-full h-full object-contain cursor-pointer",onClick:()=>{x(0),s(!0)}})}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:u.map((r,l)=>e.jsx("img",{src:r.url,alt:`society-${l}`,className:"h-20 w-full object-cover border rounded cursor-pointer",onClick:()=>{x(l),s(!0)}},l))}),e.jsx(je,{open:y,close:()=>s(!1),index:c,slides:u.map(r=>({src:r.url})),plugins:[be,Ae,Ce,ve]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx(K,{variant:"h6",className:"font-bold mb-2",children:"Society Details"}),e.jsx(De,{sx:{borderColor:"#255593",borderBottomWidth:2}}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:S.map(([r,l],p)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:r}),e.jsx("p",{className:"font-medium",children:l||"-"})]},p))})]})]}),e.jsxs(f,{className:"px-6 mt-6",children:[e.jsx(f,{className:"bg-white rounded-xl shadow",children:e.jsxs(Ie,{value:m,onChange:(r,l)=>w(l),variant:"fullWidth",children:[e.jsx(Y,{label:"Residents"}),e.jsx(Y,{label:"Society Admins"})]})}),e.jsxs(f,{className:"mt-4",children:[m===0&&e.jsx(we,{}),m===1&&e.jsx(Fe,{})]})]})]})},$={Maharashtra:["Mumbai","Pune","Nagpur","Nashik"],Karnataka:["Bengaluru","Mysuru","Hubli"],Gujarat:["Ahmedabad","Surat","Vadodara"],Delhi:["New Delhi"],Telangana:["Hyderabad"]},M={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},Pe=({onCancel:i,editData:n,isEditMode:m,isViewMode:w=!1})=>{if(w)return e.jsx(We,{data:n,onClose:i});const y=re(),[s,c]=t.useState(M),[x,u]=t.useState(!1),[S,j]=t.useState(null),[r,l]=t.useState(""),[p,b]=t.useState(!1);t.useEffect(()=>{c(n?{...M,...n,address:n.address||n.detailAddress||""}:M)},[n]);const g=o=>{const{name:h,value:k}=o.target;c(I=>({...I,[h]:k}))},D=async o=>{if(o.preventDefault(),!x){u(!0);try{m?(await y(le({_id:n._id,...s})).unwrap(),l("Society updated successfully")):(await y(ne(s)).unwrap(),l("Society created successfully")),j("success"),b(!0),y(ce({})),setTimeout(()=>{b(!1),i()},1500)}catch(h){j("error"),l((h==null?void 0:h.message)||"Something went wrong"),b(!0)}finally{u(!1)}}},N=s.societyName&&s.state&&s.city&&s.address&&s.totalWings&&s.floorsPerWing&&s.flatsPerFloor;return e.jsxs(e.Fragment,{children:[p&&S&&e.jsx(ye,{type:S,title:S==="success"?"Success!":"Error!",message:r,variant:"filled",showLink:!1,onClose:()=>b(!1)}),e.jsxs(f,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(f,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(K,{variant:"h6",children:m?"Update Society":"Create Society"}),e.jsx(v,{sx:{color:"white"},onClick:i,children:e.jsx(pe,{})})]}),e.jsxs(f,{component:"form",onSubmit:D,px:6,py:4,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(T,{label:"Name of Society",name:"societyName",value:s.societyName,onChange:g}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"State"}),e.jsxs("select",{value:s.state,onChange:o=>c({...s,state:o.target.value,city:""}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select State"}),Object.keys($).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"City"}),e.jsxs("select",{value:s.city,disabled:!s.state,onChange:o=>c({...s,city:o.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select City"}),($[s.state]||[]).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsx(T,{label:"Detail Address",name:"address",value:s.address,onChange:g}),e.jsx(T,{label:"Total Number of Wings",name:"totalWings",type:"number",value:s.totalWings,onChange:g}),e.jsx(T,{label:"Floors per Wing",name:"floorsPerWing",type:"number",value:s.floorsPerWing,onChange:g}),e.jsx(T,{label:"Flats per Floor",name:"flatsPerFloor",type:"number",value:s.flatsPerFloor,onChange:g})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[e.jsx(_,{disabled:!N||x,children:x?m?"Updating...":"Creating...":m?"Update Society":"Create Society"}),e.jsx(_,{variant:"secondary",onClick:i,children:"Cancel"})]})]})]})]})},B={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},ke=[{_id:"1",societyName:"Green Valley Society",state:"Maharashtra",city:"Pune",detailAddress:"Baner Road, Pune",totalWings:4,floorsPerWing:10,flatsPerFloor:4,isActive:!0,createdAt:"2025-01-05T10:30:00"},{_id:"2",societyName:"Sunshine Apartments",state:"Karnataka",city:"Bengaluru",detailAddress:"Whitefield",totalWings:3,floorsPerWing:8,flatsPerFloor:6,isActive:!1,createdAt:"2025-01-07T11:20:00"},{_id:"3",societyName:"Royal Residency",state:"Gujarat",city:"Ahmedabad",detailAddress:"SG Highway",totalWings:5,floorsPerWing:12,flatsPerFloor:3,isActive:!0,createdAt:"2025-01-09T09:15:00"}],Re=()=>{const[i,n]=t.useState(ke),[m,w]=t.useState(0),[y,s]=t.useState(10),[c,x]=t.useState(""),[u,S]=t.useState([]);t.useRef(null);const[j,r]=t.useState(!1),[l,p]=t.useState(null),[b,g]=t.useState(B),[D,N]=t.useState(!1),[o,h]=t.useState(null),[k,I]=t.useState(!1),[q,L]=t.useState(!1),[J,E]=t.useState(null),[Q,R]=t.useState(!1),[F,O]=t.useState(null),[X,V]=t.useState(!1),[W,ee]=t.useState(""),[P,te]=t.useState(""),z=t.useMemo(()=>i.filter(a=>{if(c&&!a.societyName.toLowerCase().includes(c.toLowerCase()))return!1;for(const A of u)if(A.value){if(A.id==="isActive"&&A.value==="Active"!==a.isActive)return!1;if(typeof A.value=="string"){const oe=A.id,G=a[oe];if(G===void 0||String(G).toLowerCase().indexOf(A.value.toLowerCase())===-1)return!1}}const d=new Date(a.createdAt).getTime();return!(W&&d<new Date(W).setHours(0,0,0,0)||P&&d>new Date(P).setHours(23,59,59,999))}),[i,c,u,W,P]),se=[{accessorKey:"societyName",header:"Society Name",filterVariant:"text"},{accessorKey:"state",header:"State",filterVariant:"text"},{accessorKey:"city",header:"City",filterVariant:"text"},{accessorKey:"detailAddress",header:"Address"},{accessorKey:"totalWings",header:"Wings"},{accessorKey:"floorsPerWing",header:"Floors / Wing"},{accessorKey:"flatsPerFloor",header:"Flats / Floor"},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:a})=>a.getValue()?e.jsx(Z,{label:"Active",color:"success",size:"small"}):e.jsx(Z,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:a})=>e.jsxs(f,{display:"flex",gap:1,children:[e.jsx(C,{title:"View Society",children:e.jsx(v,{onClick:()=>{g(a.original),N(!0),p(null),r(!0)},children:e.jsx(fe,{})})}),e.jsx(C,{title:"Assign Society Admin",children:e.jsx(v,{sx:{color:"#1976D2"},onClick:()=>{h(a.original),I(!0)},children:e.jsx(H,{})})}),e.jsx(C,{title:"Add Resident",children:e.jsx(v,{sx:{color:"#6A1B9A"},onClick:()=>{h(a.original),L(!0)},children:e.jsx(H,{})})}),e.jsx(C,{title:"Edit Society",children:e.jsx(v,{onClick:()=>{g(a.original),p(a.index),N(!1),r(!0)},children:e.jsx(me,{})})}),e.jsx(C,{title:"Delete Society",children:e.jsx(v,{color:"error",onClick:()=>{E(a.original._id),R(!0)},children:e.jsx(ue,{})})}),e.jsx(xe,{checked:a.original.isActive,onChange:()=>{O(a.original),V(!0)}})]})}],ae=()=>{n(a=>a.filter(d=>d._id!==J)),R(!1),E(null)},ie=()=>{F&&(n(a=>a.map(d=>d._id===F._id?{...d,isActive:!d.isActive}:d)),V(!1),O(null))};return e.jsxs(e.Fragment,{children:[e.jsx(U,{show:Q,type:"error",title:"Delete Society",message:"Are you sure you want to delete this society?",onConfirm:ae,onCancel:()=>R(!1)}),e.jsx(U,{show:X,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${F!=null&&F.isActive?"deactivate":"activate"} this society?`,onConfirm:ie,onCancel:()=>V(!1)}),q?e.jsx(Ne,{society:o,onCancel:()=>{L(!1),h(null)}}):j?e.jsx(Pe,{onCancel:()=>{r(!1),p(null),N(!1),g(B)},editData:b,isEditMode:!D&&l!==null,isViewMode:D}):k?e.jsx(Te,{society:o,onCancel:()=>{I(!1),h(null)}}):e.jsxs(e.Fragment,{children:[e.jsxs(f,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(K,{variant:"h5",fontWeight:500,children:["Society Onboarding & Management",e.jsx(C,{title:"Create society, assign admin, manage details",children:e.jsx(ge,{sx:{ml:1,color:"#245492"}})})]}),e.jsxs(_,{onClick:()=>{g(B),p(null),r(!0)},children:[e.jsx(he,{})," Add Society"]})]}),e.jsx(de,{data:z,columns:se,rowCount:z.length,pageIndex:m,pageSize:y,enableColumnFilters:!0,columnFilters:u,onColumnFiltersChange:S,exportType:!0,clickHandler:a=>x(a),fromDate:W,toDate:P,onFromDateChange:ee,onToDateChange:te,onPaginationChange:({pageIndex:a,pageSize:d})=>{w(a),s(d)}})]})]})},pt=()=>e.jsx(e.Fragment,{children:e.jsx(Re,{})});export{pt as default};
