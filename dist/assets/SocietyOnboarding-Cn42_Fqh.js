import{r as t,j as e,c as oe,B as T,aD as re,aE as le,aF as ne}from"./index-N8t8oMzR.js";import{D as ce,E as de}from"./DataTable-BqUD-dAi.js";import{D as me}from"./Delete-07TAjR17.js";import{G as H}from"./Group-BAniG9kX.js";import{I as ue}from"./Info-lyeC1xGk.js";import{A as ge}from"./Add-BUtQdix6.js";import{V as he}from"./Visibility-CgGAKN6P.js";import{S as U}from"./SweetAlert-vzLgp13W.js";import{B as L}from"./Button-CBNcrDpD.js";import{T as fe}from"./ToggleSwitch-DR4b514_.js";import{C as xe}from"./Close-CwR_quIe.js";import{I as N}from"./InputField-riaj6edy.js";import{A as pe}from"./Alert-CgNUKTJk.js";import{A as ye,L as Se,F as je,T as Ae,Z as Ce,D as be}from"./thumbnails-crlKBoi1.js";import{T as M}from"./Typography-CKlLxaDL.js";import{D as ve}from"./Divider-TBuFGUUO.js";import{I as b}from"./AlertTitle-D9ejxV9_.js";import{A as we}from"./AssignSocietyAdminDialog-B_bepXlT.js";import{A as Fe}from"./AddResidentUser-CNSnLWqe.js";import{T as C}from"./Tooltip-CwyNn424.js";import{C as Y}from"./Chip-Dnlh_trd.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./Dialog-BGF2t3L7.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./DialogTitle-D6DEKDqS.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const Ne=({data:i,onClose:l})=>{var g;const[h,x]=t.useState(!1),[p,s]=t.useState(0);if(!i)return null;const r=((g=i.images)==null?void 0:g.length)>0?i.images:[{url:"/images/societyimage/building.jpg"}],y=[["Society Name",i.societyName],["State",i.state],["City",i.city],["Address",i.address||i.detailAddress],["Total Wings",i.totalWings],["Floors per Wing",i.floorsPerWing],["Flats per Floor",i.flatsPerFloor],["Created On",new Date(i.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})],["Active",i.isActive?"Yes":"No"]];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-6 pt-6 bg-white flex items-center gap-2",children:e.jsxs("button",{onClick:l,className:"flex items-center text-[#255593] hover:underline",children:[e.jsx(ye,{fontSize:"small"}),e.jsx("span",{className:"ml-1 font-medium",children:"Back"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 px-6 py-10 bg-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-full h-[400px] rounded-lg overflow-hidden mb-4",children:r[0]&&e.jsx("img",{src:r[0].url,alt:"society",className:"w-full h-full object-contain cursor-pointer",onClick:()=>{s(0),x(!0)}})}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((n,d)=>e.jsx("img",{src:n.url,alt:`thumb-${d}`,className:"h-20 w-full object-cover border rounded cursor-pointer",onClick:()=>{s(d),x(!0)}},d))}),e.jsx(Se,{open:h,close:()=>x(!1),index:p,slides:r.map(n=>({src:n.url,title:"Society Image"})),plugins:[je,Ae,Ce,be],zoom:{maxZoomPixelRatio:3}})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow",children:[e.jsx(M,{variant:"h5",className:"font-bold text-gray-700 mb-4",children:"SOCIETY DETAILS"}),e.jsx(ve,{sx:{borderColor:"#255593",borderBottomWidth:"2px"}}),e.jsx("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6 mt-4",children:y.map(([n,d],f)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:n}),e.jsx("p",{className:"text-gray-800 font-medium",children:d||"-"})]},f))})]})]})]})},Z={Maharashtra:["Mumbai","Pune","Nagpur","Nashik"],Karnataka:["Bengaluru","Mysuru","Hubli"],Gujarat:["Ahmedabad","Surat","Vadodara"],Delhi:["New Delhi"],Telangana:["Hyderabad"]},B={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},Te=({onCancel:i,editData:l,isEditMode:h,isViewMode:x=!1})=>{if(x)return e.jsx(Ne,{data:l,onClose:i});const p=oe(),[s,r]=t.useState(B),[y,g]=t.useState(!1),[n,d]=t.useState(null),[f,v]=t.useState(""),[S,j]=t.useState(!1);t.useEffect(()=>{r(l?{...B,...l,address:l.address||l.detailAddress||""}:B)},[l]);const m=o=>{const{name:u,value:k}=o.target;r(D=>({...D,[u]:k}))},I=async o=>{if(o.preventDefault(),!y){g(!0);try{h?(await p(re({_id:l._id,...s})).unwrap(),v("Society updated successfully")):(await p(le(s)).unwrap(),v("Society created successfully")),d("success"),j(!0),p(ne({})),setTimeout(()=>{j(!1),i()},1500)}catch(u){d("error"),v((u==null?void 0:u.message)||"Something went wrong"),j(!0)}finally{g(!1)}}},w=s.societyName&&s.state&&s.city&&s.address&&s.totalWings&&s.floorsPerWing&&s.flatsPerFloor;return e.jsxs(e.Fragment,{children:[S&&n&&e.jsx(pe,{type:n,title:n==="success"?"Success!":"Error!",message:f,variant:"filled",showLink:!1,onClose:()=>j(!1)}),e.jsxs(T,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(T,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(M,{variant:"h6",children:h?"Update Society":"Create Society"}),e.jsx(b,{sx:{color:"white"},onClick:i,children:e.jsx(xe,{})})]}),e.jsxs(T,{component:"form",onSubmit:I,px:6,py:4,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(N,{label:"Name of Society",name:"societyName",value:s.societyName,onChange:m}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"State"}),e.jsxs("select",{value:s.state,onChange:o=>r({...s,state:o.target.value,city:""}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select State"}),Object.keys(Z).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"City"}),e.jsxs("select",{value:s.city,disabled:!s.state,onChange:o=>r({...s,city:o.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select City"}),(Z[s.state]||[]).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsx(N,{label:"Detail Address",name:"address",value:s.address,onChange:m}),e.jsx(N,{label:"Total Number of Wings",name:"totalWings",type:"number",value:s.totalWings,onChange:m}),e.jsx(N,{label:"Floors per Wing",name:"floorsPerWing",type:"number",value:s.floorsPerWing,onChange:m}),e.jsx(N,{label:"Flats per Floor",name:"flatsPerFloor",type:"number",value:s.flatsPerFloor,onChange:m})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[e.jsx(L,{disabled:!w||y,children:y?h?"Updating...":"Creating...":h?"Update Society":"Create Society"}),e.jsx(L,{variant:"secondary",onClick:i,children:"Cancel"})]})]})]})]})},E={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},Ie=[{_id:"1",societyName:"Green Valley Society",state:"Maharashtra",city:"Pune",detailAddress:"Baner Road, Pune",totalWings:4,floorsPerWing:10,flatsPerFloor:4,isActive:!0,createdAt:"2025-01-05T10:30:00"},{_id:"2",societyName:"Sunshine Apartments",state:"Karnataka",city:"Bengaluru",detailAddress:"Whitefield",totalWings:3,floorsPerWing:8,flatsPerFloor:6,isActive:!1,createdAt:"2025-01-07T11:20:00"},{_id:"3",societyName:"Royal Residency",state:"Gujarat",city:"Ahmedabad",detailAddress:"SG Highway",totalWings:5,floorsPerWing:12,flatsPerFloor:3,isActive:!0,createdAt:"2025-01-09T09:15:00"}],De=()=>{const[i,l]=t.useState(Ie),[h,x]=t.useState(0),[p,s]=t.useState(10),[r,y]=t.useState(""),[g,n]=t.useState([]);t.useRef(null);const[d,f]=t.useState(!1),[v,S]=t.useState(null),[j,m]=t.useState(E),[I,w]=t.useState(!1),[o,u]=t.useState(null),[k,D]=t.useState(!1),[$,K]=t.useState(!1),[q,O]=t.useState(null),[J,V]=t.useState(!1),[F,_]=t.useState(null),[Q,R]=t.useState(!1),[W,X]=t.useState(""),[P,ee]=t.useState(""),z=t.useMemo(()=>i.filter(a=>{if(r&&!a.societyName.toLowerCase().includes(r.toLowerCase()))return!1;for(const A of g)if(A.value){if(A.id==="isActive"&&A.value==="Active"!==a.isActive)return!1;if(typeof A.value=="string"){const ie=A.id,G=a[ie];if(G===void 0||String(G).toLowerCase().indexOf(A.value.toLowerCase())===-1)return!1}}const c=new Date(a.createdAt).getTime();return!(W&&c<new Date(W).setHours(0,0,0,0)||P&&c>new Date(P).setHours(23,59,59,999))}),[i,r,g,W,P]),te=[{accessorKey:"societyName",header:"Society Name",filterVariant:"text"},{accessorKey:"state",header:"State",filterVariant:"text"},{accessorKey:"city",header:"City",filterVariant:"text"},{accessorKey:"detailAddress",header:"Address"},{accessorKey:"totalWings",header:"Wings"},{accessorKey:"floorsPerWing",header:"Floors / Wing"},{accessorKey:"flatsPerFloor",header:"Flats / Floor"},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:a})=>a.getValue()?e.jsx(Y,{label:"Active",color:"success",size:"small"}):e.jsx(Y,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:a})=>e.jsxs(T,{display:"flex",gap:1,children:[e.jsx(C,{title:"View Society",children:e.jsx(b,{onClick:()=>{m(a.original),w(!0),S(null),f(!0)},children:e.jsx(he,{})})}),e.jsx(C,{title:"Assign Society Admin",children:e.jsx(b,{sx:{color:"#1976D2"},onClick:()=>{u(a.original),D(!0)},children:e.jsx(H,{})})}),e.jsx(C,{title:"Add Resident",children:e.jsx(b,{sx:{color:"#6A1B9A"},onClick:()=>{u(a.original),K(!0)},children:e.jsx(H,{})})}),e.jsx(C,{title:"Edit Society",children:e.jsx(b,{onClick:()=>{m(a.original),S(a.index),w(!1),f(!0)},children:e.jsx(de,{})})}),e.jsx(C,{title:"Delete Society",children:e.jsx(b,{color:"error",onClick:()=>{O(a.original._id),V(!0)},children:e.jsx(me,{})})}),e.jsx(fe,{checked:a.original.isActive,onChange:()=>{_(a.original),R(!0)}})]})}],se=()=>{l(a=>a.filter(c=>c._id!==q)),V(!1),O(null)},ae=()=>{F&&(l(a=>a.map(c=>c._id===F._id?{...c,isActive:!c.isActive}:c)),R(!1),_(null))};return e.jsxs(e.Fragment,{children:[e.jsx(U,{show:J,type:"error",title:"Delete Society",message:"Are you sure you want to delete this society?",onConfirm:se,onCancel:()=>V(!1)}),e.jsx(U,{show:Q,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${F!=null&&F.isActive?"deactivate":"activate"} this society?`,onConfirm:ae,onCancel:()=>R(!1)}),$?e.jsx(Fe,{society:o,onCancel:()=>{K(!1),u(null)}}):d?e.jsx(Te,{onCancel:()=>{f(!1),S(null),w(!1),m(E)},editData:j,isEditMode:!I&&v!==null,isViewMode:I}):k?e.jsx(we,{society:o,onCancel:()=>{D(!1),u(null)}}):e.jsxs(e.Fragment,{children:[e.jsxs(T,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(M,{variant:"h5",fontWeight:500,children:["Society Onboarding & Management",e.jsx(C,{title:"Create society, assign admin, manage details",children:e.jsx(ue,{sx:{ml:1,color:"#245492"}})})]}),e.jsxs(L,{onClick:()=>{m(E),S(null),f(!0)},children:[e.jsx(ge,{})," Add Society"]})]}),e.jsx(ce,{data:z,columns:te,rowCount:z.length,pageIndex:h,pageSize:p,enableColumnFilters:!0,columnFilters:g,onColumnFiltersChange:n,exportType:!0,clickHandler:a=>y(a),fromDate:W,toDate:P,onFromDateChange:X,onToDateChange:ee,onPaginationChange:({pageIndex:a,pageSize:c})=>{x(a),s(c)}})]})]})},ut=()=>e.jsx(e.Fragment,{children:e.jsx(De,{})});export{ut as default};
