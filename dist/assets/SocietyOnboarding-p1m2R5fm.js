import{c as re,r as t,j as e,B as w,aD as ie,aE as le,aF as ne}from"./index-CNh2Ysd7.js";import{D as ce,E as de}from"./DataTable-CBDiE-I1.js";import{D as ue}from"./Delete-BKL8mfiA.js";import{G as U}from"./Group-LebaL8cz.js";import{I as me}from"./Info-BLOe8JuO.js";import{A as fe}from"./Add-ONoAddvh.js";import{V as ge}from"./Visibility-CFK2wX7e.js";import{S as Y}from"./SweetAlert-DUVT9XWx.js";import{B as E}from"./Button-D2SEshHa.js";import{T as he}from"./ToggleSwitch-CRLgVpk1.js";import{C as ye}from"./Close-CSWdanUp.js";import{I as T}from"./InputField-Cac7SuVh.js";import{A as xe}from"./Alert-BBsTbpkb.js";import{T as J}from"./Typography-DxP0RQcB.js";import{I as S}from"./AlertTitle-BBXxFqxI.js";import{A as pe}from"./AssignSocietyAdminDialog-BWHtSgSO.js";import{A as Se}from"./AddResidentUser-BZdE-I2g.js";import{T as p}from"./Tooltip-B4POfKz-.js";import{C as $}from"./Chip--RBU-Z22.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./Dialog-CMeqEyOr.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./DialogTitle-sP3uGIgc.js";import"./Divider-1omdH51K.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const q={Maharashtra:["Mumbai","Pune","Nagpur","Nashik"],Karnataka:["Bengaluru","Mysuru","Hubli"],Gujarat:["Ahmedabad","Surat","Vadodara"],Delhi:["New Delhi"],Telangana:["Hyderabad"]},K={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},je=({onCancel:u,editData:c,isEditMode:m,isViewMode:r=!1})=>{const j=re(),[a,d]=t.useState(K),[b,f]=t.useState(!1),[A,N]=t.useState(null),[g,C]=t.useState(""),[h,y]=t.useState(!1);t.useEffect(()=>{d(c?{...K,...c,address:c.address||c.detailAddress||""}:K)},[c]);const l=o=>{const{name:n,value:k}=o.target;d(I=>({...I,[n]:k}))},D=async o=>{if(o.preventDefault(),!b){f(!0);try{m?(await j(ie({_id:c._id,...a})).unwrap(),C("Society updated successfully")):(await j(le(a)).unwrap(),C("Society created successfully")),N("success"),y(!0),j(ne({})),setTimeout(()=>{y(!1),u()},1500)}catch(n){N("error"),C((n==null?void 0:n.message)||"Something went wrong"),y(!0)}finally{f(!1)}}},v=a.societyName&&a.state&&a.city&&a.address&&a.totalWings&&a.floorsPerWing&&a.flatsPerFloor;return e.jsxs(e.Fragment,{children:[h&&A&&e.jsx(xe,{type:A,title:A==="success"?"Success!":"Error!",message:g,variant:"filled",showLink:!1,onClose:()=>y(!1)}),e.jsxs(w,{className:"max-w-4xl mx-auto rounded-xl shadow-md bg-white",children:[e.jsxs(w,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:12,borderTopRightRadius:12,color:"white"},children:[e.jsx(J,{variant:"h6",children:r?"Society Details":m?"Update Society":"Create Society"}),e.jsx(S,{sx:{color:"white"},onClick:u,children:e.jsx(ye,{})})]}),e.jsxs(w,{component:"form",onSubmit:D,px:6,py:4,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(T,{label:"Name of Society",name:"societyName",value:a.societyName,onChange:l,disabled:r,className:r?"text-gray-900 font-bold text-base":""}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block ",children:"State"}),e.jsxs("select",{value:a.state,disabled:r,onChange:o=>d({...a,state:o.target.value,city:""}),className:"w-full p-2 border rounded ",children:[e.jsx("option",{value:"",children:"Select State"}),Object.keys(q).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"City"}),e.jsxs("select",{value:a.city,disabled:!a.state||r,onChange:o=>d({...a,city:o.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select City"}),(q[a.state]||[]).map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsx(T,{label:"Detail Address",name:"address",value:a.address,onChange:l,disabled:r,className:r?"text-gray-900 font-bold text-base":""}),e.jsx(T,{label:"Total Number of Wings",name:"totalWings",type:"number",value:a.totalWings,onChange:l,disabled:r,className:r?"text-gray-900 font-bold text-base":""}),e.jsx(T,{label:"Floors per Wing",name:"floorsPerWing",type:"number",value:a.floorsPerWing,onChange:l,disabled:r,className:r?"text-gray-900 font-bold text-base":""}),e.jsx(T,{label:"Flats per Floor",name:"flatsPerFloor",type:"number",value:a.flatsPerFloor,onChange:l,disabled:r,className:r?"text-gray-900 font-bold text-base":""})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6",children:[!r&&e.jsx(E,{disabled:!v||b,children:b?m?"Updating...":"Creating...":m?"Update Society":"Create Society"}),e.jsx(E,{variant:"secondary",onClick:u,children:r?"Back":"Cancel"})]})]})]})]})},_={societyName:"",state:"",city:"",address:"",totalWings:"",floorsPerWing:"",flatsPerFloor:""},be=[{_id:"1",societyName:"Green Valley Society",state:"Maharashtra",city:"Pune",detailAddress:"Baner Road, Pune",totalWings:4,floorsPerWing:10,flatsPerFloor:4,isActive:!0,createdAt:"2025-01-05T10:30:00"},{_id:"2",societyName:"Sunshine Apartments",state:"Karnataka",city:"Bengaluru",detailAddress:"Whitefield",totalWings:3,floorsPerWing:8,flatsPerFloor:6,isActive:!1,createdAt:"2025-01-07T11:20:00"},{_id:"3",societyName:"Royal Residency",state:"Gujarat",city:"Ahmedabad",detailAddress:"SG Highway",totalWings:5,floorsPerWing:12,flatsPerFloor:3,isActive:!0,createdAt:"2025-01-09T09:15:00"}],Ae=()=>{const[u,c]=t.useState(be),[m,r]=t.useState(0),[j,a]=t.useState(10),[d,b]=t.useState(""),[f,A]=t.useState([]);t.useRef(null);const[N,g]=t.useState(!1),[C,h]=t.useState(null),[y,l]=t.useState(_),[D,v]=t.useState(!1),[o,n]=t.useState(null),[k,I]=t.useState(!1),[Q,G]=t.useState(!1),[V,H]=t.useState(null),[X,R]=t.useState(!1),[F,L]=t.useState(null),[Z,B]=t.useState(!1),[P,M]=t.useState(""),[W,ee]=t.useState(""),O=t.useMemo(()=>u.filter(s=>{if(d&&!s.societyName.toLowerCase().includes(d.toLowerCase()))return!1;for(const x of f)if(x.value){if(x.id==="isActive"&&x.value==="Active"!==s.isActive)return!1;if(typeof x.value=="string"){const oe=x.id,z=s[oe];if(z===void 0||String(z).toLowerCase().indexOf(x.value.toLowerCase())===-1)return!1}}const i=new Date(s.createdAt).getTime();return!(P&&i<new Date(P).setHours(0,0,0,0)||W&&i>new Date(W).setHours(23,59,59,999))}),[u,d,f,P,W]),te=[{accessorKey:"societyName",header:"Society Name",filterVariant:"text"},{accessorKey:"state",header:"State",filterVariant:"text"},{accessorKey:"city",header:"City",filterVariant:"text"},{accessorKey:"detailAddress",header:"Address"},{accessorKey:"totalWings",header:"Wings"},{accessorKey:"floorsPerWing",header:"Floors / Wing"},{accessorKey:"flatsPerFloor",header:"Flats / Floor"},{accessorKey:"isActive",header:"Status",filterVariant:"select",filterSelectOptions:["Active","Inactive"],Cell:({cell:s})=>s.getValue()?e.jsx($,{label:"Active",color:"success",size:"small"}):e.jsx($,{label:"Inactive",color:"error",size:"small"})},{header:"Actions",Cell:({row:s})=>e.jsxs(w,{display:"flex",gap:1,children:[e.jsx(p,{title:"View Society",children:e.jsx(S,{onClick:()=>{l(s.original),v(!0),h(null),g(!0)},children:e.jsx(ge,{})})}),e.jsx(p,{title:"Assign Society Admin",children:e.jsx(S,{sx:{color:"#1976D2"},onClick:()=>{n(s.original),I(!0)},children:e.jsx(U,{})})}),e.jsx(p,{title:"Add Resident",children:e.jsx(S,{sx:{color:"#6A1B9A"},onClick:()=>{n(s.original),G(!0)},children:e.jsx(U,{})})}),e.jsx(p,{title:"Edit Society",children:e.jsx(S,{onClick:()=>{l(s.original),h(s.index),v(!1),g(!0)},children:e.jsx(de,{})})}),e.jsx(p,{title:"Delete Society",children:e.jsx(S,{color:"error",onClick:()=>{H(s.original._id),R(!0)},children:e.jsx(ue,{})})}),e.jsx(he,{checked:s.original.isActive,onChange:()=>{L(s.original),B(!0)}})]})}],se=()=>{c(s=>s.filter(i=>i._id!==V)),R(!1),H(null)},ae=()=>{F&&(c(s=>s.map(i=>i._id===F._id?{...i,isActive:!i.isActive}:i)),B(!1),L(null))};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{show:X,type:"error",title:"Delete Society",message:"Are you sure you want to delete this society?",onConfirm:se,onCancel:()=>R(!1)}),e.jsx(Y,{show:Z,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${F!=null&&F.isActive?"deactivate":"activate"} this society?`,onConfirm:ae,onCancel:()=>B(!1)}),Q?e.jsx(Se,{society:o,onCancel:()=>{G(!1),n(null)}}):N?e.jsx(je,{onCancel:()=>{g(!1),h(null),v(!1),l(_)},editData:y,isEditMode:!D&&C!==null,isViewMode:D}):k?e.jsx(pe,{society:o,onCancel:()=>{I(!1),n(null)}}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{display:"flex",justifyContent:"space-between",mb:2,children:[e.jsxs(J,{variant:"h5",fontWeight:500,children:["Society Onboarding & Management",e.jsx(p,{title:"Create society, assign admin, manage details",children:e.jsx(me,{sx:{ml:1,color:"#245492"}})})]}),e.jsxs(E,{onClick:()=>{l(_),h(null),g(!0)},children:[e.jsx(fe,{})," Add Society"]})]}),e.jsx(ce,{data:O,columns:te,rowCount:O.length,pageIndex:m,pageSize:j,enableColumnFilters:!0,columnFilters:f,onColumnFiltersChange:A,exportType:!0,clickHandler:s=>b(s),fromDate:P,toDate:W,onFromDateChange:M,onToDateChange:ee,onPaginationChange:({pageIndex:s,pageSize:i})=>{r(s),a(i)}})]})]})},at=()=>e.jsx(e.Fragment,{children:e.jsx(Ae,{})});export{at as default};
