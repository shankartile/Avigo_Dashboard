import{r,E as L,a as M,j as a,B as O}from"./index-CNh2Ysd7.js";import{I as R}from"./Info-BLOe8JuO.js";import{V as N}from"./Visibility-CFK2wX7e.js";import{D as U}from"./DataTable-CBDiE-I1.js";import{A as K}from"./Alert-BBsTbpkb.js";import{C as E}from"./Chip--RBU-Z22.js";import{T as f}from"./Tooltip-B4POfKz-.js";import{I as z}from"./AlertTitle-BBXxFqxI.js";import{T as B}from"./Typography-DxP0RQcB.js";import"./createSvgIcon-BgVIxfXN.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./Close-CSWdanUp.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./Dialog-CMeqEyOr.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./DialogTitle-sP3uGIgc.js";import"./Divider-1omdH51K.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const _=[{_id:"st-101",userType:"admin",userId:{name:"Admin User",email:"admin@company.com"},subject:"Dashboard not loading",description:"Admin dashboard page stuck on loading screen.",status:"Open",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{_id:"st-102",userType:"webuser",userId:{name:"Rohit Patil",phone:"9876543210"},subject:"Unable to submit enquiry",description:"Website enquiry form is not submitting.",status:"In Progress",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-36e5).toISOString()},{_id:"st-103",userType:"admin",userId:{name:"System Admin",email:"sysadmin@company.com"},subject:"Permission issue",description:"Staff cannot access reports module.",status:"Resolved",createdAt:new Date(Date.now()-1728e5).toISOString(),updatedAt:new Date(Date.now()-72e5).toISOString()}],H=()=>{const[d,$]=r.useState(_),[o,S]=r.useState("admin"),[i,h]=r.useState(""),[u,y]=r.useState([]),[w,p]=r.useState(0),[T,x]=r.useState(10),[c,C]=r.useState(""),[l,D]=r.useState(""),[q,W]=r.useState(!1),[I,b]=r.useState(!1),[m,G]=r.useState(null),[j,J]=r.useState(""),[A,F]=L(),k=M(),g=r.useMemo(()=>d.filter(t=>{if(t.userType!==o||i&&!(t.subject.toLowerCase().includes(i.toLowerCase())||t.description.toLowerCase().includes(i.toLowerCase())))return!1;for(const s of u){if(!s.value)continue;const n=s.id;if(t[n]&&!String(t[n]).toLowerCase().includes(String(s.value).toLowerCase()))return!1}const e=new Date(t.createdAt).getTime();return!(c&&e<new Date(c).setHours(0,0,0,0)||l&&e>new Date(l).setHours(23,59,59,999))}),[d,o,i,u,c,l]),v=t=>{h(t),p(0)},P=t=>{const s=sessionStorage.getItem("activeRole")==="staff"?"staff":"superadmin";k(`/${s}/society-supportticketmanagement/${t._id}?userType=${t.userType}`)},V=r.useMemo(()=>{const t=[{accessorKey:"userType",header:"Submitted By",filterVariant:"text"},{accessorFn:e=>{var s;return(s=e.userId)==null?void 0:s.name},id:"userName",header:"User Name",filterVariant:"text"}];return o==="admin"?t.push({accessorFn:e=>{var s;return(s=e.userId)==null?void 0:s.email},id:"email",header:"Email",filterVariant:"text"}):t.push({accessorFn:e=>{var s;return(s=e.userId)==null?void 0:s.phone},id:"phone",header:"Mobile No",filterVariant:"text"}),t.push({accessorKey:"subject",header:"Subject",Cell:({row:e})=>e.original.subject.slice(0,30)+"..."},{accessorKey:"description",header:"Description",Cell:({row:e})=>e.original.description.slice(0,30)+"..."},{accessorKey:"createdAt",header:"Ticket Date",Cell:({cell:e})=>new Date(e.getValue()).toLocaleString("en-IN")},{accessorKey:"updatedAt",header:"Last Updated",Cell:({cell:e})=>new Date(e.getValue()).toLocaleString("en-IN")},{accessorKey:"status",header:"Status",Cell:({row:e})=>{const s=e.original.status.toLowerCase();let n="error";return s==="resolved"?n="success":s==="in progress"&&(n="warning"),a.jsx(E,{label:e.original.status,color:n,size:"small",variant:"outlined"})},filterVariant:"select",filterSelectOptions:["Resolved","In Progress","Open"]},{header:"Actions",Cell:({row:e})=>a.jsx(f,{title:"View Details",children:a.jsx(z,{color:"primary",onClick:s=>{s.stopPropagation(),P(e.original)},children:a.jsx(N,{})})})}),t},[o]);return a.jsxs(a.Fragment,{children:[I&&m&&a.jsx(K,{type:m,title:m==="success"?"Success!":"Error!",message:j,variant:"filled",onClose:()=>b(!1)}),a.jsx(O,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:a.jsxs(B,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Support Ticket Management"," ",a.jsx(f,{title:"Manage support tickets",children:a.jsx(R,{sx:{color:"#245492",cursor:"pointer"}})})]})}),a.jsx(U,{columns:V,data:g,exportType:!0,clickHandler:v,enableColumnFilters:!0,columnFilters:u,onColumnFiltersChange:y,rowCount:g.length,enableUserTypeFilter:!0,productTypeValue:o,onUserTypeChange:t=>{S(t),p(0);const e=new URLSearchParams(A);e.set("type",t),F(e)},pageIndex:w,pageSize:T,onPaginationChange:({pageIndex:t,pageSize:e})=>{p(t),x(e)},fromDate:c,toDate:l,onFromDateChange:C,onToDateChange:D},o)]})},xe=()=>a.jsx(a.Fragment,{children:a.jsx(H,{})});export{xe as default};
