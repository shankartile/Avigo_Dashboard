import{r as a,E,a as K,j as e,B as o}from"./index-N8t8oMzR.js";import{I as W}from"./Info-lyeC1xGk.js";import{V as H}from"./Visibility-CgGAKN6P.js";import{D as B}from"./DataTable-BqUD-dAi.js";import{A as _}from"./Alert-CgNUKTJk.js";import{C as f,a as $}from"./ConfirmationNumber-BcmY2nts.js";import{H as q,C as G}from"./HourglassEmpty-CvxhGF6-.js";import{C as J}from"./Chip-Dnlh_trd.js";import{T as y}from"./Tooltip-CwyNn424.js";import{I as Q}from"./AlertTitle-D9ejxV9_.js";import{T as n}from"./Typography-CKlLxaDL.js";import{C as x}from"./Card-l5DVGevb.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./Close-CwR_quIe.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./Dialog-BGF2t3L7.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./DialogTitle-D6DEKDqS.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const X=[{_id:"st-101",userType:"admin",userId:{name:"Admin User",email:"admin@company.com"},subject:"Dashboard not loading",description:"Admin dashboard page stuck on loading screen.",status:"Open",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{_id:"st-102",userType:"webuser",userId:{name:"Rohit Patil",phone:"9876543210"},subject:"Unable to submit enquiry",description:"Website enquiry form is not submitting.",status:"In Progress",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-36e5).toISOString()},{_id:"st-103",userType:"admin",userId:{name:"System Admin",email:"sysadmin@company.com"},subject:"Permission issue",description:"Staff cannot access reports module.",status:"Resolved",createdAt:new Date(Date.now()-1728e5).toISOString(),updatedAt:new Date(Date.now()-72e5).toISOString()}],Y=()=>{const[S,Z]=a.useState(X),[i,j]=a.useState("admin"),[d,C]=a.useState(""),[m,b]=a.useState([]),[T,h]=a.useState(0),[I,w]=a.useState(10),[u,D]=a.useState(""),[p,k]=a.useState(""),[ee,te]=a.useState(!1),[v,A]=a.useState(!1),[g,se]=a.useState(null),[F,re]=a.useState(""),[P,R]=E(),V=K(),l=a.useMemo(()=>S.filter(s=>{if(s.userType!==i||d&&!(s.subject.toLowerCase().includes(d.toLowerCase())||s.description.toLowerCase().includes(d.toLowerCase())))return!1;for(const r of m){if(!r.value)continue;const c=r.id;if(s[c]&&!String(s[c]).toLowerCase().includes(String(r.value).toLowerCase()))return!1}const t=new Date(s.createdAt).getTime();return!(u&&t<new Date(u).setHours(0,0,0,0)||p&&t>new Date(p).setHours(23,59,59,999))}),[S,i,d,m,u,p]),L=s=>{C(s),h(0)},M=s=>{const r=sessionStorage.getItem("activeRole")==="staff"?"staff":"superadmin";V(`/${r}/society-supportticketmanagement/${s._id}?userType=${s.userType}`)},O=l.length,N=l.filter(s=>s.status==="Open"||s.status==="In Progress").length,z=l.filter(s=>s.status==="Resolved").length,U=a.useMemo(()=>{const s=[{accessorKey:"userType",header:"Submitted By",filterVariant:"text"},{accessorFn:t=>{var r;return(r=t.userId)==null?void 0:r.name},id:"userName",header:"User Name",filterVariant:"text"}];return i==="admin"?s.push({accessorFn:t=>{var r;return(r=t.userId)==null?void 0:r.email},id:"email",header:"Email",filterVariant:"text"}):s.push({accessorFn:t=>{var r;return(r=t.userId)==null?void 0:r.phone},id:"phone",header:"Mobile No",filterVariant:"text"}),s.push({accessorKey:"subject",header:"Subject",Cell:({row:t})=>t.original.subject.slice(0,30)+"..."},{accessorKey:"description",header:"Description",Cell:({row:t})=>t.original.description.slice(0,30)+"..."},{accessorKey:"createdAt",header:"Ticket Date",Cell:({cell:t})=>new Date(t.getValue()).toLocaleString("en-IN")},{accessorKey:"updatedAt",header:"Last Updated",Cell:({cell:t})=>new Date(t.getValue()).toLocaleString("en-IN")},{accessorKey:"status",header:"Status",Cell:({row:t})=>{const r=t.original.status.toLowerCase();let c="error";return r==="resolved"?c="success":r==="in progress"&&(c="warning"),e.jsx(J,{label:t.original.status,color:c,size:"small",variant:"outlined"})},filterVariant:"select",filterSelectOptions:["Resolved","In Progress","Open"]},{header:"Actions",Cell:({row:t})=>e.jsx(y,{title:"View Details",children:e.jsx(Q,{color:"primary",onClick:r=>{r.stopPropagation(),M(t.original)},children:e.jsx(H,{})})})}),s},[i]);return e.jsxs(e.Fragment,{children:[v&&g&&e.jsx(_,{type:g,title:g==="success"?"Success!":"Error!",message:F,variant:"filled",onClose:()=>A(!1)}),e.jsx(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(n,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Support Ticket Management"," ",e.jsx(y,{title:"Manage support tickets",children:e.jsx(W,{sx:{color:"#245492",cursor:"pointer"}})})]})}),e.jsx(o,{mb:2,mx:"auto",maxWidth:"1500px",children:e.jsxs(o,{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"1fr 1fr 1fr"},gap:2,children:[e.jsx(x,{sx:{borderRadius:3},children:e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{backgroundColor:"rgba(25, 118, 210, 0.1)",color:"#1976d2",height:56,width:56,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"12px",flexShrink:0},children:e.jsx($,{sx:{fontSize:28}})}),e.jsxs(o,{children:[e.jsx(n,{variant:"h6",fontWeight:600,children:O}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Total Tickets"})]})]})}),e.jsx(x,{sx:{borderRadius:3},children:e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{backgroundColor:"rgba(237, 108, 2, 0.1)",color:"#ed6c02",height:56,width:56,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"12px",flexShrink:0},children:e.jsx(q,{sx:{fontSize:28}})}),e.jsxs(o,{children:[e.jsx(n,{variant:"h6",fontWeight:600,children:N}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Pending Tickets"})]})]})}),e.jsx(x,{sx:{borderRadius:3},children:e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{backgroundColor:"rgba(46, 125, 50, 0.1)",color:"#2e7d32",height:56,width:56,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"12px",flexShrink:0},children:e.jsx(G,{sx:{fontSize:28}})}),e.jsxs(o,{children:[e.jsx(n,{variant:"h6",fontWeight:600,children:z}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Solved Tickets"})]})]})})]})}),e.jsx(B,{columns:U,data:l,exportType:!0,clickHandler:L,enableColumnFilters:!0,columnFilters:m,onColumnFiltersChange:b,rowCount:l.length,enableUserTypeFilter:!0,productTypeValue:i,onUserTypeChange:s=>{j(s),h(0);const t=new URLSearchParams(P);t.set("type",s),R(t)},pageIndex:T,pageSize:I,onPaginationChange:({pageIndex:s,pageSize:t})=>{h(s),w(t)},fromDate:u,toDate:p,onFromDateChange:D,onToDateChange:k},i)]})},Re=()=>e.jsx(e.Fragment,{children:e.jsx(Y,{})});export{Re as default};
