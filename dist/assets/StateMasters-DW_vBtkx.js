import{r as a,c as ce,d as V,b_ as f,b$ as de,j as e,B as p,c0 as ue,c1 as me,c2 as pe,c3 as he}from"./index-N8t8oMzR.js";import{A as xe}from"./Add-BUtQdix6.js";import{V as fe}from"./Visibility-CgGAKN6P.js";import{C as z}from"./Close-CwR_quIe.js";import{I as ge}from"./InputField-riaj6edy.js";import{B as b}from"./Button-CBNcrDpD.js";import{D as Se}from"./DataTable-BqUD-dAi.js";import{T as je}from"./ToggleSwitch-DR4b514_.js";import{A as H}from"./Alert-CgNUKTJk.js";import{S as R}from"./SweetAlert-vzLgp13W.js";import{T as y}from"./Typography-CKlLxaDL.js";import{D as $,a as U}from"./Dialog-BGF2t3L7.js";import{D as ye}from"./DialogTitle-D6DEKDqS.js";import{I as v}from"./AlertTitle-D9ejxV9_.js";import{T as Ce}from"./Tooltip-CwyNn424.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./Chip-Dnlh_trd.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const we=()=>{const[l,k]=a.useState({country_id:"",country_name:"",id:"",state_name:""}),[g,A]=a.useState(null),[C,M]=a.useState(null),[r,c]=a.useState(null),[S,d]=a.useState(""),[D,s]=a.useState(!1),[N,h]=a.useState(!1),[Te,_e]=a.useState(!1),[I,E]=a.useState(null),[Y,F]=a.useState(!1),[u,K]=a.useState(""),[n,P]=a.useState(0),[i,q]=a.useState(10),[x,w]=a.useState(null),[G,T]=a.useState(!1),o=ce(),{StateMaster:J=[],totalItems:O}=V(t=>t.StateMaster),Q=J.map(t=>({...t,id:t._id})),{CountryMaster:j}=V(t=>t.CountryMaster);a.useEffect(()=>{const t=setTimeout(()=>{o(f({search:u,page:n,limit:i}))},500);return()=>clearTimeout(t)},[u,n,i]),a.useEffect(()=>{o(de({search:u,page:n,limit:i}))},[u,n,i]);const B=t=>{const{name:m,value:L}=t.target;k(_=>({..._,[m]:L}))},X=l.state_name.trim()!=="",Z=async()=>{try{const t=j.find(_=>_._id===l.country_id),m={country_id:l.country_id||"",country_name:(t==null?void 0:t.country_name)||"",state_name:l.state_name},L=await o(he(m)).unwrap();c("success"),d("State Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(f({search:u,page:n,limit:i})),h(!1)}catch(t){c("error"),d("Failed to add State: "+t),s(!0),setTimeout(()=>s(!1),3e3)}},ee=async()=>{try{const t={_id:l.id,country_id:l.country_id||"",state_name:l.state_name},m=await o(pe(t)).unwrap();c("success"),d("State updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),h(!1),M(null),o(f({search:u,page:n,limit:i}))}catch{c("error"),d("Failed to update State: "),s(!0),setTimeout(()=>s(!1),3e3)}},te=async()=>{if(I){try{await o(me(I)).unwrap(),c("error"),d("State deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(f({search:u,page:n,limit:i}))}catch(t){c("error"),d("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}F(!1),E(null)}},se=()=>{F(!1),E(null)},ae=t=>{w(t),T(!0)},re=async()=>{if(x){try{await o(ue({_id:x._id,isActive:!x.isActive})).unwrap(),c("success"),d(`State ${x.isActive?"deactivated":"activated"} successfully.`),s(!0),o(f({search:u,page:n,limit:i}))}catch(t){c("error"),d("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),T(!1),w(null)}},oe=()=>{T(!1),w(null)},le=t=>{A(t)},W=()=>{A(null),h(!1)},ne=t=>{K(t),P(0)},ie=[{accessorKey:"state_name",header:"State Name"},{header:"Actions",Cell:({row:t})=>e.jsxs(p,{display:"flex",gap:1,children:[e.jsx(Ce,{title:"View State Details",children:e.jsx(v,{color:"primary",onClick:()=>le(t.original),children:e.jsx(fe,{})})}),e.jsx(je,{checked:t.original.isActive,onChange:()=>ae(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(R,{show:G,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${x!=null&&x.isActive?"deactivate":"activate"} this State?`,onConfirm:re,onCancel:oe,confirmText:"Yes",cancelText:"No"}),e.jsx(R,{show:Y,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Country?",onConfirm:te,onCancel:se,confirmText:"Yes",cancelText:"No"}),D&&r&&e.jsx("div",{className:"p-4",children:e.jsx(H,{type:r,title:r==="success"?"Success!":r==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),N?e.jsxs($,{open:N,onClose:(t,m)=>{m!=="backdropClick"&&h(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(ye,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:C!==null?"Edit State":"Add State"}),e.jsx(v,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>h(!1),children:e.jsx(z,{})})]}),e.jsxs(U,{children:[D&&r&&e.jsx("div",{className:"mb-4",children:e.jsx(H,{type:r,title:r==="success"?"Success!":r==="error"&&S.toLowerCase().includes("deleted")?"Deleted!":r==="error"?"Error!":"Warning!",message:S,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-1 block",children:["Country ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"country_id",value:l.country_id,onChange:B,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Country"}),j==null?void 0:j.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t._id,children:t.country_name},t._id))]})]}),e.jsx(ge,{label:"State Title",name:"state_name",value:l.state_name,onChange:B})]}),e.jsxs(p,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(b,{onClick:C!==null?ee:Z,className:"rounded-[25px]",disabled:!X,children:C!==null?"Update State":"Add State"}),e.jsx(b,{variant:"secondary",onClick:()=>h(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:["  ",e.jsx(p,{ml:2,children:e.jsx(y,{variant:"h5",fontWeight:500,className:"font-outfit",children:"State Management"})}),e.jsxs(b,{onClick:()=>{k({id:"",state_name:""}),M(null),h(!0)},children:[e.jsx(xe,{}),"Add New State"]})]}),e.jsx(Se,{clickHandler:ne,data:Q,columns:ie,rowCount:O,pageIndex:n,pageSize:i,onPaginationChange:({pageIndex:t,pageSize:m})=>{P(t),q(m)}})]}),e.jsx($,{open:!!g,onClose:W,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(p,{className:"rounded-xl overflow-hidden",children:[e.jsxs(p,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(y,{className:"font-outfit",variant:"h6",children:"State Details"}),e.jsx(v,{sx:{color:"white"},onClick:W,children:e.jsx(z,{})})]}),e.jsx(U,{children:g&&e.jsxs(p,{display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(y,{className:"font-outfit",children:[e.jsx("strong",{children:"Country:"})," ",g.country_name]}),e.jsxs(y,{className:"font-outfit",children:[e.jsx("strong",{children:"State:"})," ",g.state_name]})]})})]})})]})},et=()=>e.jsx(e.Fragment,{children:e.jsx(we,{})});export{et as default};
