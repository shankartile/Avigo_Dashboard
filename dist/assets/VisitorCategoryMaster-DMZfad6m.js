import{r,c as pe,d as L,aj as y,ak as ge,j as e,B as m,al as me,am as he,an as ye,ao as xe}from"./index-N8t8oMzR.js";import{I as fe}from"./Info-lyeC1xGk.js";import{D as Ce}from"./Delete-07TAjR17.js";import{V as je}from"./Visibility-CgGAKN6P.js";import{C as U}from"./Close-CwR_quIe.js";import{D as ve,E as Te}from"./DataTable-BqUD-dAi.js";import{I as Ve}from"./InputField-riaj6edy.js";import{B as b}from"./Button-CBNcrDpD.js";import{T as we}from"./ToggleSwitch-DR4b514_.js";import{A as z}from"./Alert-CgNUKTJk.js";import{S as H}from"./SweetAlert-vzLgp13W.js";import{T as D}from"./Typography-CKlLxaDL.js";import{T as A}from"./Tooltip-CwyNn424.js";import{U as Se}from"./user-zBXSPW1U.js";import{D as R,a as K}from"./Dialog-BGF2t3L7.js";import{D as ke}from"./DialogTitle-D6DEKDqS.js";import{I as x}from"./AlertTitle-D9ejxV9_.js";import"./createSvgIcon-DUEWsKfg.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./Chip-Dnlh_trd.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./Divider-TBuFGUUO.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";import"./createLucideIcon-hCp2CA4c.js";const _e=()=>{const[u,C]=r.useState({id:"",category:"",visitor_type_id:""}),[j,I]=r.useState(null),[v,T]=r.useState(null),[i,a]=r.useState(null),[f,l]=r.useState(""),[M,s]=r.useState(!1),[N,p]=r.useState(!1),[be,De]=r.useState(!1),[E,V]=r.useState(null),[O,w]=r.useState(!1),[g,Y]=r.useState(""),[n,F]=r.useState(0),[c,$]=r.useState(10),[h,S]=r.useState(null),[q,k]=r.useState(!1),o=pe(),{VisitorCategoryMaster:G=[],totalItems:J}=L(t=>t.VisitorCategoryMasters),{VisitorTypeMaster:_}=L(t=>t.VisitorTypeMaster),Q=G.map(t=>({...t,id:t._id}));r.useEffect(()=>{const t=setTimeout(()=>{o(y({search:g,page:n,limit:c}))},500);return()=>clearTimeout(t)},[g,n,c]),r.useEffect(()=>{const t=setTimeout(()=>{o(ge({search:g,page:n,limit:c}))},500);return()=>clearTimeout(t)},[g,n,c]);const P=t=>{const{name:d,value:W}=t.target;C(ue=>({...ue,[d]:W}))},X=u.category.trim()!=="",Z=async()=>{try{const t={category:u.category,visitor_type_id:u.visitor_type_id||""},d=await o(xe(t)).unwrap();a("success"),l("Visitor Category Added successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(y({search:g,page:n,limit:c})),p(!1)}catch(t){a("error"),l("Failed to add Visitor Category : "+t),s(!0),setTimeout(()=>s(!1),3e3)}},ee=async(t,d)=>{try{C({id:t._id||"",category:t.category||"",visitor_type_id:t.visitor_type_id||""}),T(d),p(!0)}catch{a("error"),l("Unable to fetch Visitor Category details for editing."),s(!0)}},te=async()=>{try{const t={_id:u.id,category:u.category,visitor_type_id:u.visitor_type_id||""},d=await o(ye(t)).unwrap();a("success"),l("Visitor Category  updated successfully."),s(!0),setTimeout(()=>s(!1),3e3),p(!1),T(null),o(y({search:g,page:n,limit:c}))}catch{a("error"),l("Failed to update Visitor Category : "),s(!0),setTimeout(()=>s(!1),3e3)}},se=t=>{V(t),w(!0)},re=async()=>{if(E){try{await o(he(E)).unwrap(),a("error"),l("Visitor Category deleted successfully."),s(!0),setTimeout(()=>s(!1),3e3),o(y({search:g,page:n,limit:c}))}catch(t){a("error"),l("Delete failed: "+t),s(!0),setTimeout(()=>s(!1),3e3)}w(!1),V(null)}},ie=()=>{w(!1),V(null)},oe=t=>{S(t),k(!0)},ae=async()=>{if(h){try{await o(me({_id:h._id,isActive:!h.isActive})).unwrap(),a("success"),l(`Visitor Category ${h.isActive?"deactivated":"activated"} successfully.`),s(!0),o(y({search:g,page:n,limit:c}))}catch(t){a("error"),l("Status toggle failed: "+t),s(!0)}setTimeout(()=>s(!1),3e3),k(!1),S(null)}},le=()=>{k(!1),S(null)},ne=t=>{I(t)},B=()=>{I(null),p(!1)},ce=t=>{Y(t),F(0)},de=[{accessorKey:"category",header:"Visitor category"},{accessorKey:"visitor_type_name",header:"Visitor Type"},{header:"Actions",Cell:({row:t})=>e.jsxs(m,{display:"flex",gap:1,children:[e.jsx(A,{title:"View Details",children:e.jsx(x,{color:"primary",onClick:()=>ne(t.original),children:e.jsx(je,{})})}),!t.original.isOthers&&e.jsx(A,{title:"Edit",children:e.jsx("span",{children:e.jsx(x,{color:"secondary",onClick:()=>ee(t.original,t.index),children:e.jsx(Te,{})})})}),!t.original.isOthers&&e.jsx(x,{color:"error",onClick:()=>se(t.original._id),children:e.jsx(Ce,{})}),e.jsx(we,{checked:t.original.isActive,onChange:()=>oe(t.original),tooltipTitle:t.original.isActive?"Deactivate":"Activate"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(H,{show:q,type:"warning",title:"Confirm Status Change",message:`Are you sure you want to ${h!=null&&h.isActive?"deactivate":"activate"} this Visitor Category?`,onConfirm:ae,onCancel:le,confirmText:"Yes",cancelText:"No"}),e.jsx(H,{show:O,type:"error",title:"Confirm Deletion",message:"Are you sure you want to delete this Visitor Category ?",onConfirm:re,onCancel:ie,confirmText:"Yes",cancelText:"No"}),M&&i&&e.jsx("div",{className:"p-4",children:e.jsx(z,{type:i,title:i==="success"?"Success!":i==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":i==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),N?e.jsxs(R,{open:N,onClose:(t,d)=>{d!=="backdropClick"&&p(!1)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:[e.jsxs(m,{sx:{background:"linear-gradient( #255593 103.05%)",height:25,p:4,position:"relative"},children:[e.jsx(ke,{className:"font-outfit",sx:{color:"white",position:"absolute",top:5},children:v!==null?"Edit Visitor Category":"Add Visitor Category"}),e.jsx(x,{sx:{position:"absolute",top:12,right:12,color:"white"},onClick:()=>p(!1),children:e.jsx(U,{})})]}),e.jsxs(K,{children:[M&&i&&e.jsx("div",{className:"mb-4",children:e.jsx(z,{type:i,title:i==="success"?"Success!":i==="error"&&f.toLowerCase().includes("deleted")?"Deleted!":i==="error"?"Error!":"Warning!",message:f,variant:"filled",showLink:!1,linkHref:"",linkText:"",onClose:()=>s(!1)})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm text-gray-600 dark:text-white mb-1 block",children:["Visitor Type ",e.jsx("span",{className:"text-error-500",children:" * "})]}),e.jsxs("select",{name:"visitor_type_id",value:u.visitor_type_id,onChange:P,className:"mt-1 p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Visitor Type"}),_==null?void 0:_.filter(t=>t.isActive).map(t=>e.jsx("option",{value:t._id,children:t.visitor_type},t._id))]})]}),e.jsx(Ve,{label:"Visitor Category ",name:"category",value:u.category,onChange:P})]}),e.jsxs(m,{display:"flex",justifyContent:"center",gap:6,mt:4,children:[e.jsx(b,{onClick:v!==null?te:Z,className:"rounded-[25px]",disabled:!X,children:v!==null?"Update Visitor Category ":"Add Visitor Category "}),e.jsx(b,{variant:"secondary",onClick:()=>p(!1),className:"rounded-[25px]",children:"Cancel"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(m,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(m,{ml:2,children:e.jsxs(D,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Visitor Purpose Master",e.jsx(A,{title:"Add/modify visit types like Delivery, Guest, Service, Vendor.",arrow:!0,children:e.jsx(fe,{sx:{color:"#245492",ml:1}})})]})}),e.jsxs(b,{onClick:()=>{C({id:"",category:"",visitor_type_id:""}),T(null),p(!0)},children:[e.jsx(Se,{}),"Add New Visitor Category "]})]}),e.jsx(ve,{clickHandler:ce,data:Q,columns:de,rowCount:J,pageIndex:n,pageSize:c,onPaginationChange:({pageIndex:t,pageSize:d})=>{F(t),$(d)}})]}),e.jsx(R,{open:!!j,onClose:B,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:"25px"}},BackdropProps:{sx:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}},children:e.jsxs(m,{className:"rounded-xl overflow-hidden",children:[e.jsxs(m,{sx:{background:"linear-gradient( #255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(D,{className:"font-outfit",variant:"h6",children:"Visitor Category Details"}),e.jsx(x,{sx:{color:"white"},onClick:B,children:e.jsx(U,{})})]}),e.jsx(K,{children:j&&e.jsx(m,{display:"flex",flexDirection:"column",gap:2,children:e.jsxs(D,{className:"font-outfit",children:[e.jsx("strong",{children:"Visitor Category :"})," ",j.category]})})})]})})]})},nt=()=>e.jsx(e.Fragment,{children:e.jsx(_e,{})});export{nt as default};
