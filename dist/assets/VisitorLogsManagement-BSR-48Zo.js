import{j as e,r as i,B as c,c as B,d as G,x as p}from"./index-CcNgdVLz.js";import{V as H}from"./Visibility-Bad1pPYX.js";import{c as Z}from"./createSvgIcon-ClJPFlmG.js";import{I as q}from"./Info-BLwzYq-V.js";import{G as J}from"./Group-yFIc-5y_.js";import{D as Q}from"./DataTable-DIxG5frN.js";import{A as U}from"./ArrowBack-Dpb-03kv.js";import{L as X,F as Y,T as _,Z as $,D as ee}from"./thumbnails-qXa_Wtv4.js";import{A as P}from"./Avatar-D05Y1472.js";import{T as r}from"./Typography-BMOygWke.js";import{C as L}from"./Chip-YFG14ne-.js";import{D as S}from"./Divider-BePmc644.js";import{C as te}from"./Close-eApB0hKv.js";import{D as se,a as ie}from"./Dialog-BdfS6Lfy.js";import{I as w}from"./AlertTitle-C4QpKbd8.js";import{T as v}from"./Tooltip-C-v54PpA.js";import"./Cancel-CkCQy-6N.js";import"./utils-BtYGnpaM.js";import"./index-CLpR2HuM.js";import"./DateTimeField-CYfYG2Su.js";import"./index-D3LyqDt4.js";import"./useSlotProps-z1QAC-gu.js";import"./CircularProgress-CVM8C023.js";import"./dividerClasses-Bv38dMpn.js";import"./Pagination-DR3bn4wR.js";import"./DialogTitle-BbPUlM9A.js";import"./Tabs-CWf6flOX.js";import"./skeleton-DjwwWlQi.js";const re=Z(e.jsx("path",{d:"M15 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9zM8 17c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m6 1V4.5l5.5 5.5z"})),oe=({data:t,onClose:m})=>{var u;const[n,f]=i.useState(!1),[j,d]=i.useState(0);if(!t)return null;const o=((u=t.photos)==null?void 0:u.length)>0?t.photos:[{url:t.photo||"/images/default-user.png"}],y=[["Visitor Name",t.name],["Mobile Number",t.mobile],["Flat Number",t.flatNumber],["Purpose",t.purpose],["Reason",t.reason],["Entry Time",t.entryTime],["Exit Time",t.exitTime||"-"],["Visited On",new Date(t.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})]];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-6 pt-6 bg-white flex items-center gap-2",children:e.jsxs("button",{onClick:m,className:"flex items-center text-[#255593] hover:underline",children:[e.jsx(U,{fontSize:"small"}),e.jsx("span",{className:"ml-1 font-medium",children:"Back"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 px-6 py-10 bg-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-full h-[380px] rounded-lg overflow-hidden mb-4 flex items-center justify-center bg-gray-100",children:o[0]&&e.jsx("img",{src:o[0].url,alt:"visitor",className:"w-full h-full object-contain cursor-pointer",onClick:()=>{d(0),f(!0)}})}),e.jsx(X,{open:n,close:()=>f(!1),index:j,slides:o.map(x=>({src:x.url,title:"Visitor Image"})),plugins:[Y,_,$,ee],zoom:{maxZoomPixelRatio:3}})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{src:t.photo,sx:{width:56,height:56}}),e.jsxs("div",{children:[e.jsx(r,{variant:"h6",fontWeight:600,children:t.name}),e.jsx(L,{size:"small",label:t.type,color:t.type==="Guest"?"primary":t.type==="Delivery"?"success":"warning"})]})]}),e.jsx(S,{sx:{borderColor:"#255593",borderBottomWidth:"2px",mb:3}}),e.jsx("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6",children:y.map(([x,b],C)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:x}),e.jsx("p",{className:"text-gray-800 font-medium",children:b||"-"})]},C))})]})]})]})},ne=({open:t,onClose:m,summary:n})=>e.jsx(se,{open:t,onClose:m,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(ie,{sx:{p:0},children:e.jsxs(c,{className:"bg-white rounded-xl",children:[e.jsxs(c,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(r,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Today Visitor Summary"}),e.jsx(w,{sx:{color:"white"},onClick:m,children:e.jsx(te,{})})]}),e.jsx(c,{px:5,py:4,children:e.jsxs(c,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:3,children:[e.jsx(r,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Guests Today:"})}),e.jsx(r,{fontFamily:"Outfit",fontWeight:600,color:"#2563eb",children:n.guests}),e.jsx(S,{sx:{gridColumn:"1 / -1"}}),e.jsx(r,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Deliveries Today:"})}),e.jsx(r,{fontFamily:"Outfit",fontWeight:600,color:"#16a34a",children:n.deliveries}),e.jsx(S,{sx:{gridColumn:"1 / -1"}}),e.jsx(r,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Vendors Today:"})}),e.jsx(r,{fontFamily:"Outfit",fontWeight:600,color:"#d97706",children:n.vendors})]})})]})})}),ae=()=>{const t=B(),{visitors:m,totalItems:n,summary:f}=G(s=>s.visitorLogs),[j,d]=i.useState(0),[o,y]=i.useState(10),[u,x]=i.useState(""),[b,C]=i.useState([]),[a,O]=i.useState(""),[l,W]=i.useState(""),[T,D]=i.useState(null),[F,N]=i.useState(!1),[k,I]=i.useState(!1),V=i.useRef(null),[g,M]=i.useState("all"),E=s=>{C(s),d(0);const h={};s.forEach(({id:A,value:z})=>{z&&(h[A]=z)}),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{t(p({search:u,filters:h,fromDate:a||void 0,toDate:l||void 0,page:0,limit:o}))},500)};i.useEffect(()=>{a&&!l||!a&&l||t(p({fromDate:a||void 0,toDate:l||void 0,page:0,limit:o}))},[a,l]);const K=async s=>{x(s),d(0),await t(p({search:s,fromDate:a,toDate:l,page:0,limit:o}))},R=[{accessorKey:"photo",header:"Photo",Cell:({cell:s})=>e.jsx(P,{src:s.getValue()}),enableColumnFilter:!1,size:80},{accessorKey:"name",header:"Visitor Name",filterVariant:"text"},{accessorKey:"mobile",header:"Mobile Number",filterVariant:"text"},{accessorKey:"flatNumber",header:"Flat No",filterVariant:"text"},{accessorKey:"type",header:"Category",filterVariant:"select",filterSelectOptions:["Guest","Delivery","Vendor"],Cell:({cell:s})=>e.jsx(L,{label:s.getValue(),color:s.getValue()==="Guest"?"primary":s.getValue()==="Delivery"?"success":"warning",size:"small"})},{accessorKey:"purpose",header:"Purpose"},{accessorKey:"entryTime",header:"Entry Time"},{header:"Actions",Cell:({row:s})=>e.jsxs(c,{display:"flex",gap:1,children:[e.jsx(v,{title:"View Visitor Details",children:e.jsx(w,{onClick:()=>{D(s.original),N(!0)},children:e.jsx(H,{})})}),e.jsx(v,{title:"View Today Visitor Counts",children:e.jsx(w,{color:"primary",onClick:()=>I(!0),children:e.jsx(re,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ne,{open:k,onClose:()=>I(!1),summary:f}),F&&T&&e.jsx(oe,{data:T,onClose:()=>{N(!1),D(null)}}),!F&&e.jsxs(e.Fragment,{children:[e.jsx(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(r,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Visitor Logs Module",e.jsx(v,{title:"Monitor daily visitor activity recorded by guards",arrow:!0,children:e.jsx(q,{sx:{color:"#245492",ml:1}})})]})}),e.jsx(Q,{data:m,columns:R,rowCount:n,pageIndex:j,pageSize:o,enableColumnFilters:!0,columnFilters:b,onColumnFiltersChange:E,clickHandler:K,customTopLeftContent:e.jsxs(c,{display:"flex",alignItems:"center",gap:1.5,sx:{backgroundColor:"#f1f5f9",px:2,py:.96,borderRadius:"8px",border:"1px solid #e2e8f0"},children:[e.jsx(J,{sx:{color:"#245492"}}),e.jsx(r,{className:"font-outfit",sx:{fontSize:"14px",fontWeight:500},children:"Total Visitor Count:"}),e.jsx(r,{className:"font-outfit",sx:{fontSize:"16px",fontWeight:700,color:"#245492"},children:n})]}),enableProducttypeFilter:!0,productTypeValue:g,onProducttypeChange:s=>{M(s),d(0),t(p({search:u,filters:s!=="all"?{type:s}:void 0,fromDate:a,toDate:l,page:0,limit:o}))},fromDate:a,toDate:l,onFromDateChange:O,onToDateChange:W,onPaginationChange:({pageIndex:s,pageSize:h})=>{d(s),y(h),t(p({search:u,filters:g!=="all"?{type:g}:void 0,page:s,limit:h}))}},g)]})]})},ke=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{})});export{ke as default};
