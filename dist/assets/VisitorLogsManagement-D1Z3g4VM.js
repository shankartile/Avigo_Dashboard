import{j as e,r,B as u,c as B,d as G,x as g}from"./index-N8t8oMzR.js";import{V as H}from"./Visibility-CgGAKN6P.js";import{c as Z}from"./createSvgIcon-DUEWsKfg.js";import{I as $}from"./Info-lyeC1xGk.js";import{G as q}from"./Group-BAniG9kX.js";import{D as J}from"./DataTable-BqUD-dAi.js";import{A as Q,L as U,F as X,T as Y,Z as _,D as ee}from"./thumbnails-crlKBoi1.js";import{A as P}from"./Avatar-CSlJx-ky.js";import{T as i}from"./Typography-CKlLxaDL.js";import{C as k}from"./Chip-Dnlh_trd.js";import{D as w}from"./Divider-TBuFGUUO.js";import{C as te}from"./Close-CwR_quIe.js";import{D as se,a as re}from"./Dialog-BGF2t3L7.js";import{I as S}from"./AlertTitle-D9ejxV9_.js";import{T as v}from"./Tooltip-CwyNn424.js";import"./Cancel-BzUm9XFt.js";import"./utils-D3TFH80g.js";import"./index-LlRZSLEd.js";import"./DateTimeField-BNev5xzk.js";import"./index-CY0vqa8Z.js";import"./useSlotProps-CaIca8GW.js";import"./CircularProgress-BJr-bAJD.js";import"./dividerClasses-D-RO7W6F.js";import"./Pagination-DjFC1aKN.js";import"./DialogTitle-D6DEKDqS.js";import"./Tabs-BUaZVZQS.js";import"./skeleton-CrFh5em0.js";const ie=Z(e.jsx("path",{d:"M15 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9zM8 17c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m6 1V4.5l5.5 5.5z"})),oe=({data:t,onClose:h})=>{var x;const[l,p]=r.useState(!1),[y,c]=r.useState(0);if(!t)return null;const o=((x=t.photos)==null?void 0:x.length)>0?t.photos:[{url:t.photo||"/images/default-user.png"}],b=[["Visitor Name",t.name],["Mobile Number",t.mobile],["Flat Number",t.flatNumber],["Purpose",t.purpose],["Reason",t.reason],["Entry Time",t.entryTime],["Exit Time",t.exitTime||"-"],["Visited On",new Date(t.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})]];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-6 pt-6 bg-white flex items-center gap-2",children:e.jsxs("button",{onClick:h,className:"flex items-center text-[#255593] hover:underline",children:[e.jsx(Q,{fontSize:"small"}),e.jsx("span",{className:"ml-1 font-medium",children:"Back"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 px-6 py-10 bg-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-full h-[380px] rounded-lg overflow-hidden mb-4 flex items-center justify-center bg-gray-100",children:o[0]&&e.jsx("img",{src:o[0].url,alt:"visitor",className:"w-full h-full object-contain cursor-pointer",onClick:()=>{c(0),p(!0)}})}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:o.map((m,d)=>e.jsx("img",{src:m.url,alt:`thumb-${d}`,className:"h-20 w-full object-cover border rounded cursor-pointer",onClick:()=>{c(d),p(!0)}},d))}),e.jsx(U,{open:l,close:()=>p(!1),index:y,slides:o.map(m=>({src:m.url,title:"Visitor Image"})),plugins:[X,Y,_,ee],zoom:{maxZoomPixelRatio:3}})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{src:t.photo,sx:{width:56,height:56}}),e.jsxs("div",{children:[e.jsx(i,{variant:"h6",fontWeight:600,children:t.name}),e.jsx(k,{size:"small",label:t.type,color:t.type==="Guest"?"primary":t.type==="Delivery"?"success":"warning"})]})]}),e.jsx(w,{sx:{borderColor:"#255593",borderBottomWidth:"2px",mb:3}}),e.jsx("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6",children:b.map(([m,d],C)=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:m}),e.jsx("p",{className:"text-gray-800 font-medium",children:d||"-"})]},C))})]})]})]})},le=({open:t,onClose:h,summary:l})=>e.jsx(se,{open:t,onClose:h,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(re,{sx:{p:0},children:e.jsxs(u,{className:"bg-white rounded-xl",children:[e.jsxs(u,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Today Visitor Summary"}),e.jsx(S,{sx:{color:"white"},onClick:h,children:e.jsx(te,{})})]}),e.jsx(u,{px:5,py:4,children:e.jsxs(u,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:3,children:[e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Guests Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#2563eb",children:l.guests}),e.jsx(w,{sx:{gridColumn:"1 / -1"}}),e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Deliveries Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#16a34a",children:l.deliveries}),e.jsx(w,{sx:{gridColumn:"1 / -1"}}),e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Vendors Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#d97706",children:l.vendors})]})})]})})}),ae=()=>{const t=B(),{visitors:h,totalItems:l,summary:p}=G(s=>s.visitorLogs),[y,c]=r.useState(0),[o,b]=r.useState(10),[x,m]=r.useState(""),[d,C]=r.useState([]),[a,L]=r.useState(""),[n,O]=r.useState(""),[T,D]=r.useState(null),[F,N]=r.useState(!1),[W,I]=r.useState(!1),V=r.useRef(null),[j,M]=r.useState("all"),E=s=>{C(s),c(0);const f={};s.forEach(({id:A,value:z})=>{z&&(f[A]=z)}),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{t(g({search:x,filters:f,fromDate:a||void 0,toDate:n||void 0,page:0,limit:o}))},500)};r.useEffect(()=>{a&&!n||!a&&n||t(g({fromDate:a||void 0,toDate:n||void 0,page:0,limit:o}))},[a,n]);const K=async s=>{m(s),c(0),await t(g({search:s,fromDate:a,toDate:n,page:0,limit:o}))},R=[{accessorKey:"photo",header:"Photo",Cell:({cell:s})=>e.jsx(P,{src:s.getValue()}),enableColumnFilter:!1,size:80},{accessorKey:"name",header:"Visitor Name",filterVariant:"text"},{accessorKey:"mobile",header:"Mobile Number",filterVariant:"text"},{accessorKey:"flatNumber",header:"Flat No",filterVariant:"text"},{accessorKey:"type",header:"Category",filterVariant:"select",filterSelectOptions:["Guest","Delivery","Vendor"],Cell:({cell:s})=>e.jsx(k,{label:s.getValue(),color:s.getValue()==="Guest"?"primary":s.getValue()==="Delivery"?"success":"warning",size:"small"})},{accessorKey:"purpose",header:"Purpose"},{accessorKey:"entryTime",header:"Entry Time"},{header:"Actions",Cell:({row:s})=>e.jsxs(u,{display:"flex",gap:1,children:[e.jsx(v,{title:"View Visitor Details",children:e.jsx(S,{onClick:()=>{D(s.original),N(!0)},children:e.jsx(H,{})})}),e.jsx(v,{title:"View Today Visitor Counts",children:e.jsx(S,{color:"primary",onClick:()=>I(!0),children:e.jsx(ie,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(le,{open:W,onClose:()=>I(!1),summary:p}),F&&T&&e.jsx(oe,{data:T,onClose:()=>{N(!1),D(null)}}),!F&&e.jsxs(e.Fragment,{children:[e.jsx(u,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(i,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Visitor Logs Module",e.jsx(v,{title:"Monitor daily visitor activity recorded by guards",arrow:!0,children:e.jsx($,{sx:{color:"#245492",ml:1}})})]})}),e.jsx(J,{data:h,columns:R,rowCount:l,pageIndex:y,pageSize:o,enableColumnFilters:!0,columnFilters:d,onColumnFiltersChange:E,clickHandler:K,customTopLeftContent:e.jsxs(u,{display:"flex",alignItems:"center",gap:1.5,sx:{backgroundColor:"#f1f5f9",px:2,py:.96,borderRadius:"8px",border:"1px solid #e2e8f0"},children:[e.jsx(q,{sx:{color:"#245492"}}),e.jsx(i,{className:"font-outfit",sx:{fontSize:"14px",fontWeight:500},children:"Total Visitor Count:"}),e.jsx(i,{className:"font-outfit",sx:{fontSize:"16px",fontWeight:700,color:"#245492"},children:l})]}),enableProducttypeFilter:!0,productTypeValue:j,onProducttypeChange:s=>{M(s),c(0),t(g({search:x,filters:s!=="all"?{type:s}:void 0,fromDate:a,toDate:n,page:0,limit:o}))},fromDate:a,toDate:n,onFromDateChange:L,onToDateChange:O,onPaginationChange:({pageIndex:s,pageSize:f})=>{c(s),b(f),t(g({search:x,filters:j!=="all"?{type:j}:void 0,page:s,limit:f}))}},j)]})]})},Oe=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{})});export{Oe as default};
