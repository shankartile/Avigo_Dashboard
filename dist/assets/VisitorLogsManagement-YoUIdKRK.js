import{j as e,B as r,c as q,d as J,r as o,x as f}from"./index-CNh2Ysd7.js";import{V as Q}from"./Visibility-CFK2wX7e.js";import{c as U}from"./createSvgIcon-BgVIxfXN.js";import{I as X}from"./Info-BLOe8JuO.js";import{G as Y}from"./Group-LebaL8cz.js";import{D as Z}from"./DataTable-CBDiE-I1.js";import{C as F}from"./Close-CSWdanUp.js";import{D as T,a as w}from"./Dialog-CMeqEyOr.js";import{T as i}from"./Typography-DxP0RQcB.js";import{I as u}from"./AlertTitle-BBXxFqxI.js";import{A as D}from"./Avatar-CCsDKzZ8.js";import{C as v}from"./Chip--RBU-Z22.js";import{D as m}from"./Divider-1omdH51K.js";import{T as y}from"./Tooltip-B4POfKz-.js";import"./Cancel-BLeHB2Qp.js";import"./utils-lR4eRFL7.js";import"./index-5igkt3_T.js";import"./DateTimeField-BSuPXSWe.js";import"./index-BfVZHwAX.js";import"./useSlotProps-Dx6fg7Ph.js";import"./CircularProgress-B1SplcgD.js";import"./dividerClasses-BGxOqTuw.js";import"./Pagination-C_Nq6nsY.js";import"./DialogTitle-sP3uGIgc.js";import"./Tabs-DWd8sdsH.js";import"./skeleton-H-TAVWvB.js";const _=U(e.jsx("path",{d:"M15 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9zM8 17c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m6 1V4.5l5.5 5.5z"})),$=({open:n,data:t,onClose:a})=>t?e.jsx(T,{open:n,onClose:a,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(w,{sx:{p:0},children:e.jsxs(r,{className:"bg-white rounded-xl",children:[e.jsxs(r,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"},children:[e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Visitor Details"}),e.jsx(u,{sx:{color:"white"},onClick:a,children:e.jsx(F,{})})]}),e.jsxs(r,{px:6,py:4,children:[e.jsxs(r,{display:"flex",gap:3,mb:3,alignItems:"center",children:[e.jsx(D,{src:t.photo,sx:{width:90,height:90,border:"2px solid #e5e7eb"}}),e.jsxs(r,{children:[e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"20px",fontWeight:600,color:"#1f2937"},children:t.name}),e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif"},children:t.mobile}),e.jsxs(i,{sx:{fontFamily:"Outfit, sans-serif"},children:["Flat: ",e.jsx("strong",{children:t.flatNumber})]})]})]}),e.jsx(r,{display:"flex",gap:2,mb:2,children:e.jsx(v,{label:t.type,color:t.type==="Guest"?"primary":t.type==="Delivery"?"success":"warning"})}),e.jsx(m,{sx:{my:3}}),e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"15px",fontWeight:600,mb:1},children:"Purpose"}),e.jsx(r,{sx:{border:"1px solid #e5e7eb",borderRadius:1,p:2,backgroundColor:"#fafafa",fontFamily:"Outfit, sans-serif",fontSize:"14px"},children:t.purpose}),t.reason&&e.jsxs(e.Fragment,{children:[e.jsx(m,{sx:{my:3}}),e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"15px",fontWeight:600,mb:1},children:"Reason"}),e.jsx(r,{sx:{border:"1px solid #e5e7eb",borderRadius:1,p:2,backgroundColor:"#fafafa",fontFamily:"Outfit, sans-serif",fontSize:"14px"},children:t.reason})]}),e.jsx(m,{sx:{my:3}}),e.jsxs(r,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,children:[e.jsxs(i,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Entry Time:"})," ",t.entryTime]}),t.exitTime&&e.jsxs(i,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Exit Time:"})," ",t.exitTime]}),e.jsxs(i,{sx:{fontFamily:"Outfit, sans-serif"},children:[e.jsx("strong",{children:"Visited On:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]})]})})}):null,ee=({open:n,onClose:t,summary:a})=>e.jsx(T,{open:n,onClose:t,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",overflow:"hidden"}},children:e.jsx(w,{sx:{p:0},children:e.jsxs(r,{className:"bg-white rounded-xl",children:[e.jsxs(r,{sx:{background:"linear-gradient(#255593 103.05%)",height:60,px:4,display:"flex",alignItems:"center",justifyContent:"space-between",color:"white"},children:[e.jsx(i,{sx:{fontFamily:"Outfit, sans-serif",fontSize:"18px",fontWeight:600},children:"Today Visitor Summary"}),e.jsx(u,{sx:{color:"white"},onClick:t,children:e.jsx(F,{})})]}),e.jsx(r,{px:5,py:4,children:e.jsxs(r,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:3,children:[e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Guests Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#2563eb",children:a.guests}),e.jsx(m,{sx:{gridColumn:"1 / -1"}}),e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Deliveries Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#16a34a",children:a.deliveries}),e.jsx(m,{sx:{gridColumn:"1 / -1"}}),e.jsx(i,{fontFamily:"Outfit",children:e.jsx("strong",{children:"Vendors Today:"})}),e.jsx(i,{fontFamily:"Outfit",fontWeight:600,color:"#d97706",children:a.vendors})]})})]})})}),se=()=>{const n=q(),{visitors:t,totalItems:a,summary:O}=J(s=>s.visitorLogs),[I,h]=o.useState(0),[x,z]=o.useState(10),[g,W]=o.useState(""),[P,R]=o.useState([]),[l,k]=o.useState(""),[c,N]=o.useState(""),[L,b]=o.useState(null),[M,C]=o.useState(!1),[E,V]=o.useState(!1),j=o.useRef(null),[p,K]=o.useState("all"),G=s=>{R(s),h(0);const d={};s.forEach(({id:H,value:S})=>{S&&(d[H]=S)}),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{n(f({search:g,filters:d,fromDate:l||void 0,toDate:c||void 0,page:0,limit:x}))},500)};o.useEffect(()=>{l&&!c||!l&&c||n(f({fromDate:l||void 0,toDate:c||void 0,page:0,limit:x}))},[l,c]);const A=async s=>{W(s),h(0),await n(f({search:s,fromDate:l,toDate:c,page:0,limit:x}))},B=[{accessorKey:"photo",header:"Photo",Cell:({cell:s})=>e.jsx(D,{src:s.getValue()}),enableColumnFilter:!1,size:80},{accessorKey:"name",header:"Visitor Name",filterVariant:"text"},{accessorKey:"mobile",header:"Mobile Number",filterVariant:"text"},{accessorKey:"flatNumber",header:"Flat No",filterVariant:"text"},{accessorKey:"type",header:"Category",filterVariant:"select",filterSelectOptions:["Guest","Delivery","Vendor"],Cell:({cell:s})=>e.jsx(v,{label:s.getValue(),color:s.getValue()==="Guest"?"primary":s.getValue()==="Delivery"?"success":"warning",size:"small"})},{accessorKey:"purpose",header:"Purpose"},{accessorKey:"entryTime",header:"Entry Time"},{header:"Actions",Cell:({row:s})=>e.jsxs(r,{display:"flex",gap:1,children:[e.jsx(y,{title:"View Visitor Details",children:e.jsx(u,{onClick:()=>{b(s.original),C(!0)},children:e.jsx(Q,{})})}),e.jsx(y,{title:"View Today Visitor Counts",children:e.jsx(u,{color:"primary",onClick:()=>V(!0),children:e.jsx(_,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ee,{open:E,onClose:()=>V(!1),summary:O}),e.jsx($,{open:M,data:L,onClose:()=>{C(!1),b(null)}}),e.jsx(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(i,{variant:"h5",fontWeight:500,className:"font-outfit",children:["Visitor Logs Module",e.jsx(y,{title:"Monitor daily visitor activity recorded by guards",arrow:!0,children:e.jsx(X,{sx:{color:"#245492",ml:1}})})]})}),e.jsx(Z,{data:t,columns:B,rowCount:a,pageIndex:I,pageSize:x,enableColumnFilters:!0,columnFilters:P,onColumnFiltersChange:G,clickHandler:A,customTopLeftContent:e.jsxs(r,{display:"flex",alignItems:"center",gap:1.5,sx:{backgroundColor:"#f1f5f9",px:2,py:.96,borderRadius:"8px",border:"1px solid #e2e8f0"},children:[e.jsx(Y,{sx:{color:"#245492"}}),e.jsx(i,{className:"font-outfit",sx:{fontSize:"14px",fontWeight:500},children:"Total Visitor Count:"}),e.jsx(i,{className:"font-outfit",sx:{fontSize:"16px",fontWeight:700,color:"#245492"},children:a})]}),enableProducttypeFilter:!0,productTypeValue:p,onProducttypeChange:s=>{K(s),h(0),n(f({search:g,filters:s!=="all"?{type:s}:void 0,fromDate:l,toDate:c,page:0,limit:x}))},fromDate:l,toDate:c,onFromDateChange:k,onToDateChange:N,onPaginationChange:({pageIndex:s,pageSize:d})=>{h(s),z(d),n(f({search:g,filters:p!=="all"?{type:p}:void 0,page:s,limit:d}))}},p)]})},ve=()=>e.jsx(e.Fragment,{children:e.jsx(se,{})});export{ve as default};
